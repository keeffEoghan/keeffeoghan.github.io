!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){for(var e=s.indexOf(document.readyState);c<=e;++c){var t=u[s[c]];t&&t()}}var o=n(2),a=r(o),s=["loading","interactive","complete"],u={loading:function(){document.addEventListener("readystatechange",i)},interactive:function(){(0,a.default)(document.querySelector("canvas")),document.removeEventListener("readystatechange",i)}},c=0;i()},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n(3);var u=n(4),c=i(u),l=n(6),f=i(l),d=n(7),p=i(d),h=n(18),v=i(h),m=n(19),g=i(m),y=n(31),_=i(y),b=n(32),w=i(b),E=n(45),A=i(E),x=n(51),T=i(x),S=n(53),M=i(S),R=n(21),C=i(R),O=n(54),k=i(O),P=n(56),F=i(P),I=n(82),D=i(I),L=n(83),N=i(L),j=n(90),U=i(j),B=n(92),V=i(B),z=n(93),G=i(z),H=n(94),X=n(141),q=r(X),Y=n(142),W=i(Y),K=n(143),J=i(K),Z=n(144),Q=i(Z),$=n(145),ee=i($),te=n(146),ne=i(te),re=n(150),ie=i(re),oe=n(154),ae=i(oe),se=n(169),ue=i(se),ce=n(165),le=n(172),fe=i(le),de=n(186),pe=i(de),he=n(128),ve=i(he),me=n(195),ge=i(me),ye=n(130),_e=i(ye),be=n(197),we=i(be),Ee=n(198),Ae=n(168),xe=i(Ae),Te=n(167),Se=i(Te),Me=n(155),Re=i(Me),Ce=n(191);i(Ce);k.default.defaultFnFormatter=function(e,t){return t.name},t.default=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.spawnFlow;M.default.div(ke.spawnSize,Pe[Ie.scale],I.viewSize),ke.spawn(I,void 0,e)}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.spawnFastest;De.buffer=I.particles.buffers[0],De.spawnSize=I.particles.shape,De.spawn(I,void 0,e)}function r(e,t,n){Ue.shader=e,Ue.speed=t;var r=Be.image,i=Ge;te.useMedia&&Ve&&(r=Be.video,i=Ve),Ue.buffer.shape=I.colorMap.shape=r,Ue.setPixels(i),Ue.spawn(I,void 0,n)}function i(){(0,p.default)({video:!0,audio:!0},function(e,t){e?console.warn(e):!function(){ze=t;var e=Object.assign(document.createElement("video"),{src:self.URL.createObjectURL(t),controls:!0,muted:!0,autoplay:!0,className:"cam-stream"});e.addEventListener("canplay",function(){Ve=e,Be.video=[e.videoWidth,e.videoHeight]}),be=be||(0,v.default)(t,{audible:!1}),be.analyser.fftSize=Math.pow(2,7),Ae=Ae||new ae.default(be,3)}()})}function u(){vt.image.src="",vt.url.value="loading...",vt.url.size=vt.url.value.length}function l(){vt.paused=oe.paused,oe.pause(),u(),vt.canvas.width=e.width,vt.canvas.height=e.height,vt.context.fillStyle=getComputedStyle(e).backgroundColor,vt.context.fillRect(0,0,e.width,e.height),vt.context.drawImage(e,0,0);var t=vt.data=vt.canvas.toDataURL("image/png");vt.image.src=t,vt.overlay.classList.add("show");var n=t.replace(/^data:image\/\w+;base64,/,"");(0,N.default)({url:"https://api.imgur.com/3/image",method:"POST",body:{image:n,type:"base64"},headers:{Authorization:"Client-ID 290f4e8d36da965"},json:!0},function(e,n,r){e?console.error(e,n):r.success&&200===r.status?vt.data===t&&(vt.image.src=vt.url.value=r.data.link,vt.url.size=vt.url.value.length):console.error(e,n,r.status)})}function d(){var e=P.app.tick().dt;ut.app.play(P.app.time),oe&&oe.currentTime>=0&&!oe.paused?(P.track.tick(1e3*oe.currentTime),te.animate&&ut.track.play(P.track.time),le.times.current.setTime(P.track.time),le.els.current.innerText=le.times.current.toLocaleTimeString("en-gb",le.timeFormat),le.seeking||(le.els.progress.value=oe.currentTime),le.els.toggle.checked=!0):le.els.toggle.checked=!1,Ye.frequencies(ye.dataOrder(0)).apply(),We.draw(I.colorMap),I.step().draw(),I.buffers.length&&(O.bindFramebuffer(O.FRAMEBUFFER,null),I.drawFade(),it.bind(),Object.assign(it.uniforms,{view:I.buffers[0].color[0].bind(0),resolution:I.viewRes,time:I.timer.time},at),rt.render(),I.stepBuffers()),O.viewport.apply(O,[0,0].concat(o(I.flow.shape))),I.flow.bind(),Ce.trim(1/I.state.flowDecay,P.app.time),(0,Re.default)(function(e){Object.assign(e.line.uniforms,I.state),e.update().draw()},Ce.active),ye&&ye.sample(e),Ae&&Ae.sample(e),nt()}function h(){e.width=self.innerWidth,e.height=self.innerHeight,I.resize()}function m(){var r=ut.track.tracks,i=ut.track.outputs;r.tendrils.smoothTo({to:{forceWeight:.01,lineWidth:1},time:13e3,ease:[0,.95,1]}),r.tendrils2.smoothTo({to:{noiseWeight:.001,varyNoiseScale:5},time:13e3,ease:[0,.2,1]}).smoothTo({to:{noiseScale:80,varyNoiseScale:2,noiseSpeed:0},time:18e3,ease:[0,0,1.1,1]}),r.tendrils3.smoothTo({to:{target:2e-5,varyTarget:5},time:1e3,ease:[0,0,1]}).smoothTo({to:{target:3e-5},time:1e4,ease:[0,.1,1]}),r.audio.over(100,{to:{mic:0},time:1e3}).over(100,{to:{trackCamAt:.1*re.trackCamAt},time:13100}),r.calls.to({time:1e3,call:[function(){var e=i.spawn,t=e.radius;e.radius=.2,B(I.targets),e.radius=t}]}).to({time:13e3,call:[function(){L.spawnImage=I.targets,He(I.targets)}]}),r.blend.to({to:[1,0],time:13e3,ease:[0,0,1]}),r.blur.to({to:ot,time:1e4,ease:[0,0,1]}),r.baseColor.over(2e3,{to:[1,1,1,.9],time:13e3,ease:[0,0,1]}),r.fadeColor.over(3e3,{to:[0,0,0,.05],time:13e3,ease:[0,0,1]}),r.tendrils.smoothTo({to:{forceWeight:.014,varyForce:.3,varyFlow:.5},time:23e3,ease:[0,.95,1]}),r.tendrils2.smoothTo({to:{noiseScale:50,varyNoiseScale:0},time:24e3,ease:[0,-.2,1.5,1]}),r.tendrils3.smoothOver(1e3,{to:{target:5e-5},time:24e3,ease:[0,0,1]}).smoothOver(3e3,{to:{target:4e-4},time:29e3,ease:[0,0,1]}).smoothOver(3300,{to:{target:.003,lineWidth:3},time:35500,ease:[0,0,1]}).smoothTo({to:{target:0},time:36500,ease:[0,1,1]}).smoothTo({to:{target:.03},time:38500,ease:[0,0,1]}).to({to:{target:0},time:39500,ease:[0,1,1]}).to({to:{target:.01},time:41500,ease:[0,0,1]}).to({to:{target:0},time:42500,ease:[0,1,1]}).to({to:{target:.02,lineWidth:1},time:43500,ease:[0,0,1]}).to({to:{target:3e-5},time:46e3,ease:[0,1,1]}),r.calls.to({time:24100,call:[function(){return He(I.targets)}]}).to({time:29100,call:[function(){return He(I.targets)}]}).to({time:35100,call:[function(){return He(I.targets)}]}).to({time:37100,call:[function(){return He(I.targets)}]}).to({time:40100,call:[function(){return He(I.targets)}]}),r.tendrils.smoothOver(2e3,{to:{flowWeight:1,varyFlow:.5},time:29e3,ease:[0,-.1,.95,1]}),r.tendrils2.smoothOver(2e3,{to:{noiseWeight:.002,noiseScale:35,varyNoiseScale:1,noiseSpeed:2e-4},time:29e3,ease:[0,-.1,.95,1]}),r.blend.to({to:[.2,1],time:24e3,ease:[0,0,1]}).over(7e3,{to:[.4,.6],time:47e3,ease:[0,0,1]}),r.baseColor.to({to:[1,1,1,.25],time:24e3}),r.flowColor.over(1e3,{to:[1,1,1,.05],time:24e3}),r.fadeColor.over(1e3,{to:[0,0,0,.03],time:35e3,ease:[0,0,1]}),r.tendrils.over(1e3,{to:{flowWeight:.75,colorMapAlpha:.1},ease:[0,0,1],time:47e3}),r.tendrils2.smoothOver(7e3,{to:{noiseWeight:.002,noiseScale:25,varyNoiseScale:0,noiseSpeed:3e-4},time:47e3,ease:[0,-.2,.7,1]}).smoothTo({to:{noiseWeight:.0025,noiseScale:18,varyNoiseScale:.3},time:5e4,ease:[0,0,1]}),r.audio.over(100,{to:{trackCamAt:0,trackFlowAt:re.trackFlowAt,trackFastAt:re.trackFastAt,micFlowAt:re.micFlowAt,micFastAt:re.micFastAt},time:47e3}),r.blend.over(500,{to:[1,0],time:46e3,ease:[0,0,1]}),r.baseColor.over(500,{to:[0,0,0,.8],time:46e3}),r.flowColor.over(1e3,{to:[1,1,1,.035],time:46e3}),r.fadeColor.over(3e3,{to:[1,1,1,.05],time:48e3,ease:[0,0,1]}),r.spawn.over(100,{to:{radius:.25,speed:0},time:46600}).over(100,{to:ct.respawn,time:47e3}),r.calls.to({time:49e3,call:[function(){delete L.spawnImage,n(),t();var e=i.spawn,r=e.radius;e.radius=.2,B(I.targets),e.radius=r}]}).to({time:46800,call:[function(){return B()}]}),r.tendrils.smoothOver(6e3,{to:{flowWeight:1,colorMapAlpha:0,speedAlpha:0},time:59e3,ease:[0,0,1]}).smoothOver(7e3,{to:{forceWeight:.015,varyForce:.2,autoFade:!1},time:7e4,ease:[0,-.1,.5,1]}).to({to:{forceWeight:.017,varyForce:0,flowWeight:.9,flowDecay:3e-4},time:70100}).smoothTo({to:{flowWeight:1,varyFlow:0,speedAlpha:5e-4,colorMapAlpha:.12},time:93600,ease:[0,1,1]}),r.tendrils2.smoothOver(15e3,{to:{noiseWeight:.0025,noiseScale:2.5,varyNoise:0,varyNoiseScale:0,varyNoiseSpeed:0},time:7e4,ease:[0,-.1,.95,1]}).smoothTo({to:{noiseScale:.5},time:93600,ease:[0,-.1,.95,1]}),r.spawn.over(100,{to:{radius:.1,speed:.2},time:7e4}).smoothTo({to:{radius:.9,speed:.01},time:93e3,ease:[0,.3,1]}).to({to:{radius:.25,speed:0},time:93600,ease:[0,0,1]}).to({to:ct.spawn,time:96e3,ease:[0,0,1]}),r.baseColor.over(100,{to:[0,0,0,.85],time:70100}),r.flowColor.over(23600,{to:[1,1,1,.05],ease:[0,0,1],time:93600}),r.fadeColor.over(100,{to:[0,0,0,0],time:70100}).over(100,{to:[1,1,1,.1],time:93600}),r.audio.over(50,{to:{trackFlowAt:0,micFlowAt:0,trackFastAt:0,micFastAt:0,trackFormAt:1.2*re.trackFormAt,micFormAt:1.2*re.micFormAt},time:70100}).over(50,{to:{trackFlowAt:.8*re.trackFlowAt,micFlowAt:.9*re.micFlowAt,trackFastAt:re.trackFastAt,micFastAt:re.micFastAt},time:93600});var a=function(){X(),I.viewport().drawFill([1,1,1,1])};r.calls.to({time:70100,call:[function(){e.classList.add("light"),a()}]}).to({time:73e3,call:[a]}).to({time:76e3,call:[a]}).to({time:82e3,call:[a]}).to({time:85e3,call:[a]}).to({time:88e3,call:[a]}).to({time:93600,call:[function(){e.classList.remove("light"),a()}]}),r.tendrils.to({to:{forceWeight:.014,varyForce:.2,flowWeight:1,varyFlow:.8,flowDecay:.003,colorMapAlpha:.05,autoFade:!0},time:93800}).to({to:{flowWeight:.8,varyFlow:.3},time:95200}).smoothTo({to:{forceWeight:.015,varyForce:.1,flowWeight:1,colorMapAlpha:.08},time:107e3,ease:[0,1,1]}),r.tendrils2.to({to:{noiseWeight:.001,varyNoise:.1,noiseScale:26,varyNoiseScale:0,noiseSpeed:25e-5},time:93800}).smoothTo({to:{noiseWeight:.003,noiseScale:1.8,varyNoiseScale:.5,noiseSpeed:2e-4},time:109e3,ease:[0,.8,1]}),r.audio.to({to:{trackFormAt:re.trackFormAt,micFormAt:re.micFormAt},time:96e3,ease:[0,1,1]}).to({to:{trackFastAt:.9*re.trackFastAt,micFastAt:.9*re.micFastAt},time:107e3,ease:[0,0,1]}),r.baseColor.over(100,{to:[0,0,0,.7],time:93800}).to({to:[0,0,0,.8],time:117e3,ease:[0,0,1]}),r.flowColor.to({to:[1,1,1,.03],time:93800}),r.fadeColor.to({to:[1,1,1,.1],time:107e3}),r.tendrils.over(5e3,{to:{flowWeight:.7,colorMapAlpha:.95},time:132e3,ease:[0,.2,1]}).smoothOver(4e3,{to:{flowWeight:1,colorMapAlpha:.7},time:141e3,ease:[0,0,1]}).smoothTo({to:{varyForce:.25,varyFlow:.4},time:145e3,ease:[0,0,1]}),r.tendrils2.smoothOver(3e3,{to:{varyNoise:.8,noiseScale:-1.5,varyNoiseScale:20,noiseSpeed:3e-4,varyNoiseSpeed:.02},time:129e3,ease:[0,.2,1]}).smoothTo({to:{noiseWeight:.0025,noiseScale:5,varyNoiseScale:-4,varyNoiseSpeed:.1},time:134e3,ease:[0,0,1,1]}).smoothTo({to:{noiseWeight:.003,varyNoise:.3,noiseScale:1.8,varyNoiseScale:1,varyNoiseSpeed:0},time:142e3,ease:[0,0,1,1]}),r.tendrils3.over(6e3,{to:{target:.005,lineWidth:3},time:132e3,ease:[0,0,1]}).over(3e3,{to:{target:3e-5},time:138e3,ease:[0,0,1]}).to({to:{lineWidth:1},time:142e3,ease:[0,0,1]}),r.calls.to({time:117e3,call:[function(){return Xe()}]}).to({time:126e3,call:[function(){He(),L.spawnImage=I.targets,He(I.targets)}]}).to({time:128e3,call:[function(){return He()}]}).to({time:134e3,call:[function(){return He()}]}).to({time:137e3,call:[function(){return He()}]}).to({time:138e3,call:[function(){delete L.spawnImage;var e=i.spawn,t=e.radius;e.radius=.2,B(I.targets),e.radius=t}]}),r.audio.over(100,{to:{trackFastAt:0,micFastAt:0,trackSampleAt:.8*re.trackSampleAt,micSampleAt:.8*re.micSampleAt},time:117e3}).over(100,{to:{trackFlowAt:0,micFlowAt:0,trackFormAt:0,micFormAt:0,trackSampleAt:0,micSampleAt:0,trackSpawnAt:0,micSpawnAt:0,trackCamAt:1.2*re.trackCamAt,micCamAt:1.2*re.micCamAt},time:124e3}).to({to:{trackCamAt:.3*re.trackCamAt,micCamAt:.3*re.micCamAt},time:132e3,ease:[0,.8,1]}).over(3e3,{to:{trackCamAt:re.trackCamAt,micCamAt:re.micCamAt},time:14e4,ease:[0,.8,1]}).over(100,{to:{trackCamAt:0,micCamAt:0,trackFlowAt:1.2*re.trackFlowAt,micFlowAt:1.2*re.micFlowAt,trackFastAt:re.trackFastAt,micFastAt:re.micFastAt},time:146e3}),r.blend.over(4e3,{to:[0,1],time:134e3,ease:[0,.9,1]}).smoothOver(6e3,{to:[.2,.9],time:142e3,ease:[0,0,1]}).smoothTo({to:[.6,.6],time:146e3,ease:[0,0,1]}),r.flowColor.over(5e3,{to:[0,0,0,0],time:134e3}).over(4e3,{to:[1,1,1,.03],time:146e3}),r.fadeColor.over(5e3,{to:[1,1,1,.05],time:134e3,ease:[0,0,1]}).to(138e3,{to:[1,1,1,.2],time:138e3,ease:[0,1,1]}),r.tendrils.smoothTo({to:{colorMapAlpha:.6},time:174e3,ease:[0,.4,1]}).to({to:{colorMapAlpha:.3},time:174500}),r.tendrils2.smoothTo({to:{noiseWeight:.0045,noiseScale:.4,varyNoiseScale:2.5},time:174e3,ease:[0,.1,1]}),r.blend.over(14e3,{to:[1,.2],time:174e3}),r.baseColor.over(14e3,{to:[0,0,0,.75],time:174e3,ease:[0,.1,1]}),r.flowColor.over(14e3,{to:[1,1,1,.02],time:174e3,ease:[0,.7,1]}).to({to:[1,1,1,0],time:174500,ease:[0,.7,1]}),r.audio.over(100,{to:{trackSampleAt:0,micSampleAt:0},time:16e4}).over(100,{to:{trackFormAt:re.trackFormAt,micFormAt:re.micFormAt},time:174e3}),r.tendrils.smoothTo({to:{flowWeight:-.4,colorMapAlpha:.7},time:187e3,ease:[0,.1,1]}).smoothTo({to:{flowWeight:1,colorMapAlpha:.3},time:187400,ease:[0,.95,1]}),r.tendrils2.smoothTo({to:{noiseWeight:.008,noiseScale:.5,varyNoiseScale:80,noiseSpeed:6e-4},time:183e3,ease:[0,.1,1.1,1]}).smoothTo({to:{noiseScale:2,varyNoiseScale:100},time:183e3,ease:[0,1,1]}).smoothTo({to:{noiseScale:8,varyNoiseScale:0,noiseSpeed:2e-4},time:187e3}).to({to:{noiseWeight:.004,noiseSpeed:18e-5,noiseScale:1.2,varyNoiseScale:.2},time:187500}),r.audio.over(9e3,{to:{trackFlowAt:.2*re.trackFlowAt,trackFastAt:.06*re.trackFastAt},time:185e3,ease:[0,.1,1]}).smoothTo({to:{trackFlowAt:re.trackFlowAt,trackFastAt:re.trackFastAt},time:187e3,ease:[0,.9,1]}).over(100,{to:{trackSpawnAt:.1*re.trackSpawnAt,micSpawnAt:.2*re.micSpawnAt,trackFormAt:0,micFormAt:0},time:187300}).over(100,{to:{trackSpawnAt:0,micSpawnAt:0},time:188e3}),r.calls.to({time:187200,call:[function(){return B()}]}),r.spawn.over(100,{to:{radius:.03},time:187100}).to({to:{radius:.9},time:19e4}),r.blend.to({to:[1,.1],time:18e4}).to({to:[1,0],time:187e3}).to({to:[.9,.3],time:187400}),r.blur.over(12e3,{to:{radius:12,limit:.3},time:187e3,ease:[0,0,1]}).to({to:ot,time:188e3,ease:[0,1,1]});var s=(0,Se.default)(function(e){return e/255},[255,232,120]);r.baseColor.to({to:[].concat(o(s),[.7]),time:182e3,ease:[0,1,1]}).over(500,{to:[1,1,1,.75],time:188e3}),r.flowColor.to({to:[].concat(o(s),[.2]),time:186e3}).to({to:[].concat(o(s),[.05]),time:19e4}),r.fadeColor.over(14e3,{to:[0,0,0,.1],time:187e3}).to({to:[.1,.14,.2,.05],time:187400}),r.tendrils.smoothTo({to:{forceWeight:.015,varyForce:.2,flowWeight:1,varyFlow:.3,colorMapAlpha:.9},time:255e3,ease:[0,1,1]}),r.tendrils2.smoothTo({to:{varyNoise:.7,noiseScale:.5,varyNoiseScale:2,noiseSpeed:12e-5},time:257e3,ease:[0,.8,1]}),r.audio.over(100,{to:{trackFastAt:re.trackFastAt,micFastAt:re.micFastAt,trackFlowAt:3*re.trackFlowAt,micFlowAt:3*re.micFlowAt,trackFormAt:3*re.trackFormAt,micFormAt:3*re.micFormAt,trackSampleAt:3*re.trackSampleAt,micSampleAt:3*re.micSampleAt},time:189e3}).to({to:{trackFastAt:.6*re.trackFastAt,micFastAt:.6*re.micFastAt},ease:[0,0,1],time:198e3}).to({to:{trackFormAt:.8*re.trackFormAt,micFormAt:.8*re.micFormAt,trackSampleAt:re.trackSampleAt,micSampleAt:re.micSampleAt},ease:[0,0,1],time:211e3}).to({to:{trackSampleAt:.55*re.trackSampleAt,micSampleAt:.55*re.micSampleAt,trackFastAt:re.trackFastAt,micFastAt:re.micFastAt,trackFormAt:re.trackFormAt,micFormAt:re.micFormAt},ease:[0,1,1],time:217e3}).to({to:{trackFlowAt:.8*re.trackFlowAt,micFlowAt:.8*re.micFlowAt},ease:[0,0,1],time:223e3}).to({to:{trackFormAt:.8*re.trackFormAt,micFormAt:.8*re.micFormAt,trackSampleAt:3*re.trackSampleAt,micSampleAt:3*re.micSampleAt},time:234e3}).to({to:{trackFastAt:.75*re.trackFastAt,micFastAt:.75*re.micFastAt,trackFlowAt:.75*re.trackFlowAt,micFlowAt:.75*re.micFlowAt,trackFormAt:re.trackFormAt,micFormAt:re.micFormAt},time:247e3}).over(100,{to:{trackFastAt:0,micFastAt:0,trackFlowAt:0,micFlowAt:0,trackFormAt:0,micFormAt:0,trackSampleAt:0,micSampleAt:0},time:255e3}),r.calls.to({time:211e3,call:[function(){return Xe()}]}).to({time:214e3,call:[function(){return Xe()}]}).to({time:217e3,call:[function(){return Xe()}]}),r.blend.over(21e3,{to:[1,.65],time:211e3}),r.tendrils.smoothTo({to:{forceWeight:.015,flowWeight:-.1,speedAlpha:.002,colorMapAlpha:.9},time:257600,ease:[0,1,1]}).smoothOver(300,{to:{varyFlow:.4,colorMapAlpha:.3},time:281e3,ease:[0,0,1]}),r.tendrils2.smoothTo({to:{noiseWeight:.005,noiseScale:1.2,varyNoiseScale:2,noiseSpeed:3e-4,varyNoiseSpeed:.01},time:257600,ease:[0,0,1]}).smoothTo({to:{noiseScale:.9,varyNoiseScale:3,noiseSpeed:1e-4,varyNoiseSpeed:0},time:261e3,ease:[0,.1,1.1,1]}),r.audio.over(100,{to:{trackFlowAt:0,trackFastAt:re.trackFastAt,trackFormAt:0,trackSampleAt:0,trackCamAt:0,trackSpawnAt:0,micFlowAt:0,micFastAt:re.micFastAt,micFormAt:0,micSampleAt:0,micCamAt:0,micSpawnAt:0},time:257600}).to({to:{trackFastAt:4*re.trackFastAt,micFastAt:4*re.micFastAt},time:264e3}).over(100,{to:{trackFastAt:0,mic:re.mic,micFlowAt:re.micFlowAt,micFastAt:re.micFastAt,micFormAt:re.micFormAt,micSampleAt:re.micSampleAt,micSpawnAt:re.micSpawnAt},time:283e3}),r.spawn.over(50,{to:{radius:.6,speed:.01},time:257600}),r.blend.over(1e3,{to:[1,.05],time:259e3}),r.blur.over(23e3,{to:{radius:6,limit:.4},time:281e3,ease:[0,0,1]}).to({to:ot,time:283e3,ease:[0,1,1]});var u=(0,Se.default)(function(e){return e/255},[255,209,71]);r.baseColor.over(1e3,{to:[].concat(o(u),[.85]),time:259e3}).over(300,{to:[1,1,1,.9],time:281e3,ease:[0,0,1]}),r.flowColor.over(1e3,{to:[].concat(o(u),[.15]),time:259e3}).over(300,{to:[1,1,1,.1],time:281e3,ease:[0,0,1]}),r.fadeColor.over(2e3,{to:[].concat(o((0,Se.default)(function(e){return.01*e},u)),[.1]),time:259e3,ease:[0,0,1]}).over(300,{to:[0,0,0,.15],time:281e3,ease:[0,1,1]}),r.calls.to({time:281e3,call:[function(){return E(!0)}]})}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mt.main;e.__controllers&&e.__controllers.forEach(function(e){return e.updateDisplay()});for(var t in e.__folders)y(e.__folders[t])}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mt.main;e?t.open():t.close();for(var n in t.__folders)b(e,t.__folders[n])}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!_t;gt.classList[e?"remove":"add"]("hide"),_t=e}if(!(0,V.default)()){var x=C.default.parse(location.search.slice(1)),S=(0,H.defaults)(),R=S.state,O=(0,c.default)(e,H.glSettings,d);console.log("Maximum texture units","| vertex:",O.getParameter(O.MAX_VERTEX_TEXTURE_IMAGE_UNITS),"| fragment:",O.getParameter(O.MAX_TEXTURE_IMAGE_UNITS),"| combined:",O.getParameter(O.MAX_COMBINED_TEXTURE_IMAGE_UNITS));var P={app:S.timer,track:new G.default(0)},I=new H.Tendrils(O,{timer:P.app,numBuffers:1}),L={},j=(0,ne.default)(O),B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.respawn;return j.spawn(I,e)},z=function(){return I.reset()},X=function(){I.clear(),B(),B(I.targets)},Y=function(){return I.clear()},K=function(){return I.clearView()},Z=function(){return I.clearFlow()},$=I.state,te={trackURL:x.track?decodeURIComponent(x.track):"https://soundcloud.com/max-cooper/trust-feat-kathrin-deboer",animate:""+x.animate!="false",useMedia:""+x.use_media!="false",staticImage:x.static_image?decodeURIComponent(x.static_image):"/build/images/max-crop-gradient.png"};""+x.cursor=="false"&&e.classList.add("no-cursor");var re={audible:""+x.mute!="true",track:parseFloat(x.track_in||1,10),trackFlowAt:1.15,trackFastAt:.12,trackFormAt:.06,trackSampleAt:.12,trackCamAt:.008,trackSpawnAt:.18,mic:parseFloat(x.mic_in||1,10),micFlowAt:.5,micFastAt:.6,micFormAt:.4,micSampleAt:.74,micCamAt:.06,micSpawnAt:.09},oe=Object.assign(new Audio,{crossOrigin:"anonymous",className:"track"}),se=document.querySelector(".audio-controls"),le={els:{main:se,toggle:se.querySelector(".play-toggle"),progress:se.querySelector(".progress"),current:se.querySelector(".current"),total:se.querySelector(".total")},times:{current:new Date(0),total:new Date(0)},timeFormat:{second:"numeric"},seeking:!1};le.els.main.parentElement.removeChild(le.els.main),le.els.main.appendChild(oe),le.els.main.classList.add("show");var de=function(){le.els.progress.max=oe.duration;var e=1e3*oe.duration;le.times.total.setTime(e),le.timeFormat.minute=e>=6e4?"numeric":void 0,le.timeFormat.hour=e>=36e5?"numeric":void 0,le.els.current.innerText=0,le.els.total.innerText=le.times.total.toLocaleTimeString("en-gb",le.timeFormat)};oe.addEventListener("durationchange",de),le.els.toggle.addEventListener("change",function(){return le.els.toggle.checked?oe.play():oe.pause()}),le.els.progress.addEventListener("pointerdown",function(){return le.seeking=!0}),le.els.progress.addEventListener("change",function(){le.seeking&&(oe.currentTime=le.els.progress.value,le.seeking=!1)});var he=s({},re),me=(0,v.default)(oe,{audible:he.audible});me.analyser.fftSize=Math.pow(2,8);var ye=new ae.default(me,4),be=void 0,Ae=void 0,Te=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.parentElement;return oe.src!==t&&(oe.src=t,oe.currentTime=0),le.els.main.parentElement!==n&&n.appendChild(le.els.main),oe},Me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te.trackURL,t=document.querySelector(".npm-scb-white");t&&t.parentElement.removeChild(t),e.match(/^(https?)?(\:\/\/)?(www\.)?soundcloud\.com\//gi)?(0,g.default)({client_id:"75aca2e2b815f9f5d4e92916c7b80846",song:e,dark:!1},function(e,t,n,r){e?console.warn("Error loading track",e):Te(t,r.querySelector(".npm-scb-info"))}):Te(e.match(/^(https)?(:\/\/)?(www\.)?dropbox\.com\/s\//gi)?e.replace(/^((https)?(:\/\/)?(www\.)?)dropbox\.com\/s\/(.*)\?dl=(0)$/gi,"https://dl.dropboxusercontent.com/s/$5?dl=1&raw=1"):e)};Me();var Ce=new fe.default(O),Oe=function(t){var n=(0,_.default)(t,e);n[0]=(0,A.default)(n[0],0,I.viewRes[0],-1,1),n[1]=(0,A.default)(n[1],0,I.viewRes[1],1,-1),Ce.get(t.pointerId).add(P.app.time,n)};e.addEventListener("pointermove",Oe,!1);var ke=new q.PixelSpawner(O,{shader:[q.defaults().shader[0],Q.default],buffer:I.flow}),Pe={normal:[1,-1],"mirror x":[-1,-1],"mirror y":[1,1],"mirror xy":[-1,1]},Fe={scale:"mirror xy"},Ie=s({},Fe),De=new q.PixelSpawner(O,{shader:[q.defaults().shader[0],ee.default],buffer:null}),Le=new ie.default(O,{speed:.005,bias:2e4}),Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.spawnForm;return Le.shuffle().spawn(I,void 0,e)},je={direct:(0,F.default)(O,q.defaults().shader[0],W.default),sample:(0,F.default)(O,q.defaults().shader[0],J.default)},Ue=new q.PixelSpawner(O,{shader:null});T.default.scale(Ue.spawnMatrix,T.default.identity(Ue.spawnMatrix),[-1,1]);var Be={image:[0,0],video:[0,0]},Ve=null,ze=null,Ge=new Image;Ge.src=te.staticImage,Ge.addEventListener("load",function(){return Be.image=[Ge.width,Ge.height]});var He=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.spawnImage;return r(je.direct,.3,e)},Xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.spawnSamples;return r(je.sample,1,e)},qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ze;return e&&(0,Re.default)(function(e){return e.stop()},e.getTracks())};te.useMedia&&i();var Ye=new ue.default(O,me.analyser.frequencyBinCount),We=new ge.default(O,{views:[Ye.texture,Ue.buffer],alphas:[.3,.8]}),Ke=new Map,Je=function(e,t,n){return function(r){var i=e();if(i){var o=Ke.get(t);if(o)return o;var a=n(r,i);return Ke.set(t,a),a}return i}},Ze=[[function(){return t()},Je(function(){return he.track*he.trackFlowAt},"meanWeight(track, 1, 0.25)",function(e,t){return(0,ce.meanWeight)(e.dataOrder(1),.25)>t})],[function(){return n()},Je(function(){return he.track*he.trackFastAt},"meanWeight(track, 2, 0.8)",function(e,t){return(0,ce.meanWeight)(e.dataOrder(2),.8)>t})],[function(){return Ne()},Je(function(){return he.track*he.trackFormAt},"abs(peak(track, 3))",function(e,t){return Math.abs((0,ce.peak)(e.dataOrder(3)))>t})],[function(){return Xe()},Je(function(){return he.track*he.trackSampleAt},"meanWeight(track, 2, 0.25)",function(e,t){return(0,ce.meanWeight)(e.dataOrder(2),.25)>t})],[function(){return He()},Je(function(){return he.track*he.trackCamAt},"meanWeight(track, 3, 0.5)",function(e,t){return(0,ce.meanWeight)(e.dataOrder(3),.5)>t})],[function(){return X()},Je(function(){return he.track*he.trackSpawnAt},"meanWeight(track, 3, 0.25)",function(e,t){return(0,ce.meanWeight)(e.dataOrder(2),.25)>t})]],Qe=[[function(){return t()},Je(function(){return he.mic*he.micFlowAt},"meanWeight(mic, 1, 0.3)",function(e,t){return(0,ce.meanWeight)(e.dataOrder(1),.3)>t})],[function(){return n()},Je(function(){return he.mic*he.micFastAt},"meanWeight(mic, 1, 0.7)",function(e,t){return(0,ce.meanWeight)(e.dataOrder(1),.7)>t})],[function(){return Ne()},Je(function(){return he.mic*he.micFormAt},"abs(peak(mic, 2))",function(e,t){return Math.abs((0,ce.peak)(e.dataOrder(2)))>t})],[function(){return Xe()},Je(function(){return he.mic*he.micSampleAt},"meanWeight(mic, 1, 0.4)",function(e,t){return(0,ce.meanWeight)(e.dataOrder(1),.4)>t})],[function(){return He()},Je(function(){return he.mic*he.micCamAt},"meanWeight(mic, 2, 0.6)",function(e,t){return(0,ce.meanWeight)(e.dataOrder(2),.6)>t})],[function(){return X()},Je(function(){return he.mic*he.micSpawnAt},"meanWeight(mic, 2, 0.3)",function(e,t){return(0,ce.meanWeight)(e.dataOrder(2),.3)>t})]],$e=function(e){return function(t){return e.fire.apply(e,o(t))}},et=void 0,tt=void 0,nt=function(){var e=!1;return he.track>0&&!oe.paused&&(e=Ze.some(et||(et=$e(ye)))),!e&&he.mic>0&&Ae&&(e=Qe.some(tt||(tt=$e(Ae)))),Ke.clear(),e},rt=new ve.default(O),it=(0,F.default)(O,_e.default,we.default),ot={radius:3,limit:.5},at={radius:8,limit:.2},st={tendrils:I.state,tendrils2:I.state,tendrils3:I.state,baseColor:I.state.baseColor,flowColor:I.state.flowColor,fadeColor:I.state.fadeColor,spawn:j.uniforms,audio:he,blend:We.alphas,blur:at,calls:{}},ut={track:new pe.default((0,Se.default)(function(){return[]},st,{}),st),app:new pe.default({main:[]},{main:I.state})};oe.addEventListener("seeked",function(){return te.animate&&ut.track.playFrom(1e3*oe.currentTime,0)});var ct={tendrils:{autoClearView:!1,autoFade:!0,forceWeight:.016,varyForce:-.25,flowWeight:1,varyFlow:.3,flowDecay:.003,flowWidth:5,speedAlpha:5e-4,colorMapAlpha:.9},tendrils2:{noiseWeight:3e-4,varyNoise:.3,noiseScale:1.5,varyNoiseScale:1,noiseSpeed:6e-4,varyNoiseSpeed:.05},tendrils3:{target:5e-6,varyTarget:1,lineWidth:1},baseColor:[1,1,1,.9],flowColor:[1,1,1,.1],fadeColor:[0,0,0,.1],spawn:{radius:.9,speed:.05},audio:{trackFlowAt:0,trackFastAt:0,trackFormAt:0,trackSampleAt:0,trackCamAt:0,trackSpawnAt:0,micFlowAt:0,micFastAt:0,micFormAt:0,micSampleAt:0,micCamAt:0,micSpawnAt:0},blend:[0,1],blur:s({},at),calls:null},lt=60;ut.track.tracks.calls.to({call:[function(){return z()}],time:lt}).to({call:[function(){X(),e.classList.remove("light")}],time:200}),ut.track.apply(function(e,t){var n=ct[t];return e.to({to:n,time:lt}),{apply:n}});var ft={info:document.querySelector(".info"),start:document.querySelector(".info > button")},dt=function(){return ft.info.classList.contains("hide")?ft.info.classList.remove("hide"):ft.info.classList.add("hide")};ft.start.addEventListener("click",function(){dt(),oe.autoplay=!0,oe.duration&&oe.play()}),document.querySelector(".info-button").addEventListener("click",dt);var pt=(0,D.default)("requestFullscreen",e).name,ht=pt&&function(){return e[pt]()};document.querySelector(".fullscreen-button").addEventListener("click",ht);var vt={canvas:document.createElement("canvas"),overlay:document.querySelector(".captured-overlay"),exit:document.querySelector(".exit-overlay"),url:document.querySelector(".captured-url"),image:document.querySelector(".captured-image"),paused:oe.paused,data:null};vt.context=vt.canvas.getContext("2d"),vt.exit.addEventListener("click",function(){vt.overlay.classList.remove("show"),u(),vt.paused||oe.play()}),document.querySelector(".capture-button").addEventListener("click",l),self.addEventListener("resize",(0,w.default)(h,200),!1),h(),I.setup(),m(),B(),window.state=$,window.audioState=he,window.spawnTargets=L;var mt={main:new U.default.GUI({autoPlace:!1})},gt=Object.assign(document.createElement("div"),{className:"edit-controls"}),yt=function(e){return e.stopPropagation()};mt.main.domElement.addEventListener("keydown",yt),mt.main.domElement.addEventListener("keyup",yt);var _t=!1;document.querySelector(".editor-button").addEventListener("click",function(){return E()});var bt={};ht&&(bt.fullscreen=ht);var wt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s({},$),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return ut.track.tracks.tendrils.smoothTo({to:e,call:t,time:P.track.time,ease:[0,.95,1]})},Et=""+x.prompt_show!="false"?function(){var e;return(e=self).prompt.apply(e,arguments)}:function(){var e;return(e=console).log.apply(e,arguments)};Object.assign(bt,{showLink:function(){return Et("Link:",location.href.replace(location.search||/$/gi,"?"+C.default.encode(s({},x,{track:encodeURIComponent(te.trackURL),mute:!he.audible,track_in:he.track,mic_in:he.mic,use_media:te.useMedia,animate:te.animate}))))},showState:function(){return Et("Current state:",P.track.time,(0,k.default)(st))},showSequence:function(){return Et("Animation sequence:",(0,k.default)(ut.track.frames({})))},keyframe:wt}),mt.main.add(te,"trackURL").onFinishChange(Me),mt.main.add(te,"animate"),mt.main.add(te,"useMedia").onFinishChange(function(){return(te.useMedia?i:qe)()}),mt.main.add(te,"staticImage").onFinishChange(function(){return Ge.src=te.staticImage}),(0,Re.default)(function(e,t){return mt.main.add(bt,t)},bt),mt.settings=mt.main.addFolder("settings");for(var At in $)if(!a($[At]).match(/^(object|array|undefined|null)$/gi)){var xt=mt.settings.add($,At);"rootNum"===At&&xt.onFinishChange(function(e){I.setup(e),X()})}var Tt={baseColor:$.baseColor.slice(0,3).map(function(e){return 255*e}),baseAlpha:$.baseColor[3],flowColor:$.flowColor.slice(0,3).map(function(e){return 255*e}),flowAlpha:$.flowColor[3],fadeColor:$.fadeColor.slice(0,3).map(function(e){return 255*e}),fadeAlpha:$.fadeColor[3]},St=s({},Tt),Mt=function(){$.baseColor[3]=St.baseAlpha,Object.assign($.baseColor,St.baseColor.map(function(e){return e/255})),$.flowColor[3]=St.flowAlpha,Object.assign($.flowColor,St.flowColor.map(function(e){return e/255})),$.fadeColor[3]=St.fadeAlpha,Object.assign($.fadeColor,St.fadeColor.map(function(e){return e/255}))};mt.settings.addColor(St,"flowColor").onChange(Mt),mt.settings.add(St,"flowAlpha").onChange(Mt),mt.settings.addColor(St,"baseColor").onChange(Mt),mt.settings.add(St,"baseAlpha").onChange(Mt),mt.settings.addColor(St,"fadeColor").onChange(Mt),mt.settings.add(St,"fadeAlpha").onChange(Mt),Mt(),mt.blend=mt.main.addFolder("color blend");for(var Rt=["audio","video"],Ct=(0,xe.default)(function(e,t,n){return e[t]=We.alphas[n],e},Rt,{}),Ot=s({},Ct),kt=function(){return(0,xe.default)(function(e,t,n,r,i){return e[i]=t,e},Ct,We.alphas)},Pt=0;Pt<Rt.length;++Pt)mt.blend.add(Ct,Rt[Pt]).onChange(kt);mt.spawn=mt.main.addFolder("spawn");for(var Ft in j.uniforms)a(j.uniforms[Ft]).match(/^(object|array|undefined|null)$/gi)||mt.spawn.add(j.uniforms,Ft);var It={radius:.3,speed:.005};mt.reflow=mt.main.addFolder("reflow"),mt.reflow.add(Ie,"scale",Object.keys(Pe)),mt.time=mt.main.addFolder("time");var Dt=["paused","step","rate","end","loop"];Dt.forEach(function(e){return mt.time.add(P.app,e)}),mt.audio=mt.main.addFolder("audio");for(var Lt in he){var Nt=mt.audio.add(he,Lt);"audible"===Lt&&Nt.onChange(function(e){var t=me.merger||me.analyser;
e?t.connect(me.ctx.destination):t.disconnect()})}mt.blur=mt.main.addFolder("blur");for(var jt in ot)a(at[jt]).match(/^(object|array|undefined|null)$/gi)||mt.blur.add(at,jt);var Ut={clear:Y,clearView:K,clearFlow:Z,respawn:B,spawnSamples:Xe,spawnImage:He,spawnFlow:t,spawnFastest:n,spawnForm:Ne,reset:z,restart:X};mt.controls=mt.main.addFolder("controls");for(var Bt in Ut)mt.controls.add(Ut,Bt);mt.presets=mt.main.addFolder("presets");var Vt={Flow:function(){Object.assign($,{flowWidth:5,colorMapAlpha:0}),Object.assign(j.uniforms,{radius:.25,speed:.01}),Object.assign(St,{baseAlpha:0,baseColor:[0,0,0],flowAlpha:1,flowColor:[255,255,255],fadeAlpha:Math.max($.flowDecay,.05)})},Wings:function(){Object.assign(j.uniforms,{radius:.1,speed:0,colorMapAlpha:0}),Object.assign(St,{flowAlpha:.01,baseAlpha:.2}),Object.assign(St)},Fluid:function(){Object.assign($,{autoClearView:!0}),Object.assign(St,{fadeAlpha:0})},"Flow only":function(){Object.assign($,{flowDecay:.001,forceWeight:.014,noiseWeight:0,speedAlpha:0}),Object.assign(j.uniforms,{radius:.4,speed:.15}),Object.assign(St,{baseAlpha:.8,baseColor:[100,200,255],fadeAlpha:.1})},"Noise only":function(){Object.assign($,{flowWeight:0,noiseWeight:.003,noiseSpeed:5e-4,noiseScale:1.5,varyNoiseScale:10,varyNoiseSpeed:.05,speedAlpha:0,colorMapAlpha:.8}),Object.assign(St,{baseAlpha:.1,baseColor:[255,150,0],fadeAlpha:.05}),Object.assign(Ct,{audio:.9,cam:0})},Sea:function(){Object.assign($,{flowWidth:5,forceWeight:.013,noiseWeight:.002,flowDecay:.01,speedAlpha:0,colorMapAlpha:.4}),Object.assign(j.uniforms,{radius:1.5,speed:0}),Object.assign(St,{baseAlpha:.8,baseColor:[55,155,255],fadeAlpha:.3,fadeColor:[0,58,90]})},Ghostly:function(){Object.assign($,{flowDecay:0,colorMapAlpha:.005}),Object.assign(St,{baseAlpha:.01,flowAlpha:.05})},Petri:function(){Object.assign($,{forceWeight:.015,noiseWeight:.001,flowDecay:.001,noiseScale:200,noiseSpeed:1e-4}),Object.assign(St,{baseAlpha:.3,baseColor:[255,203,37],flowAlpha:.05,fadeAlpha:.01}),Object.assign(j.uniforms,{radius:1/Math.max.apply(Math,o(I.viewSize)),speed:0})},Turbulence:function(){Object.assign($,{noiseSpeed:5e-5,noiseScale:10,forceWeight:.014,noiseWeight:.003,speedAlpha:2e-6,colorMapAlpha:.3}),Object.assign(St,{baseAlpha:.3,baseColor:[100,0,0],flowAlpha:.5,flowColor:[255,10,10],fadeAlpha:.01,fadeColor:[0,0,0]})},Rorschach:function(){Object.assign($,{noiseScale:40,varyNoiseScale:.1,noiseSpeed:1e-5,varyNoiseSpeed:.01,forceWeight:.014,noiseWeight:.0021,speedAlpha:2e-6,colorMapAlpha:.2}),Object.assign(Ie,{scale:"mirror xy"}),Object.assign(St,{baseAlpha:.9,baseColor:[0,0,0],flowAlpha:.1,fadeAlpha:.05,fadeColor:[255,255,255]})},Roots:function(){Object.assign($,{flowDecay:0,noiseSpeed:0,noiseScale:18,forceWeight:.015,noiseWeight:.0023,speedAlpha:5e-5,lineWidth:3,colorMapAlpha:1e-4}),Object.assign(St,{baseAlpha:.02,baseColor:[50,255,50],flowAlpha:.05})},Funhouse:function(){Object.assign($,{forceWeight:.0165,varyForce:.3,flowWeight:.5,varyFlow:1,noiseWeight:.0015,varyNoise:1,noiseScale:40,varyNoiseScale:-4,noiseSpeed:1e-4,varyNoiseSpeed:-3,flowDecay:.001,flowWidth:8,speedAlpha:2e-5,colorMapAlpha:1}),Object.assign(St,{baseAlpha:.2,baseColor:[0,0,0],flowAlpha:.05,fadeAlpha:.05,fadeColor:[0,0,0]}),He()}},zt=function(e){Object.assign($,R),Object.assign(j.uniforms,It),Object.assign(Ie,Fe),Object.assign(St,Tt),Object.assign(Ct,Ot),e(),y(),Mt(),kt()};for(var Gt in Vt)Vt[Gt]=zt.bind(null,Vt[Gt]),mt.presets.add(Vt,Gt);b(!0),E(!1),setTimeout(function(){return mt.main.open()},200),gt.appendChild(mt.main.domElement),e.parentElement.appendChild(gt),function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe.paused;return e?oe.play():oe.pause()},r=function(t){oe.currentTime+=.001*t,e(!0)},i=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];wt(null,t),(0,Re.default)(function(e){return e()},t)},o=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){return i.apply(void 0,t)}},a=function(e){(0,Re.default)(function(e){return e.reset&&e.reset()},e),y()},u=(0,Ee.curry)(function(e,t){(0,Re.default)(function(t){return t.adjust&&t.adjust(e)},t),y()}),c=function(e,t,n){return e[n]=t[n]},l=(0,Ee.curry)(c,c.length+1),d=function(e,t,n,r){return e[t]+=n*r},p=(0,Ee.curry)(d),h=function(e,t){return e[t]=!e[t]},v=(0,Ee.curry)(h,h.length+1),m=l($,R),g=p($),_=v($),b=function(e){return{reset:m(e),go:_(e)}},w=function(e,t){return{reset:m(e),adjust:g(e,t)}},A={},x={"`":{reset:function(){I.setup(R.rootNum),X()},adjust:function(e){I.setup($.rootNum*Math.pow(2,e)),X()}},P:b("autoClearView"),Q:w("forceWeight",.01),A:w("flowWeight",.02),W:w("noiseWeight",2e-4),S:w("flowDecay",.005),D:w("flowWidth",1),E:w("noiseScale",1),R:w("noiseSpeed",.002),Z:w("damping",.001),X:w("speedLimit",1e-4),N:w("speedAlpha",.002),M:w("lineWidth",.1),"<control>":function(e,t){delete x[e],delete T[e],T[e]=o(function(){return Object.assign($,t)})}},T={H:function(){return E()},O:o(function(){return I.clear()}),0:o(Vt.Flow),1:o(Vt.Wings),2:o(Vt.Fluid),3:o(Vt["Flow only"]),4:o(Vt["Noise only"]),5:o(Vt.Sea),6:o(Vt.Petri),7:o(Vt.Turbulence),8:o(Vt.Rorschach),9:o(Vt.Funhouse),"-":u(-.1),"=":u(.1),"<down>":u(-1),"<up>":u(1),"<left>":u(-5),"<right>":u(5),"<escape>":function(){a(x),wt.apply(void 0,arguments)},"<caps-lock>":a,"<space>":function(){return e()},"[":function(){return r(-2e3)},"]":function(){return r(2e3)},"<enter>":wt,"<backspace>":function(){return ut.track.trackAt(P.track.time).spliceAt(P.track.time)},"\\":o(function(){return z()}),"'":o(function(){return t()}),";":o(function(){return n()}),"<shift>":o(function(){return X()}),"/":o(function(){return Xe()}),".":o(function(){return He()}),",":o(function(){return Ne()})};ht&&(T.F=ht),document.body.addEventListener("keydown",function(e){var t=A["<control>"],n=f.default[e.keyCode],r=x[n],i=T[n];t?t(n,s({},$)):r&&!A[n]?(A[n]=r,r.go&&r.go(A,$)):i&&i(A,$),y(),(r||i)&&(e.preventDefault(),e.stopPropagation())},!1),document.body.addEventListener("keyup",function(e){var t=f.default[e.keyCode],n=x[t],r=T[t];n&&A[t]&&("<control>"===t||A["<control>"]||wt(s({},$)),A[t]=null,delete A[t]),(n||r)&&(e.preventDefault(),e.stopPropagation())},!1)}()}}},function(e,t,n){/*!
	 * PEP v0.4.2 | https://github.com/jquery/PEP
	 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
	 */
!function(t,n){e.exports=n()}(this,function(){"use strict";function e(e,t){t=t||Object.create(null);var n=document.createEvent("Event");n.initEvent(e,t.bubbles||!1,t.cancelable||!1);for(var r,i=2;i<d.length;i++)r=d[i],n[r]=t[r]||p[i];n.buttons=t.buttons||0;var o=0;return o=t.pressure&&n.buttons?t.pressure:n.buttons?.5:0,n.x=n.clientX,n.y=n.clientY,n.pointerId=t.pointerId||0,n.width=t.width||0,n.height=t.height||0,n.pressure=o,n.tiltX=t.tiltX||0,n.tiltY=t.tiltY||0,n.pointerType=t.pointerType||"",n.hwTimestamp=t.hwTimestamp||0,n.isPrimary=t.isPrimary||!1,n}function t(){this.array=[],this.size=0}function n(e,t,n,r){this.addCallback=e.bind(r),this.removeCallback=t.bind(r),this.changedCallback=n.bind(r),S&&(this.observer=new S(this.mutationWatcher.bind(this)))}function r(e){return"body /shadow-deep/ "+i(e)}function i(e){return'[touch-action="'+e+'"]'}function o(e){return"{ -ms-touch-action: "+e+"; touch-action: "+e+"; }"}function a(){if(k){C.forEach(function(e){String(e)===e?(O+=i(e)+o(e)+"\n",P&&(O+=r(e)+o(e)+"\n")):(O+=e.selectors.map(i)+o(e.rule)+"\n",P&&(O+=e.selectors.map(r)+o(e.rule)+"\n"))});var e=document.createElement("style");e.textContent=O,document.head.appendChild(e)}}function s(){if(!window.PointerEvent){if(window.PointerEvent=e,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0}),b.registerSource("ms",Z)}else b.registerSource("mouse",j),void 0!==window.ontouchstart&&b.registerSource("touch",q);b.register(document)}}function u(e){if(!b.pointermap.has(e)){var t=new Error("InvalidPointerId");throw t.name="InvalidPointerId",t}}function c(e){if(!e.ownerDocument.contains(e)){var t=new Error("InvalidStateError");throw t.name="InvalidStateError",t}}function l(e){var t=b.pointermap.get(e);return 0!==t.buttons}function f(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:Y},releasePointerCapture:{value:W}})}var d=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],p=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],h=window.Map&&window.Map.prototype.forEach,v=h?Map:t;t.prototype={set:function(e,t){return void 0===t?this.delete(e):(this.has(e)||this.size++,void(this.array[e]=t))},has:function(e){return void 0!==this.array[e]},delete:function(e){this.has(e)&&(delete this.array[e],this.size--)},get:function(e){return this.array[e]},clear:function(){this.array.length=0,this.size=0},forEach:function(e,t){return this.array.forEach(function(n,r){e.call(t,n,r,this)},this)}};var m=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],g=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],y={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},_="undefined"!=typeof SVGElementInstance,b={pointermap:new v,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(e,t){var n=t,r=n.events;r&&(r.forEach(function(e){n[e]&&(this.eventMap[e]=n[e].bind(n))},this),this.eventSources[e]=n,this.eventSourceList.push(n))},register:function(e){for(var t,n=this.eventSourceList.length,r=0;r<n&&(t=this.eventSourceList[r]);r++)t.register.call(t,e)},unregister:function(e){for(var t,n=this.eventSourceList.length,r=0;r<n&&(t=this.eventSourceList[r]);r++)t.unregister.call(t,e)},contains:function(e,t){try{return e.contains(t)}catch(e){return!1}},down:function(e){e.bubbles=!0,this.fireEvent("pointerdown",e)},move:function(e){e.bubbles=!0,this.fireEvent("pointermove",e)},up:function(e){e.bubbles=!0,this.fireEvent("pointerup",e)},enter:function(e){e.bubbles=!1,this.fireEvent("pointerenter",e)},leave:function(e){e.bubbles=!1,this.fireEvent("pointerleave",e)},over:function(e){e.bubbles=!0,this.fireEvent("pointerover",e)},out:function(e){e.bubbles=!0,this.fireEvent("pointerout",e)},cancel:function(e){e.bubbles=!0,this.fireEvent("pointercancel",e)},leaveOut:function(e){this.out(e),this.propagate(e,this.leave,!1)},enterOver:function(e){this.over(e),this.propagate(e,this.enter,!0)},eventHandler:function(e){if(!e._handledByPE){var t=e.type,n=this.eventMap&&this.eventMap[t];n&&n(e),e._handledByPE=!0}},listen:function(e,t){t.forEach(function(t){this.addEvent(e,t)},this)},unlisten:function(e,t){t.forEach(function(t){this.removeEvent(e,t)},this)},addEvent:function(e,t){e.addEventListener(t,this.boundHandler)},removeEvent:function(e,t){e.removeEventListener(t,this.boundHandler)},makeEvent:function(t,n){this.captureInfo[n.pointerId]&&(n.relatedTarget=null);var r=new e(t,n);return n.preventDefault&&(r.preventDefault=n.preventDefault),r._target=r._target||n.target,r},fireEvent:function(e,t){var n=this.makeEvent(e,t);return this.dispatchEvent(n)},cloneEvent:function(e){for(var t,n=Object.create(null),r=0;r<m.length;r++)t=m[r],n[t]=e[t]||g[r],!_||"target"!==t&&"relatedTarget"!==t||n[t]instanceof SVGElementInstance&&(n[t]=n[t].correspondingUseElement);return e.preventDefault&&(n.preventDefault=function(){e.preventDefault()}),n},getTarget:function(e){var t=this.captureInfo[e.pointerId];return t?e._target!==t&&e.type in y?void 0:t:e._target},propagate:function(e,t,n){for(var r=e.target,i=[];!r.contains(e.relatedTarget)&&r!==document;)i.push(r),r=r.parentNode;n&&i.reverse(),i.forEach(function(n){e.target=n,t.call(this,e)},this)},setCapture:function(t,n){this.captureInfo[t]&&this.releaseCapture(t),this.captureInfo[t]=n;var r=new e("gotpointercapture");r.pointerId=t,this.implicitRelease=this.releaseCapture.bind(this,t),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease),r._target=n,this.asyncDispatchEvent(r)},releaseCapture:function(t){var n=this.captureInfo[t];if(n){var r=new e("lostpointercapture");r.pointerId=t,this.captureInfo[t]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease),r._target=n,this.asyncDispatchEvent(r)}},dispatchEvent:function(e){var t=this.getTarget(e);if(t)return t.dispatchEvent(e)},asyncDispatchEvent:function(e){requestAnimationFrame(this.dispatchEvent.bind(this,e))}};b.boundHandler=b.eventHandler.bind(b);var w={shadow:function(e){if(e)return e.shadowRoot||e.webkitShadowRoot},canTarget:function(e){return e&&Boolean(e.elementFromPoint)},targetingShadow:function(e){var t=this.shadow(e);if(this.canTarget(t))return t},olderShadow:function(e){var t=e.olderShadowRoot;if(!t){var n=e.querySelector("shadow");n&&(t=n.olderShadowRoot)}return t},allShadows:function(e){for(var t=[],n=this.shadow(e);n;)t.push(n),n=this.olderShadow(n);return t},searchRoot:function(e,t,n){if(e){var r,i,o=e.elementFromPoint(t,n);for(i=this.targetingShadow(o);i;){if(r=i.elementFromPoint(t,n)){var a=this.targetingShadow(r);return this.searchRoot(a,t,n)||r}i=this.olderShadow(i)}return o}},owner:function(e){for(var t=e;t.parentNode;)t=t.parentNode;return t.nodeType!==Node.DOCUMENT_NODE&&t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(t=document),t},findTarget:function(e){var t=e.clientX,n=e.clientY,r=this.owner(e.target);return r.elementFromPoint(t,n)||(r=document),this.searchRoot(r,t,n)}},E=Array.prototype.forEach.call.bind(Array.prototype.forEach),A=Array.prototype.map.call.bind(Array.prototype.map),x=Array.prototype.slice.call.bind(Array.prototype.slice),T=Array.prototype.filter.call.bind(Array.prototype.filter),S=window.MutationObserver||window.WebKitMutationObserver,M="[touch-action]",R={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};n.prototype={watchSubtree:function(e){this.observer&&w.canTarget(e)&&this.observer.observe(e,R)},enableOnSubtree:function(e){this.watchSubtree(e),e===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(e)},installNewSubtree:function(e){E(this.findElements(e),this.addElement,this)},findElements:function(e){return e.querySelectorAll?e.querySelectorAll(M):[]},removeElement:function(e){this.removeCallback(e)},addElement:function(e){this.addCallback(e)},elementChanged:function(e,t){this.changedCallback(e,t)},concatLists:function(e,t){return e.concat(x(t))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(e){return e.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(e){var t=A(e,this.findElements,this);return t.push(T(e,this.isElement)),t.reduce(this.concatLists,[])},mutationWatcher:function(e){e.forEach(this.mutationHandler,this)},mutationHandler:function(e){if("childList"===e.type){var t=this.flattenMutationTree(e.addedNodes);t.forEach(this.addElement,this);var n=this.flattenMutationTree(e.removedNodes);n.forEach(this.removeElement,this)}else"attributes"===e.type&&this.elementChanged(e.target,e.oldValue)}};var C=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],O="",k=window.PointerEvent||window.MSPointerEvent,P=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,F=b.pointermap,I=25,D=[1,4,2,8,16],L=!1;try{L=1===new MouseEvent("test",{buttons:1}).buttons}catch(e){}var N,j={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(e){b.listen(e,this.events)},unregister:function(e){b.unlisten(e,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(e){for(var t,n=this.lastTouches,r=e.clientX,i=e.clientY,o=0,a=n.length;o<a&&(t=n[o]);o++){var s=Math.abs(r-t.x),u=Math.abs(i-t.y);if(s<=I&&u<=I)return!0}},prepareEvent:function(e){var t=b.cloneEvent(e),n=t.preventDefault;return t.preventDefault=function(){e.preventDefault(),n()},t.pointerId=this.POINTER_ID,t.isPrimary=!0,t.pointerType=this.POINTER_TYPE,t},prepareButtonsForMove:function(e,t){var n=F.get(this.POINTER_ID);0!==t.which&&n?e.buttons=n.buttons:e.buttons=0,t.buttons=e.buttons},mousedown:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=F.get(this.POINTER_ID),n=this.prepareEvent(e);L||(n.buttons=D[n.button],t&&(n.buttons|=t.buttons),e.buttons=n.buttons),F.set(this.POINTER_ID,e),t&&0!==t.buttons?b.move(n):b.down(n)}},mousemove:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);L||this.prepareButtonsForMove(t,e),t.button=-1,F.set(this.POINTER_ID,e),b.move(t)}},mouseup:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=F.get(this.POINTER_ID),n=this.prepareEvent(e);if(!L){var r=D[n.button];n.buttons=t?t.buttons&~r:0,e.buttons=n.buttons}F.set(this.POINTER_ID,e),n.buttons&=~D[n.button],0===n.buttons?b.up(n):b.move(n)}},mouseover:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);L||this.prepareButtonsForMove(t,e),t.button=-1,F.set(this.POINTER_ID,e),b.enterOver(t)}},mouseout:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);L||this.prepareButtonsForMove(t,e),t.button=-1,b.leaveOut(t)}},cancel:function(e){var t=this.prepareEvent(e);b.cancel(t),this.deactivateMouse()},deactivateMouse:function(){F.delete(this.POINTER_ID)}},U=b.captureInfo,B=w.findTarget.bind(w),V=w.allShadows.bind(w),z=b.pointermap,G=2500,H=200,X="touch-action",q={events:["touchstart","touchmove","touchend","touchcancel"],register:function(e){N.enableOnSubtree(e)},unregister:function(){},elementAdded:function(e){var t=e.getAttribute(X),n=this.touchActionToScrollType(t);n&&(e._scrollType=n,b.listen(e,this.events),V(e).forEach(function(e){e._scrollType=n,b.listen(e,this.events)},this))},elementRemoved:function(e){e._scrollType=void 0,b.unlisten(e,this.events),V(e).forEach(function(e){e._scrollType=void 0,b.unlisten(e,this.events)},this)},elementChanged:function(e,t){var n=e.getAttribute(X),r=this.touchActionToScrollType(n),i=this.touchActionToScrollType(t);r&&i?(e._scrollType=r,V(e).forEach(function(e){e._scrollType=r},this)):i?this.elementRemoved(e):r&&this.elementAdded(e)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(e){var t=e,n=this.scrollTypes;return"none"===t?"none":t===n.XSCROLLER?"X":t===n.YSCROLLER?"Y":n.SCROLLER.exec(t)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(e){return this.firstTouch===e.identifier},setPrimaryTouch:function(e){(0===z.size||1===z.size&&z.has(1))&&(this.firstTouch=e.identifier,this.firstXY={X:e.clientX,Y:e.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(e){e.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var e=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(e,H)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(e){var t=0;return"touchstart"!==e&&"touchmove"!==e||(t=1),t},touchToPointer:function(e){var t=this.currentTouchEvent,n=b.cloneEvent(e),r=n.pointerId=e.identifier+2;n.target=U[r]||B(n),n.bubbles=!0,n.cancelable=!0,n.detail=this.clickCount,n.button=0,n.buttons=this.typeToButtons(t.type),n.width=e.radiusX||e.webkitRadiusX||0,n.height=e.radiusY||e.webkitRadiusY||0,n.pressure=e.force||e.webkitForce||.5,n.isPrimary=this.isPrimaryTouch(e),n.pointerType=this.POINTER_TYPE,n.altKey=t.altKey,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey;var i=this;return n.preventDefault=function(){i.scrolling=!1,i.firstXY=null,t.preventDefault()},n},processTouches:function(e,t){var n=e.changedTouches;this.currentTouchEvent=e;for(var r,i=0;i<n.length;i++)r=n[i],t.call(this,this.touchToPointer(r))},shouldScroll:function(e){if(this.firstXY){var t,n=e.currentTarget._scrollType;if("none"===n)t=!1;else if("XY"===n)t=!0;else{var r=e.changedTouches[0],i=n,o="Y"===n?"X":"Y",a=Math.abs(r["client"+i]-this.firstXY[i]),s=Math.abs(r["client"+o]-this.firstXY[o]);t=a>=s}return this.firstXY=null,t}},findTouch:function(e,t){for(var n,r=0,i=e.length;r<i&&(n=e[r]);r++)if(n.identifier===t)return!0},vacuumTouches:function(e){var t=e.touches;if(z.size>=t.length){var n=[];z.forEach(function(e,r){if(1!==r&&!this.findTouch(t,r-2)){var i=e.out;n.push(i)}},this),n.forEach(this.cancelOut,this)}},touchstart:function(e){this.vacuumTouches(e),this.setPrimaryTouch(e.changedTouches[0]),this.dedupSynthMouse(e),this.scrolling||(this.clickCount++,this.processTouches(e,this.overDown))},overDown:function(e){z.set(e.pointerId,{target:e.target,out:e,outTarget:e.target}),b.enterOver(e),b.down(e)},touchmove:function(e){this.scrolling||(this.shouldScroll(e)?(this.scrolling=!0,this.touchcancel(e)):(e.preventDefault(),this.processTouches(e,this.moveOverOut)))},moveOverOut:function(e){var t=e,n=z.get(t.pointerId);if(n){var r=n.out,i=n.outTarget;b.move(t),r&&i!==t.target&&(r.relatedTarget=t.target,t.relatedTarget=i,r.target=i,t.target?(b.leaveOut(r),b.enterOver(t)):(t.target=i,t.relatedTarget=null,this.cancelOut(t))),n.out=t,n.outTarget=t.target}},touchend:function(e){this.dedupSynthMouse(e),this.processTouches(e,this.upOut)},upOut:function(e){this.scrolling||(b.up(e),b.leaveOut(e)),this.cleanUpPointer(e)},touchcancel:function(e){this.processTouches(e,this.cancelOut)},cancelOut:function(e){b.cancel(e),b.leaveOut(e),this.cleanUpPointer(e)},cleanUpPointer:function(e){z.delete(e.pointerId),this.removePrimaryPointer(e)},dedupSynthMouse:function(e){var t=j.lastTouches,n=e.changedTouches[0];if(this.isPrimaryTouch(n)){var r={x:n.clientX,y:n.clientY};t.push(r);var i=function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}.bind(null,t,r);setTimeout(i,G)}}};N=new n(q.elementAdded,q.elementRemoved,q.elementChanged,q);var Y,W,K=b.pointermap,J=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,Z={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(e){b.listen(e,this.events)},unregister:function(e){b.unlisten(e,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(e){var t=e;return J&&(t=b.cloneEvent(e),t.pointerType=this.POINTER_TYPES[e.pointerType]),t},cleanup:function(e){K.delete(e)},MSPointerDown:function(e){K.set(e.pointerId,e);var t=this.prepareEvent(e);b.down(t)},MSPointerMove:function(e){var t=this.prepareEvent(e);b.move(t)},MSPointerUp:function(e){var t=this.prepareEvent(e);b.up(t),this.cleanup(e.pointerId)},MSPointerOut:function(e){var t=this.prepareEvent(e);b.leaveOut(t)},MSPointerOver:function(e){var t=this.prepareEvent(e);b.enterOver(t)},MSPointerCancel:function(e){var t=this.prepareEvent(e);b.cancel(t),this.cleanup(e.pointerId)},MSLostPointerCapture:function(e){var t=b.makeEvent("lostpointercapture",e);b.dispatchEvent(t)},MSGotPointerCapture:function(e){var t=b.makeEvent("gotpointercapture",e);b.dispatchEvent(t)}},Q=window.navigator;Q.msPointerEnabled?(Y=function(e){u(e),c(this),l(e)&&this.msSetPointerCapture(e)},W=function(e){u(e),this.msReleasePointerCapture(e)}):(Y=function(e){u(e),c(this),l(e)&&b.setCapture(e,this)},W=function(e){u(e),b.releaseCapture(e,this)}),a(),s(),f();var $={dispatcher:b,Installer:n,PointerEvent:e,PointerMap:v,targetFinding:w};return $})},function(e,t,n){function r(e,t,n){function r(){n(o),i(r)}"function"==typeof t?(n=t,t={}):t=t||{};var o=e.getContext("webgl",t)||e.getContext("webgl-experimental",t)||e.getContext("experimental-webgl",t);if(!o)throw new Error("Unable to initialize WebGL");return n&&i(r),o}var i=n(5);e.exports=r},function(e,t){function n(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-r)),i=setTimeout(e,n);return r=t,i}t=e.exports=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||n;var r=(new Date).getTime(),i=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout;t.cancel=function(e){i.call(window,e)}},function(e,t){var n,r="undefined"!=typeof window?window.navigator.userAgent:"",i=/OS X/.test(r),o=/Opera/.test(r),a=!/like Gecko/.test(r)&&!o,s=e.exports={0:i?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:i?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num-->",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:i&&a?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:o?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(n=58;n<65;++n)s[n]=String.fromCharCode(n);for(n=48;n<58;++n)s[n]=n-48+"";for(n=65;n<91;++n)s[n]=String.fromCharCode(n);for(n=96;n<106;++n)s[n]="<num-"+(n-96)+">";for(n=112;n<136;++n)s[n]="F"+(n-111)},function(e,t,n){n(8);e.exports=function(e,t){var n,r=2===arguments.length,i={video:!0,audio:!0},o="PermissionDeniedError",a="PERMISSION_DENIED",s="ConstraintNotSatisfiedError";return r||(t=e,e=i),"undefined"!=typeof navigator&&navigator.getUserMedia?e.audio||e.video?(localStorage&&"true"===localStorage.useFirefoxFakeDevice&&(e.fake=!0),void navigator.mediaDevices.getUserMedia(e).then(function(e){t(null,e)}).catch(function(e){var n;"string"==typeof e?(n=new Error("MediaStreamError"),e===o||e===a?n.name=o:n.name=s):(n=e,n.name||(n[o]?e.name=o:e.name=s)),t(n)})):(n=new Error("MediaStreamError"),n.name="NoMediaRequestedError",setTimeout(function(){t(n)},0)):(n=new Error("MediaStreamError"),n.name="NotSupportedError",setTimeout(function(){t(n)},0))}},function(e,t,n){"use strict";!function(){var t=n(9).log,r=n(9).browserDetails;e.exports.browserDetails=r,e.exports.extractVersion=n(9).extractVersion,e.exports.disableLog=n(9).disableLog;var i=n(10)||null,o=n(12)||null,a=n(15)||null,s=n(17)||null;switch(r.browser){case"opera":case"chrome":if(!i||!i.shimPeerConnection)return void t("Chrome shim is not included in this adapter release.");t("adapter.js shimming chrome."),e.exports.browserShim=i,i.shimGetUserMedia(),i.shimMediaStream(),i.shimSourceObject(),i.shimPeerConnection(),i.shimOnTrack();break;case"firefox":if(!a||!a.shimPeerConnection)return void t("Firefox shim is not included in this adapter release.");t("adapter.js shimming firefox."),e.exports.browserShim=a,a.shimGetUserMedia(),a.shimSourceObject(),a.shimPeerConnection(),a.shimOnTrack();break;case"edge":if(!o||!o.shimPeerConnection)return void t("MS edge shim is not included in this adapter release.");t("adapter.js shimming edge."),e.exports.browserShim=o,o.shimGetUserMedia(),o.shimPeerConnection();break;case"safari":if(!s)return void t("Safari shim is not included in this adapter release.");t("adapter.js shimming safari."),e.exports.browserShim=s,s.shimGetUserMedia();break;default:t("Unsupported browser!")}}()},function(e,t){"use strict";var n=!0,r={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(n=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},log:function(){if("object"==typeof window){if(n)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(){var e={};if(e.browser=null,e.version=null,e.minVersion=null,"undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),e.minVersion=31;else if(navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),e.minVersion=38;else{if(!navigator.userAgent.match(/Version\/(\d+).(\d+)/))return e.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/([0-9]+)\./,1),e.minVersion=602}else{if(!navigator.mediaDevices||!navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))return e.browser="Not a supported browser.",e;e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),e.minVersion=10547}return e.version<e.minVersion&&r.log("Browser: "+e.browser+" Version: "+e.version+" < minimum supported version: "+e.minVersion+"\n some things might not work!"),e}};e.exports={log:r.log,disableLog:r.disableLog,browserDetails:r.detectBrowser(),extractVersion:r.extractVersion}},function(e,t,n){"use strict";var r=n(9).log,i=n(9).browserDetails,o={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){var t=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",function(n){var r=new Event("track");r.track=n.track,r.receiver={track:n.track},r.streams=[e.stream],t.dispatchEvent(r)}),e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;return this._srcObject=e,this.src&&URL.revokeObjectURL(this.src),e?(this.src=URL.createObjectURL(e),e.addEventListener("addtrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)}),void e.addEventListener("removetrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)})):void(this.src="")}}))},shimPeerConnection:function(){window.RTCPeerConnection=function(e,t){r("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new webkitRTCPeerConnection(e,t),i=n.getStats.bind(n);return n.getStats=function(e,t,n){var r=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return i(e,t);var a=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e,t){var n=new Map(Object.keys(e).map(function(t){return[t,e[t]]}));return t=t||e,Object.keys(t).forEach(function(e){n[e]=t[e]}),n};if(arguments.length>=2){var u=function(e){o[1](s(a(e)))};return i.apply(this,[u,arguments[0]])}return new Promise(function(t,n){1===o.length&&"object"==typeof e?i.apply(r,[function(e){t(s(a(e)))},n]):i.apply(r,[function(e){t(s(a(e),e.result()))},n])}).then(t,n)},n},window.RTCPeerConnection.prototype=webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(r,i){t.apply(e,[r,i,n])})}return t.apply(this,arguments)}}),i.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this,r=new Promise(function(r,i){t.apply(n,[e[0],r,i])});return e.length<2?r:r.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return null===arguments[0]?Promise.resolve():e.apply(this,arguments)},["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}})},attachMediaStream:function(e,t){r("DEPRECATED, attachMediaStream will soon be removed."),i.version>=43?e.srcObject=t:"undefined"!=typeof e.src?e.src=URL.createObjectURL(t):r("Error attaching stream to element.")},reattachMediaStream:function(e,t){r("DEPRECATED, reattachMediaStream will soon be removed."),i.version>=43?e.srcObject=t.srcObject:e.src=t.src}};e.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:n(11),attachMediaStream:o.attachMediaStream,reattachMediaStream:o.reattachMediaStream}},function(e,t,n){"use strict";var r=n(9).log;e.exports=function(){var e=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),o={},o[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},t=function(t,n){if(t=JSON.parse(JSON.stringify(t)),t&&t.audio&&(t.audio=e(t.audio)),t&&"object"==typeof t.video){var i=t.video.facingMode;if(i=i&&("object"==typeof i?i:{ideal:i}),i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!navigator.mediaDevices.getSupportedConstraints||!navigator.mediaDevices.getSupportedConstraints().facingMode)&&(delete t.video.facingMode,"environment"===i.exact||"environment"===i.ideal))return navigator.mediaDevices.enumerateDevices().then(function(o){o=o.filter(function(e){return"videoinput"===e.kind});var a=o.find(function(e){return e.label.toLowerCase().indexOf("back")!==-1})||o.length&&o[o.length-1];return a&&(t.video.deviceId=i.exact?{exact:a.deviceId}:{ideal:a.deviceId}),t.video=e(t.video),r("chrome: "+JSON.stringify(t)),n(t)});t.video=e(t.video)}return r("chrome: "+JSON.stringify(t)),n(t)},n=function(e){return{name:{PermissionDeniedError:"NotAllowedError",ConstraintNotSatisfiedError:"OverconstrainedError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},i=function(e,r,i){t(e,function(e){navigator.webkitGetUserMedia(e,r,function(e){i(n(e))})})};navigator.getUserMedia=i;var o=function(e){return new Promise(function(t,n){navigator.getUserMedia(e,t,n)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:o,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return t(e,function(e){return a(e).catch(function(e){return Promise.reject(n(e))})})}}else navigator.mediaDevices.getUserMedia=function(e){return o(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},function(e,t,n){"use strict";var r=n(13),i=n(9).log,o={shimPeerConnection:function(){
window.RTCIceGatherer&&(window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e})),window.RTCPeerConnection=function(e){var t=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=n[e].bind(n)}),this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return t.localStreams},this.getRemoteStreams=function(){return t.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},e&&e.iceTransportPolicy)switch(e.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=e.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}if(this.usingBundle=e&&"max-bundle"===e.bundlePolicy,e&&e.iceServers){var r=JSON.parse(JSON.stringify(e.iceServers));this.iceOptions.iceServers=r.filter(function(e){if(e&&e.urls){var t=e.urls;return"string"==typeof t&&(t=[t]),t=t.filter(function(e){return 0===e.indexOf("turn:")&&e.indexOf("transport=udp")!==-1})[0],!!t}return!1})}this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var e=this,t=r.splitSections(e.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(n){var r=!n.candidate||0===Object.keys(n.candidate).length;if(r)for(var i=1;i<t.length;i++)t[i].indexOf("\r\na=end-of-candidates\r\n")===-1&&(t[i]+="a=end-of-candidates\r\n");else n.candidate.candidate.indexOf("typ endOfCandidates")===-1&&(t[n.candidate.sdpMLineIndex+1]+="a="+n.candidate.candidate+"\r\n");if(e.localDescription.sdp=t.join(""),e.dispatchEvent(n),null!==e.onicecandidate&&e.onicecandidate(n),!n.candidate&&"complete"!==e.iceGatheringState){var o=e.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});o&&(e.iceGatheringState="complete")}}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.addStream=function(e){this.localStreams.push(e.clone()),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);t>-1&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},window.RTCPeerConnection.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},window.RTCPeerConnection.prototype._getCommonCapabilities=function(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]};return e.codecs.forEach(function(e){for(var r=0;r<t.codecs.length;r++){var i=t.codecs[r];if(e.name.toLowerCase()===i.name.toLowerCase()&&e.clockRate===i.clockRate&&e.numChannels===i.numChannels){n.codecs.push(i);break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(e,t){var n=this,i=new RTCIceGatherer(n.iceOptions),o=new RTCIceTransport(i);i.onlocalcandidate=function(a){var s=new Event("icecandidate");s.candidate={sdpMid:e,sdpMLineIndex:t};var u=a.candidate,c=!u||0===Object.keys(u).length;c?(void 0===i.state&&(i.state="completed"),s.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates"):(u.component="RTCP"===o.component?2:1,s.candidate.candidate=r.writeCandidate(u));var l=r.splitSections(n.localDescription.sdp);s.candidate.candidate.indexOf("typ endOfCandidates")===-1?l[s.candidate.sdpMLineIndex+1]+="a="+s.candidate.candidate+"\r\n":l[s.candidate.sdpMLineIndex+1]+="a=end-of-candidates\r\n",n.localDescription.sdp=l.join("");var f=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});switch(n.iceGatheringState){case"new":n._localIceCandidatesBuffer.push(s),c&&f&&n._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case"gathering":n._emitBufferedCandidates(),n.dispatchEvent(s),null!==n.onicecandidate&&n.onicecandidate(s),f&&(n.dispatchEvent(new Event("icecandidate")),null!==n.onicecandidate&&n.onicecandidate(new Event("icecandidate")),n.iceGatheringState="complete");break;case"complete":}},o.onicestatechange=function(){n._updateConnectionState()};var a=new RTCDtlsTransport(o);return a.ondtlsstatechange=function(){n._updateConnectionState()},a.onerror=function(){a.state="failed",n._updateConnectionState()},{iceGatherer:i,iceTransport:o,dtlsTransport:a}},window.RTCPeerConnection.prototype._transceive=function(e,t,n){var i=this._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:r.localCName},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&(i.encodings=e.recvEncodingParameters,i.rtcp={cname:e.cname},e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},window.RTCPeerConnection.prototype.setLocalDescription=function(e){var t,n,i=this;if("offer"===e.type)this._pendingOffer&&(t=r.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=r.parseRtpParameters(e);i._pendingOffer[t].localCapabilities=n}),this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===e.type){t=r.splitSections(i.remoteDescription.sdp),n=t.shift();var o=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var a=i.transceivers[t],s=a.iceGatherer,u=a.iceTransport,c=a.dtlsTransport,l=a.localCapabilities,f=a.remoteCapabilities,d="0"===e.split("\n",1)[0].split(" ",2)[1];if(!d){var p=r.getIceParameters(e,n);if(o){var h=r.matchPrefix(e,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});h.length&&u.setRemoteCandidates(h)}var v=r.getDtlsParameters(e,n);o&&(v.role="server"),i.usingBundle&&0!==t||(u.start(s,p,o?"controlling":"controlled"),c.start(v));var m=i._getCommonCapabilities(l,f);i._transceive(a,m.codecs.length>0,!1)}})}switch(this.localDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var a=arguments.length>1&&"function"==typeof arguments[1];if(a){var s=arguments[1];window.setTimeout(function(){s(),"new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),i._emitBufferedCandidates()},0)}var u=Promise.resolve();return u.then(function(){a||("new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),window.setTimeout(i._emitBufferedCandidates.bind(i),500))}),u},window.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t=this,n=new MediaStream,i=[],o=r.splitSections(e.sdp),a=o.shift(),s=r.matchPrefix(a,"a=ice-lite").length>0;switch(this.usingBundle=r.matchPrefix(a,"a=group:BUNDLE ").length>0,o.forEach(function(o,u){var c,l,f,d,p,h,v,m,g,y,_,b,w=r.splitLines(o),E=w[0].substr(2).split(" "),A=E[0],x="0"===E[1],T=r.getDirection(o,a),S=r.parseRtpParameters(o);x||(_=r.getIceParameters(o,a),b=r.getDtlsParameters(o,a),b.role="client"),m=r.parseRtpEncodingParameters(o);var M=r.matchPrefix(o,"a=mid:");M=M.length?M[0].substr(6):r.generateIdentifier();var R,C=r.matchPrefix(o,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];C&&(R=C.value);var O=r.matchPrefix(o,"a=end-of-candidates").length>0,k=r.matchPrefix(o,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});if("offer"!==e.type||x)"answer"!==e.type||x||(c=t.transceivers[u],l=c.iceGatherer,f=c.iceTransport,d=c.dtlsTransport,p=c.rtpSender,h=c.rtpReceiver,v=c.sendEncodingParameters,g=c.localCapabilities,t.transceivers[u].recvEncodingParameters=m,t.transceivers[u].remoteCapabilities=S,t.transceivers[u].cname=R,(s||O)&&k.length&&f.setRemoteCandidates(k),t.usingBundle&&0!==u||(f.start(l,_,"controlling"),d.start(b)),t._transceive(c,"sendrecv"===T||"recvonly"===T,"sendrecv"===T||"sendonly"===T),!h||"sendrecv"!==T&&"sendonly"!==T?delete c.rtpReceiver:(y=h.track,i.push([y,h]),n.addTrack(y)));else{var P=t.usingBundle&&u>0?{iceGatherer:t.transceivers[0].iceGatherer,iceTransport:t.transceivers[0].iceTransport,dtlsTransport:t.transceivers[0].dtlsTransport}:t._createIceAndDtlsTransports(M,u);if(O&&P.iceTransport.setRemoteCandidates(k),g=RTCRtpReceiver.getCapabilities(A),v=[{ssrc:1001*(2*u+2)}],h=new RTCRtpReceiver(P.dtlsTransport,A),y=h.track,i.push([y,h]),n.addTrack(y),t.localStreams.length>0&&t.localStreams[0].getTracks().length>=u){var F=t.localStreams[0].getTracks()[u];p=new RTCRtpSender(F,P.dtlsTransport)}t.transceivers[u]={iceGatherer:P.iceGatherer,iceTransport:P.iceTransport,dtlsTransport:P.dtlsTransport,localCapabilities:g,remoteCapabilities:S,rtpSender:p,rtpReceiver:h,kind:A,mid:M,cname:R,sendEncodingParameters:v,recvEncodingParameters:m},t._transceive(t.transceivers[u],!1,"sendrecv"===T||"sendonly"===T)}}),this.remoteDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}return n.getTracks().length&&(t.remoteStreams.push(n),window.setTimeout(function(){var e=new Event("addstream");e.stream=n,t.dispatchEvent(e),null!==t.onaddstream&&window.setTimeout(function(){t.onaddstream(e)},0),i.forEach(function(r){var i=r[0],o=r[1],a=new Event("track");a.track=i,a.receiver=o,a.streams=[n],t.dispatchEvent(e),null!==t.ontrack&&window.setTimeout(function(){t.ontrack(a)},0)})},0)),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this.dispatchEvent(t),null!==this.onsignalingstatechange&&this.onsignalingstatechange(t)},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){var e=new Event("negotiationneeded");this.dispatchEvent(e),null!==this.onnegotiationneeded&&this.onnegotiationneeded(e)},window.RTCPeerConnection.prototype._updateConnectionState=function(){var e,t=this,n={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};if(this.transceivers.forEach(function(e){n[e.iceTransport.state]++,n[e.dtlsTransport.state]++}),n.connected+=n.completed,e="new",n.failed>0?e="failed":n.connecting>0||n.checking>0?e="connecting":n.disconnected>0?e="disconnected":n.new>0?e="new":(n.connected>0||n.completed>0)&&(e="connected"),e!==t.iceConnectionState){t.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this.dispatchEvent(r),null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange(r)}},window.RTCPeerConnection.prototype.createOffer=function(){var e=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");var t;1===arguments.length&&"function"!=typeof arguments[0]?t=arguments[0]:3===arguments.length&&(t=arguments[2]);var n=[],i=0,o=0;if(this.localStreams.length&&(i=this.localStreams[0].getAudioTracks().length,o=this.localStreams[0].getVideoTracks().length),t){if(t.mandatory||t.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==t.offerToReceiveAudio&&(i=t.offerToReceiveAudio),void 0!==t.offerToReceiveVideo&&(o=t.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(e){n.push({kind:e.kind,track:e,wantReceive:"audio"===e.kind?i>0:o>0}),"audio"===e.kind?i--:"video"===e.kind&&o--});i>0||o>0;)i>0&&(n.push({kind:"audio",wantReceive:!0}),i--),o>0&&(n.push({kind:"video",wantReceive:!0}),o--);var a=r.writeSessionBoilerplate(),s=[];n.forEach(function(t,n){var i,o,a=t.track,u=t.kind,c=r.generateIdentifier(),l=e.usingBundle&&n>0?{iceGatherer:s[0].iceGatherer,iceTransport:s[0].iceTransport,dtlsTransport:s[0].dtlsTransport}:e._createIceAndDtlsTransports(c,n),f=RTCRtpSender.getCapabilities(u),d=[{ssrc:1001*(2*n+1)}];a&&(i=new RTCRtpSender(a,l.dtlsTransport)),t.wantReceive&&(o=new RTCRtpReceiver(l.dtlsTransport,u)),s[n]={iceGatherer:l.iceGatherer,iceTransport:l.iceTransport,dtlsTransport:l.dtlsTransport,localCapabilities:f,remoteCapabilities:null,rtpSender:i,rtpReceiver:o,kind:u,mid:c,sendEncodingParameters:d,recvEncodingParameters:null}}),this.usingBundle&&(a+="a=group:BUNDLE "+s.map(function(e){return e.mid}).join(" ")+"\r\n"),n.forEach(function(t,n){var i=s[n];a+=r.writeMediaSection(i,i.localCapabilities,"offer",e.localStreams[0])}),this._pendingOffer=s;var u=new RTCSessionDescription({type:"offer",sdp:a});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,u),Promise.resolve(u)},window.RTCPeerConnection.prototype.createAnswer=function(){var e=this,t=r.writeSessionBoilerplate();this.usingBundle&&(t+="a=group:BUNDLE "+this.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),this.transceivers.forEach(function(n){var i=e._getCommonCapabilities(n.localCapabilities,n.remoteCapabilities);t+=r.writeMediaSection(n,i,"answer",e.localStreams[0])});var n=new RTCSessionDescription({type:"answer",sdp:t});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,n),Promise.resolve(n)},window.RTCPeerConnection.prototype.addIceCandidate=function(e){if(null===e)this.transceivers.forEach(function(e){e.iceTransport.addRemoteCandidate({})});else{var t=e.sdpMLineIndex;if(e.sdpMid)for(var n=0;n<this.transceivers.length;n++)if(this.transceivers[n].mid===e.sdpMid){t=n;break}var i=this.transceivers[t];if(i){var o=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===o.protocol&&0===o.port)return;if("1"!==o.component)return;"endOfCandidates"===o.type&&(o={}),i.iceTransport.addRemoteCandidate(o);var a=r.splitSections(this.remoteDescription.sdp);a[t+1]+=(o.type?e.candidate.trim():"a=end-of-candidates")+"\r\n",this.remoteDescription.sdp=a.join("")}}return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(n){t[n]&&e.push(t[n].getStats())})});var t=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(n){var r=new Map;Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){r.set(t,e[t]),r[t]=e[t]})}),t&&window.setTimeout(t,0,r),n(r)})})}},attachMediaStream:function(e,t){i("DEPRECATED, attachMediaStream will soon be removed."),e.srcObject=t},reattachMediaStream:function(e,t){i("DEPRECATED, reattachMediaStream will soon be removed."),e.srcObject=t.srcObject}};e.exports={shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:n(14),attachMediaStream:o.attachMediaStream,reattachMediaStream:o.reattachMediaStream}},function(e,t){"use strict";var n={};n.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},n.localCName=n.generateIdentifier(),n.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},n.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},n.matchPrefix=function(e,t){return n.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},n.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1]}return n},n.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},n.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.numChannels=3===t.length?parseInt(t[2],10):1,n},n.writeRtpMap=function(e){var t=e.payloadType;return void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==e.numChannels?"/"+e.numChannels:"")+"\r\n"},n.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),uri:t[1]}},n.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+" "+e.uri+"\r\n"},n.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)t=r[i].trim().split("="),n[t[0].trim()]=t[1];return n},n.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){r.push(t+"="+e.parameters[t])}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},n.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},n.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},n.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},n.getDtlsParameters=function(e,t){var r=n.splitLines(e);r=r.concat(n.splitLines(t));var i=r.filter(function(e){return 0===e.indexOf("a=fingerprint:")})[0].substr(14),o={role:"auto",fingerprints:[{algorithm:i.split(" ")[0],value:i.split(" ")[1]}]};return o},n.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},n.getIceParameters=function(e,t){var r=n.splitLines(e);r=r.concat(n.splitLines(t));var i={usernameFragment:r.filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:r.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)};return i},n.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},n.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=n.splitLines(e),i=r[0].split(" "),o=3;o<i.length;o++){var a=i[o],s=n.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(s){var u=n.parseRtpMap(s),c=n.matchPrefix(e,"a=fmtp:"+a+" ");switch(u.parameters=c.length?n.parseFmtp(c[0]):{},u.rtcpFeedback=n.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(n.parseRtcpFb),t.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(u.name.toUpperCase())}}}return n.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(n.parseExtmap(e))}),t},n.writeRtpDescription=function(e,t){var r="";return r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){r+=n.writeRtpMap(e),r+=n.writeFmtp(e),r+=n.writeRtcpFb(e)}),r+="a=rtcp-mux\r\n",t.headerExtensions.forEach(function(e){r+=n.writeExtmap(e)}),r},n.parseRtpEncodingParameters=function(e){var t,r=[],i=n.parseRtpParameters(e),o=i.fecMechanisms.indexOf("RED")!==-1,a=i.fecMechanisms.indexOf("ULPFEC")!==-1,s=n.matchPrefix(e,"a=ssrc:").map(function(e){return n.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),u=s.length>0&&s[0].ssrc,c=n.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.split(" ");return t.shift(),t.map(function(e){return parseInt(e,10)})});c.length>0&&c[0].length>1&&c[0][0]===u&&(t=c[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var n={ssrc:u,codecPayloadType:parseInt(e.parameters.apt,10),rtx:{payloadType:e.payloadType,ssrc:t}};r.push(n),o&&(n=JSON.parse(JSON.stringify(n)),n.fec={ssrc:t,mechanism:a?"red+ulpfec":"red"},r.push(n))}}),0===r.length&&u&&r.push({ssrc:u});var l=n.matchPrefix(e,"b=");return l.length&&(0===l[0].indexOf("b=TIAS:")?l=parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")&&(l=parseInt(l[0].substr(5),10)),r.forEach(function(e){e.maxBitrate=l})),r},n.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},n.writeMediaSection=function(e,t,r,i){var o=n.writeRtpDescription(e.kind,t);if(o+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",o+=e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n"},n.getDirection=function(e,t){for(var r=n.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return t?n.getDirection(t):"sendrecv"},e.exports=n},function(e,t){"use strict";e.exports=function(){var e=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}},t=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(n){return t(n).catch(function(t){return Promise.reject(e(t))})}}},function(e,t,n){"use strict";var r=n(9).log,i=n(9).browserDetails,o={shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(){if("object"==typeof window&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(i.version<38&&e&&e.iceServers){for(var n=[],r=0;r<e.iceServers.length;r++){var o=e.iceServers[r];if(o.hasOwnProperty("urls"))for(var a=0;a<o.urls.length;a++){var s={url:o.urls[a]};0===o.urls[a].indexOf("turn")&&(s.username=o.username,s.credential=o.credential),n.push(s)}else n.push(e.iceServers[r])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return null===arguments[0]?Promise.resolve():e.apply(this,arguments)};var t=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t},n=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,r,i){return n.apply(this,[e||null]).then(function(e){return t(e)}).then(r,i)}}},attachMediaStream:function(e,t){r("DEPRECATED, attachMediaStream will soon be removed."),e.srcObject=t},reattachMediaStream:function(e,t){r("DEPRECATED, reattachMediaStream will soon be removed."),e.srcObject=t.srcObject}};e.exports={shimOnTrack:o.shimOnTrack,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:n(16),attachMediaStream:o.attachMediaStream,reattachMediaStream:o.reattachMediaStream}},function(e,t,n){"use strict";var r=n(9).log,i=n(9).browserDetails;e.exports=function(){var e=function(e){return{name:{SecurityError:"NotAllowedError",PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},t=function(t,n,o){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof r.ideal?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}}),t.length&&(e.require=t),e};return t=JSON.parse(JSON.stringify(t)),i.version<38&&(r("spec: "+JSON.stringify(t)),t.audio&&(t.audio=a(t.audio)),t.video&&(t.video=a(t.video)),r("ff37: "+JSON.stringify(t))),navigator.mozGetUserMedia(t,n,function(t){o(e(t))})},n=function(e){return new Promise(function(n,r){t(e,n,r)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:n,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})},i.version<41){var o=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return o().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(i.version<49){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return a(t).catch(function(t){return Promise.reject(e(t))})}}navigator.getUserMedia=function(e,n,r){return i.version<44?t(e,n,r):(console.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia"),void navigator.mediaDevices.getUserMedia(e).then(n,r))}}},function(e,t){"use strict";var n={shimGetUserMedia:function(){navigator.getUserMedia=navigator.webkitGetUserMedia}};e.exports={shimGetUserMedia:n.shimGetUserMedia}},function(e,t){function n(e,t,i){if(!(this instanceof n))return new n(e,t,i);if(t instanceof r||(i=t,t=null),i=i||{},this.ctx=t=t||new r,e instanceof AudioNode||(e=e instanceof Audio||e instanceof HTMLAudioElement?t.createMediaElementSource(e):t.createMediaStreamSource(e)),this.analyser=t.createAnalyser(),this.stereo=!!i.stereo,this.audible=i.audible!==!1,this.wavedata=null,this.freqdata=null,this.splitter=null,this.merger=null,this.source=e,this.stereo){this.analyser=[this.analyser],this.analyser.push(t.createAnalyser()),this.splitter=t.createChannelSplitter(2),this.merger=t.createChannelMerger(2),this.output=this.merger,this.source.connect(this.splitter);for(var o=0;o<2;o++)this.splitter.connect(this.analyser[o],o,0),this.analyser[o].connect(this.merger,0,o);this.audible&&this.merger.connect(t.destination)}else this.output=this.source,this.source.connect(this.analyser),this.audible&&this.analyser.connect(t.destination)}var r=window.AudioContext||window.webkitAudioContext;e.exports=n,n.prototype.waveform=function(e,t){e||(e=this.wavedata||(this.wavedata=new Uint8Array((this.analyser[0]||this.analyser).frequencyBinCount)));var n=this.stereo?this.analyser[t||0]:this.analyser;return n.getByteTimeDomainData(e),e},n.prototype.frequencies=function(e,t){e||(e=this.freqdata||(this.freqdata=new Uint8Array((this.analyser[0]||this.analyser).frequencyBinCount)));var n=this.stereo?this.analyser[t||0]:this.analyser;return n.getByteFrequencyData(e),e}},function(e,t,n){function r(e){if(e)throw e}function i(e,t){l||(u(".npm-scb-wrap {\n  font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  font-weight: 200;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 999;\n}\n\n.npm-scb-wrap a {\n  text-decoration: none;\n  color: #000;\n}\n.npm-scb-white\n.npm-scb-wrap a {\n  color: #fff;\n}\n\n.npm-scb-inner {\n  position: absolute;\n  top: -120px; left: 0;\n  padding: 8px;\n  width: 100%;\n  height: 150px;\n  z-index: 2;\n  -webkit-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n     -moz-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n      -ms-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n       -o-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n          transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n}\n.npm-scb-wrap:hover\n.npm-scb-inner {\n  top: 0;\n}\n\n.npm-scb-artwork {\n  position: absolute;\n  top: 16px; left: 16px;\n  width: 104px; height: 104px;\n  box-shadow: 0 0 8px -3px #000;\n  outline: 1px solid rgba(0,0,0,0.1);\n  z-index: 2;\n}\n.npm-scb-white\n.npm-scb-artwork {\n  outline: 1px solid rgba(255,255,255,0.1);\n  box-shadow: 0 0 10px -2px rgba(255,255,255,0.9);\n}\n\n.npm-scb-info {\n  position: absolute;\n  top: 16px;\n  left: 120px;\n  width: 300px;\n  z-index: 1;\n}\n\n.npm-scb-info > a {\n  display: block;\n}\n\n.npm-scb-now-playing {\n  font-size: 12px;\n  line-height: 12px;\n  position: absolute;\n  width: 500px;\n  z-index: 1;\n  padding: 15px 0;\n  top: 0; left: 138px;\n  opacity: 1;\n  -webkit-transition: opacity 0.25s;\n     -moz-transition: opacity 0.25s;\n      -ms-transition: opacity 0.25s;\n       -o-transition: opacity 0.25s;\n          transition: opacity 0.25s;\n}\n\n.npm-scb-wrap:hover\n.npm-scb-now-playing {\n  opacity: 0;\n}\n\n.npm-scb-white\n.npm-scb-now-playing {\n  color: #fff;\n}\n.npm-scb-now-playing > a {\n  font-weight: bold;\n}\n\n.npm-scb-info > a > p {\n  margin: 0;\n  padding-bottom: 0.25em;\n  line-height: 1.35em;\n  margin-left: 1em;\n  font-size: 1em;\n}\n\n.npm-scb-title {\n  font-weight: bold;\n}\n\n.npm-scb-icon {\n  position: absolute;\n  top: 120px;\n  padding-top: 0.75em;\n  left: 16px;\n}\n"),
l=!0),d||(d=s.compile('<div class="npm-scb-wrap">\n  <div class="npm-scb-inner">\n    <a target="_blank" href="{{!urls.song}}">\n      <img class="npm-scb-icon" src="{{!icon}}">\n      <img class="npm-scb-artwork" src="{{!artwork}}">\n    </a>\n    <div class="npm-scb-info">\n      <a target="_blank" href="{{!urls.song}}">\n        <p class="npm-scb-title">{{!title}}</p>\n      </a>\n      <a target="_blank" href="{{!urls.artist}}">\n        <p class="npm-scb-artist">{{!artist}}</p>\n      </a>\n    </div>\n  </div>\n  <div class="npm-scb-now-playing">\n    Now Playing:\n    <a href="{{!urls.song}}">{{!title}}</a>\n    by\n    <a href="{{!urls.artist}}">{{!artist}}</a>\n  </div>\n</div>')),!f&&e.getFonts&&(a.add({"Open Sans":[300,600]}),f=!0),e=e||{},t=t||r;var n=e.el||document.createElement("div"),i="dark"in e&&!e.dark?"white":"black",p=e.client_id,h=e.song;return o(p,h,function(e,r){if(e)return t(e);if("track"!==r.kind)throw new Error("soundcloud-badge only supports individual tracks at the moment");n.classList["black"===i?"remove":"add"]("npm-scb-white"),n.innerHTML=d({artwork:r.artwork_url||r.user.avatar_url,artist:r.user.username,title:r.title,icon:c[i],urls:{song:r.permalink_url,artist:r.user.permalink_url}}),document.body.appendChild(n),t(null,r.stream_url+"?client_id="+p,r,n)}),n}var o=n(20),a=n(27),s=n(28),u=n(29),c=(n(30),{black:"https://developers.soundcloud.com/assets/logo_black.png",white:"https://developers.soundcloud.com/assets/logo_white.png"});e.exports=i;var l=!1,f=!1,d=null},function(e,t,n){function r(e,t,n){var r="https://api.soundcloud.com/resolve.json?"+i.stringify({url:t,client_id:e});o({uri:r,method:"GET"},function(t,r,i){if(t)return n(t);try{i=JSON.parse(i)}catch(e){return n(e)}if(i.errors)return n(new Error(i.errors[0].error_message));var o="track"===i.kind&&i.stream_url+"?client_id="+e;return n(null,i,o)})}var i=n(21),o=n(24);e.exports=r},function(e,t,n){"use strict";t.decode=t.parse=n(22),t.encode=t.stringify=n(23)},function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,i){t=t||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(t);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var u=e.length;s>0&&u>s&&(u=s);for(var c=0;c<u;++c){var l,f,d,p,h=e[c].replace(a,"%20"),v=h.indexOf(r);v>=0?(l=h.substr(0,v),f=h.substr(v+1)):(l=h,f=""),d=decodeURIComponent(l),p=decodeURIComponent(f),n(o,d)?Array.isArray(o[d])?o[d].push(p):o[d]=[o[d],p]:o[d]=p}return o}},function(e,t){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,i){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(i){var o=encodeURIComponent(n(i))+r;return Array.isArray(e[i])?e[i].map(function(e){return o+encodeURIComponent(n(e))}).join(t):o+encodeURIComponent(n(e[i]))}).join(t):i?encodeURIComponent(n(i))+r+encodeURIComponent(n(e)):""}},function(e,t,n){function r(e,t){function n(){4===l.readyState&&r()}function r(){var e=null,n=l.statusCode=l.status,r=l.body=l.response||l.responseText||l.responseXML;if(0===n||n>=400&&n<600){var i=l.responseText||s[String(l.status).charAt(0)];e=new Error(i),e.statusCode=l.status}if(v)try{r=l.body=JSON.parse(r)}catch(e){}t(e,l,r)}function o(e){t(e,l)}"string"==typeof e&&(e={uri:e}),e=e||{},t=a(t);var l;l=e.cors?new c:new u;var f=l.url=e.uri,d=l.method=e.method||"GET",p=e.body||e.data,h=l.headers=e.headers||{},v=!1;return"json"in e&&(v=!0,h["Content-Type"]="application/json",p=JSON.stringify(e.json)),l.onreadystatechange=n,l.onload=r,l.onerror=o,l.onprogress=function(){},l.ontimeout=i,l.open(d,f),e.cors&&(l.withCredentials=!0),l.timeout="timeout"in e?e.timeout:5e3,l.setRequestHeader&&Object.keys(h).forEach(function(e){l.setRequestHeader(e,h[e])}),l.send(p),l}function i(){}var o=n(25),a=n(26),s={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},u=o.XMLHttpRequest||i,c="withCredentials"in new u?o.XMLHttpRequest:o.XDomainRequest;e.exports=r},function(e,t){(function(t){"undefined"!=typeof window?e.exports=window:"undefined"!=typeof t?e.exports=t:e.exports={}}).call(t,function(){return this}())},function(e,t){function n(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}e.exports=n,n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0})})},function(e,t){function n(e){var t=i(e);return'<link href="'+t+'" rel="stylesheet" type="text/css">'}function r(e){var t=i(e),n=document.createElement("link");return n.setAttribute("href",t),n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n}function i(e){var t=Object.keys(e).map(function(t){var n=e[t];return t=t.replace(/\s+/,"+"),"boolean"==typeof n?t:t+":"+a(n).join(",")}).join("|");return"http://fonts.googleapis.com/css?family="+t}function o(e){var t=r(e);return document.head.appendChild(t),t}function a(e){return Array.isArray(e)?e:[e]}e.exports=n,e.exports.add=o},function(e,t){function n(e,t){t=t||{};var n=r(e);return n(t)}function r(e){for(var t,n=[],r=o(e),c=0;c<r.length;++c)if(t=r[c],c%2==0)n.push('"'+t.replace(/"/g,'\\"')+'"');else switch(t[0]){case"/":t=t.slice(1),n.push(") + ");break;case"^":t=t.slice(1),i(t),n.push(' + section(obj, "'+t+'", true, ');break;case"#":t=t.slice(1),i(t),n.push(' + section(obj, "'+t+'", false, ');break;case"!":t=t.slice(1),i(t),n.push(" + obj."+t+" + ");break;default:i(t),n.push(" + escape(obj."+t+") + ")}return n="\n"+a(u.toString())+";\n\n"+a(s.toString())+";\n\n  return "+n.join("").replace(/\n/g,"\\n"),new Function("obj",n)}function i(e){if(!e.match(/^[\w.]+$/))throw new Error('invalid property "'+e+'"')}function o(e){return e.split(/\{\{|\}\}/)}function a(e){return e.replace(/^/gm,"  ")}function s(e,t,n,r){var i=e[t];return"function"==typeof i?i.call(e,r):(n&&(i=!i),i?r:"")}function u(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}t=e.exports=n,t.compile=r},function(e,t){var n=[];e.exports=function(e){if(!(n.indexOf(e)>=0)){n.push(e);var t=document.createElement("style"),r=document.createTextNode(e);t.appendChild(r),document.head.childNodes.length?document.head.insertBefore(t,document.head.childNodes[0]):document.head.appendChild(t)}}},function(e,t){},function(e,t){function n(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var i=e.clientX||0,o=e.clientY||0,a=r(t);return n[0]=i-a.left,n[1]=o-a.top,n}function r(e){return e===window||e===document||e===document.body?i:e.getBoundingClientRect()}var i={left:0,top:0};e.exports=n},function(e,t,n){function r(e,t,n){var r=!0,s=!0;if("function"!=typeof e)throw new TypeError(a);return o(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),i(e,t,{leading:r,maxWait:t,trailing:s})}var i=n(33),o=n(34),a="Expected a function";e.exports=r},function(e,t,n){function r(e,t,n){function r(t){var n=y,r=_;return y=_=void 0,x=t,w=e.apply(r,n)}function l(e){return x=e,E=setTimeout(p,t),T?r(e):w}function f(e){var n=e-A,r=e-x,i=t-n;return S?c(i,b-r):i}function d(e){var n=e-A,r=e-x;return void 0===A||n>=t||n<0||S&&r>=b}function p(){var e=o();return d(e)?h(e):void(E=setTimeout(p,f(e)))}function h(e){return E=void 0,M&&y?r(e):(y=_=void 0,w)}function v(){void 0!==E&&clearTimeout(E),x=0,y=A=_=E=void 0}function m(){return void 0===E?w:h(o())}function g(){var e=o(),n=d(e);if(y=arguments,_=this,A=e,n){if(void 0===E)return l(A);if(S)return E=setTimeout(p,t),r(A)}return void 0===E&&(E=setTimeout(p,t)),w}var y,_,b,w,E,A,x=0,T=!1,S=!1,M=!0;if("function"!=typeof e)throw new TypeError(s);return t=a(t)||0,i(n)&&(T=!!n.leading,S="maxWait"in n,b=S?u(a(n.maxWait)||0,t):b,M="trailing"in n?!!n.trailing:M),g.cancel=v,g.flush=m,g}var i=n(34),o=n(35),a=n(38),s="Expected a function",u=Math.max,c=Math.min;e.exports=r},function(e,t){function n(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}e.exports=n},function(e,t,n){var r=n(36),i=function(){return r.Date.now()};e.exports=i},function(e,t,n){var r=n(37),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(t,function(){return this}())},function(e,t,n){function r(e){if("number"==typeof e)return e;if(o(e))return a;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=c.test(e);return n||l.test(e)?f(e.slice(2),n?2:8):u.test(e)?a:+e}var i=n(34),o=n(39),a=NaN,s=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt;e.exports=r},function(e,t,n){function r(e){return"symbol"==typeof e||o(e)&&i(e)==a}var i=n(40),o=n(44),a="[object Symbol]";e.exports=r},function(e,t,n){function r(e){return null==e?void 0===e?u:s:(e=Object(e),c&&c in e?o(e):a(e))}var i=n(41),o=n(42),a=n(43),s="[object Null]",u="[object Undefined]",c=i?i.toStringTag:void 0;e.exports=r},function(e,t,n){var r=n(36),i=r.Symbol;e.exports=i},function(e,t,n){function r(e){var t=a.call(e,u),n=e[u];try{e[u]=void 0;var r=!0}catch(e){}var i=s.call(e);return r&&(t?e[u]=n:delete e[u]),i}var i=n(41),o=Object.prototype,a=o.hasOwnProperty,s=o.toString,u=i?i.toStringTag:void 0;e.exports=r},function(e,t){function n(e){return i.call(e)}var r=Object.prototype,i=r.toString;e.exports=n},function(e,t){function n(e){return null!=e&&"object"==typeof e}e.exports=n},function(e,t,n){function r(e,t,n){o(typeof e===t,"range-fit expects typeof("+n+") to be "+t)}function i(e,t){r(e,"number",t)}var o=n(46);e.exports=function(e,t,n,r,a){i(e,"value"),i(t,"lowerInitial"),i(n,"upperInitial"),i(r,"lowerNew"),i(a,"upperNew");var s=n-t;if(0===s)return r;o(t<=e,"range-fit expects lowerInitial<=value"),o(n>=e,"range-fit expects upperInitial>=value");var u=a-r;return(e-t)*u/s+r}},function(e,t,n){(function(t){"use strict";/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
function r(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function i(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}function o(e){return Object.prototype.toString.call(e)}function a(e){return!i(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}function s(e){if(b.isFunction(e)){if(A)return e.name;var t=e.toString(),n=t.match(T);return n&&n[1]}}function u(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function c(e){if(A||!b.isFunction(e))return b.inspect(e);var t=s(e),n=t?": "+t:"";return"[Function"+n+"]"}function l(e){return u(c(e.actual),128)+" "+e.operator+" "+u(c(e.expected),128)}function f(e,t,n,r,i){throw new x.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function d(e,t){e||f(e,!0,t,"==",x.ok)}function p(e,t,n,s){if(e===t)return!0;if(i(e)&&i(t))return 0===r(e,t);if(b.isDate(e)&&b.isDate(t))return e.getTime()===t.getTime();if(b.isRegExp(e)&&b.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(a(e)&&a(t)&&o(e)===o(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;s=s||{actual:[],expected:[]};var u=s.actual.indexOf(e);return u!==-1&&u===s.expected.indexOf(t)||(s.actual.push(e),s.expected.push(t),v(e,t,n,s))}return n?e===t:e==t}function h(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function v(e,t,n,r){if(null===e||void 0===e||null===t||void 0===t)return!1;if(b.isPrimitive(e)||b.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=h(e),o=h(t);if(i&&!o||!i&&o)return!1;if(i)return e=E.call(e),t=E.call(t),p(e,t,n);var a,s,u=S(e),c=S(t);if(u.length!==c.length)return!1;for(u.sort(),c.sort(),s=u.length-1;s>=0;s--)if(u[s]!==c[s])return!1;for(s=u.length-1;s>=0;s--)if(a=u[s],!p(e[a],t[a],n,r))return!1;return!0}function m(e,t,n){p(e,t,!0)&&f(e,t,n,"notDeepStrictEqual",m)}function g(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&t.call({},e)===!0}function y(e){var t;try{e()}catch(e){t=e}return t}function _(e,t,n,r){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=y(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&f(i,n,"Missing expected exception"+r);var o="string"==typeof r,a=!e&&b.isError(i),s=!e&&i&&!n;if((a&&o&&g(i,n)||s)&&f(i,n,"Got unwanted exception"+r),e&&i&&n&&!g(i,n)||!e&&i)throw i}var b=n(47),w=Object.prototype.hasOwnProperty,E=Array.prototype.slice,A=function(){return"foo"===function(){}.name}(),x=e.exports=d,T=/\s*function\s+([^\(\s]*)\s*/;x.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=l(this),this.generatedMessage=!0);var t=e.stackStartFunction||f;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=s(t),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},b.inherits(x.AssertionError,Error),x.fail=f,x.ok=d,x.equal=function(e,t,n){e!=t&&f(e,t,n,"==",x.equal)},x.notEqual=function(e,t,n){e==t&&f(e,t,n,"!=",x.notEqual)},x.deepEqual=function(e,t,n){p(e,t,!1)||f(e,t,n,"deepEqual",x.deepEqual)},x.deepStrictEqual=function(e,t,n){p(e,t,!0)||f(e,t,n,"deepStrictEqual",x.deepStrictEqual)},x.notDeepEqual=function(e,t,n){p(e,t,!1)&&f(e,t,n,"notDeepEqual",x.notDeepEqual)},x.notDeepStrictEqual=m,x.strictEqual=function(e,t,n){e!==t&&f(e,t,n,"===",x.strictEqual)},x.notStrictEqual=function(e,t,n){e===t&&f(e,t,n,"!==",x.notStrictEqual)},x.throws=function(e,t,n){_(!0,e,t,n)},x.doesNotThrow=function(e,t,n){_(!1,e,t,n)},x.ifError=function(e){if(e)throw e};var S=Object.keys||function(e){var t=[];for(var n in e)w.call(e,n)&&t.push(n);return t}}).call(t,function(){return this}())},function(e,t,n){(function(e,r){function i(e,n){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&t._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),u(r,e,r.depth)}function o(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function a(e,t){return e}function s(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function u(e,n,r){if(e.customInspect&&n&&S(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return _(i)||(i=u(e,i,r)),i}var o=c(e,n);if(o)return o;var a=Object.keys(n),v=s(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),T(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(n);if(0===a.length){if(S(n)){var m=n.name?": "+n.name:"";return e.stylize("[Function"+m+"]","special")}if(E(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(x(n))return e.stylize(Date.prototype.toString.call(n),"date");if(T(n))return l(n)}var g="",y=!1,b=["{","}"];if(h(n)&&(y=!0,b=["[","]"]),S(n)){var w=n.name?": "+n.name:"";g=" [Function"+w+"]"}if(E(n)&&(g=" "+RegExp.prototype.toString.call(n)),x(n)&&(g=" "+Date.prototype.toUTCString.call(n)),T(n)&&(g=" "+l(n)),0===a.length&&(!y||0==n.length))return b[0]+g+b[1];if(r<0)return E(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n);var A;return A=y?f(e,n,r,v,a):a.map(function(t){return d(e,n,r,v,t,y)}),e.seen.pop(),p(A,g,b)}function c(e,t){if(w(t))return e.stylize("undefined","undefined");if(_(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return y(t)?e.stylize(""+t,"number"):v(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)k(t,String(a))?o.push(d(e,t,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(d(e,t,n,r,i,!0))}),o}function d(e,t,n,r,i,o){var a,s,c;if(c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},c.get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),k(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(c.value)<0?(s=m(n)?u(e,c.value,null):u(e,c.value,n-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n"))):s=e.stylize("[Circular]","special")),w(a)){if(o&&i.match(/^\d+$/))return s;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e,t,n){var r=0,i=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function h(e){return Array.isArray(e)}function v(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return null==e}function y(e){return"number"==typeof e}function _(e){return"string"==typeof e}function b(e){return"symbol"==typeof e}function w(e){return void 0===e}function E(e){return A(e)&&"[object RegExp]"===R(e)}function A(e){return"object"==typeof e&&null!==e}function x(e){return A(e)&&"[object Date]"===R(e)}function T(e){return A(e)&&("[object Error]"===R(e)||e instanceof Error)}function S(e){return"function"==typeof e}function M(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function R(e){return Object.prototype.toString.call(e)}function C(e){return e<10?"0"+e.toString(10):e.toString(10)}function O(){var e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(":");return[e.getDate(),D[e.getMonth()],t].join(" ")}function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var P=/%[sdj%]/g;t.format=function(e){if(!_(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,o=r.length,a=String(e).replace(P,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),s=r[n];n<o;s=r[++n])a+=m(s)||!A(s)?" "+s:" "+i(s);return a},t.deprecate=function(n,i){function o(){if(!a){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),a=!0}return n.apply(this,arguments)}if(w(e.process))return function(){return t.deprecate(n,i).apply(this,arguments)};if(r.noDeprecation===!0)return n;var a=!1;return o};var F,I={};t.debuglog=function(e){if(w(F)&&(F=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!I[e])if(new RegExp("\\b"+e+"\\b","i").test(F)){var n=r.pid;I[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else I[e]=function(){};return I[e]},t.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=v,t.isNull=m,t.isNullOrUndefined=g,t.isNumber=y,t.isString=_,t.isSymbol=b,t.isUndefined=w,t.isRegExp=E,t.isObject=A,t.isDate=x,t.isError=T,t.isFunction=S,t.isPrimitive=M,t.isBuffer=n(49);var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",O(),t.format.apply(t,arguments))},t.inherits=n(50),t._extend=function(e,t){if(!t||!A(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(t,function(){return this}(),n(48))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){v&&p&&(v=!1,p.length?h=p.concat(h):m=-1,h.length&&s())}function s(){if(!v){var e=i(a);v=!0;for(var t=h.length;t;){for(p=h,h=[];++m<t;)p&&p[m].run();m=-1,t=h.length}p=null,v=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var l,f,d=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var p,h=[],v=!1,m=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new u(e,t)),1!==h.length||v||i(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r=n(52),i={};i.create=function(){var e=new r.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},i.clone=function(e){var t=new r.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.fromValues=function(e,t,n,i,o,a,s,u,c){var l=new r.ARRAY_TYPE(9);return l[0]=e,l[1]=t,l[2]=n,l[3]=i,l[4]=o,l[5]=a,l[6]=s,l[7]=u,l[8]=c,l},i.set=function(e,t,n,r,i,o,a,s,u,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e},i.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},i.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=l*a-s*c,d=-l*o+s*u,p=c*o-a*u,h=n*f+r*d+i*p;return h?(h=1/h,e[0]=f*h,e[1]=(-l*r+i*c)*h,e[2]=(s*r-i*a)*h,e[3]=d*h,e[4]=(l*n-i*u)*h,e[5]=(-s*n+i*o)*h,e[6]=p*h,e[7]=(-c*n+r*u)*h,e[8]=(a*n-r*o)*h,e):null},i.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8];return e[0]=a*l-s*c,e[1]=i*c-r*l,e[2]=r*s-i*a,e[3]=s*u-o*l,e[4]=n*l-i*u,e[5]=i*o-n*s,e[6]=o*c-a*u,e[7]=r*u-n*c,e[8]=n*a-r*o,e},i.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8];return t*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s)},i.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],d=n[0],p=n[1],h=n[2],v=n[3],m=n[4],g=n[5],y=n[6],_=n[7],b=n[8];return e[0]=d*r+p*a+h*c,e[1]=d*i+p*s+h*l,e[2]=d*o+p*u+h*f,e[3]=v*r+m*a+g*c,e[4]=v*i+m*s+g*l,e[5]=v*o+m*u+g*f,e[6]=y*r+_*a+b*c,e[7]=y*i+_*s+b*l,e[8]=y*o+_*u+b*f,e},i.mul=i.multiply,i.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],d=n[0],p=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=d*r+p*a+c,e[7]=d*i+p*s+l,e[8]=d*o+p*u+f,e},i.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],d=Math.sin(n),p=Math.cos(n);return e[0]=p*r+d*a,e[1]=p*i+d*s,e[2]=p*o+d*u,e[3]=p*a-d*r,e[4]=p*s-d*i,e[5]=p*u-d*o,e[6]=c,e[7]=l,e[8]=f,e},i.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},i.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},i.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,d=i*a,p=i*s,h=i*u,v=o*a,m=o*s,g=o*u;return e[0]=1-f-h,e[3]=l-g,e[6]=d+m,e[1]=l+g,e[4]=1-c-h,e[7]=p-v,e[2]=d-m,e[5]=p+v,e[8]=1-c-f,e},i.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],d=t[10],p=t[11],h=t[12],v=t[13],m=t[14],g=t[15],y=n*s-r*a,_=n*u-i*a,b=n*c-o*a,w=r*u-i*s,E=r*c-o*s,A=i*c-o*u,x=l*v-f*h,T=l*m-d*h,S=l*g-p*h,M=f*m-d*v,R=f*g-p*v,C=d*g-p*m,O=y*C-_*R+b*M+w*S-E*T+A*x;return O?(O=1/O,e[0]=(s*C-u*R+c*M)*O,e[1]=(u*S-a*C-c*T)*O,e[2]=(a*R-s*S+c*x)*O,e[3]=(i*R-r*C-o*M)*O,e[4]=(n*C-i*S+o*T)*O,e[5]=(r*S-n*R-o*x)*O,e[6]=(v*A-m*E+g*w)*O,e[7]=(m*b-h*A-g*_)*O,e[8]=(h*E-v*b+g*y)*O,e):null},i.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},i.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e},i.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e},i.sub=i.subtract,i.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e},i.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e},i.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},i.equals=function(e,t){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],d=t[0],p=t[1],h=t[2],v=t[3],m=t[4],g=t[5],y=e[6],_=t[7],b=t[8];return Math.abs(n-d)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(i-p)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-h)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(a-v)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-m)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-g)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-y)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(l-_)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(f-b)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))},e.exports=i},function(e,t){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(e){n.ARRAY_TYPE=e};var r=Math.PI/180;n.toRadian=function(e){return e*r},n.equals=function(e,t){return Math.abs(e-t)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))},e.exports=n},function(e,t,n){var r=n(52),i={};i.create=function(){var e=new r.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},i.clone=function(e){var t=new r.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},i.fromValues=function(e,t){var n=new r.ARRAY_TYPE(2);return n[0]=e,n[1]=t,n},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},i.set=function(e,t,n){return e[0]=t,e[1]=n,e},i.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},i.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},i.sub=i.subtract,i.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},i.mul=i.multiply,i.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},i.div=i.divide,i.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},i.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},i.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},i.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},i.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},i.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},i.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},i.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},i.dist=i.distance,i.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r},i.sqrDist=i.squaredDistance,i.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},i.len=i.length,i.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},i.sqrLen=i.squaredLength,i.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},i.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},i.normalize=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},i.cross=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e},i.lerp=function(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e},i.random=function(e,t){t=t||1;var n=2*r.RANDOM()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},i.transformMat2=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e},i.transformMat2d=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e},i.transformMat3=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e},i.transformMat4=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e},i.forEach=function(){var e=i.create();return function(t,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}(),i.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},i.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},i.equals=function(e,t){var n=e[0],i=e[1],o=t[0],a=t[1];return Math.abs(n-o)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))},e.exports=i},function(e,t,n){"use strict";function r(e,t){for(var n="",r=0;r<e;r++)n+=t;return n}function i(){return"function() {}"}function o(e,t){return l(t)}function a(e){return void 0===e&&(e="\t"),function(t,n){var i=l(n),o=i.split("\n"),a=o[o.length-1],s=a.match("^("+e+")*")[0].length;if(s===t)return i;var u,c=o.slice(1);if(s<t){var f=t-s;u=c.map(function(t){return r(f,e)})}else{var d=s-t;u=c.map(function(e){return e.substring(d)})}return o[0]+"\n"+u.join("\n")}}function s(e,t,n,i,o,a,s){var u=Object.keys(e).map(function(i){var u=c(e[i],t+1,n-1,!0,o,a,s),l=n>0?"'"+i+"'":i,f=r(t+1,o)+l+": ";return f+u}),l=u.join(",\n");return i?"{\n"+l+"\n"+r(t,o)+"}":l}function u(e,t,n,i,o,a,s){var u=e.map(function(e){var i=c(e,t+1,n-1,!0,o,a,s);return r(t+1,o)+i}).join(",\n");return i?"[\n"+u+"\n"+r(t,o)+"]":u}function c(e,t,n,r,i,o,a){switch(typeof e){case"function":return a(t,e);case"number":case"undefined":case"boolean":return""+e;case"string":return o+e+o;case"object":;return Array.isArray(e)?u.apply(null,arguments):null===e?"null":e instanceof Date?"new Date("+e.getTime()+")":e instanceof RegExp?e.toString():s.apply(null,arguments)}}var l=n(55);e.exports=function(t,n){n=n||{};var r=[["tabDepth",0],["quoteDepth",0],["enclose",!0],["tabChar","\t"],["quoteChar","'"],["functionFormatter",e.exports.defaultFnFormatter]].map(function(e){return void 0===n[e[0]]?e[1]:n[e[0]]});return c.apply(null,[t].concat(r))},e.exports.defaultFnFormatter=i,e.exports.mkFnFormatter=a,e.exports.simpleFnFormatter=o},function(e,t){function n(e){var t=e.split(".");return t.reduce(function(e,t){return void 0===e?e:e[t]},c)}function r(){return s.map(function(e){return{name:e,value:n(e)}})}function i(e){for(var t=0;t<u.length;t++){var n=u[t];if(n.value===e)return n.name}}function o(e){var t=e.toString();if(a(e)){null===u&&(u=r());var n=i(e);if(!n)throw new Error("Serialization for native function not supported.");return n}return t}function a(e){return/function [A-z_]+\(\) { \[native code\] }/.test(e)}var s=["String.fromCharCode","String.fromCodePoint","String.prototype.anchor","String.prototype.charAt","String.prototype.charCodeAt","String.prototype.codePointAt","String.prototype.concat","String.prototype.endsWith","String.prototype.includes","String.prototype.indexOf","String.prototype.lastIndexOf","String.prototype.link","String.prototype.localeCompare","String.prototype.match","String.prototype.normalize","String.prototype.repeat","String.prototype.replace","String.prototype.search","String.prototype.slice","String.prototype.split","String.prototype.startsWith","String.prototype.substr","String.prototype.substring","String.prototype.toLocaleLowerCase","String.prototype.toLocaleUpperCase","String.prototype.toLowerCase","String.prototype.toString","String.prototype.toUpperCase","String.prototype.trim","String.prototype.trimLeft","String.prototype.trimRight","String.prototype.valueOf","String.raw","RegExp.prototype.exec","RegExp.prototype.test","RegExp.prototype.toSource","RegExp.prototype.toString","Date.now","Date.UTC","Date.parse","Date.prototype.getDate","Date.prototype.getDay","Date.prototype.getFullYear","Date.prototype.getHours","Date.prototype.getMilliseconds","Date.prototype.getMinutes","Date.prototype.getMonth","Date.prototype.getSeconds","Date.prototype.getTime","Date.prototype.getTimezoneOffset","Date.prototype.getUTCDate","Date.prototype.getUTCDay","Date.prototype.getUTCFullYear","Date.prototype.getUTCHours","Date.prototype.getUTCMilliseconds","Date.prototype.getUTCMinutes","Date.prototype.getUTCMonth","Date.prototype.getUTCSeconds","Date.prototype.getYear","Date.prototype.setDate","Date.prototype.setFullYear","Date.prototype.setHours","Date.prototype.setMilliseconds","Date.prototype.setMinutes","Date.prototype.setMonth","Date.prototype.setSeconds","Date.prototype.setTime","Date.prototype.setUTCDate","Date.prototype.setUTCFullYear","Date.prototype.setUTCHours","Date.prototype.setUTCMilliseconds","Date.prototype.setUTCMinutes","Date.prototype.setUTCMonth","Date.prototype.setUTCSeconds","Date.prototype.setYear","Date.prototype.toDateString","Date.prototype.toGMTString","Date.prototype.toISOString","Date.prototype.toJSON","Date.prototype.toLocaleDateString","Date.prototype.toLocaleFormat","Date.prototype.toLocaleString","Date.prototype.toLocaleTimeString","Date.prototype.toSource","Date.prototype.toString","Date.prototype.toTimeString","Date.prototype.toUTCString","Date.prototype.valueOf","Object.assign","Object.create","Object.defineProperties","Object.defineProperty","Object.freeze","Object.getOwnPropertyDescriptor","Object.getOwnPropertyNames","Object.getOwnPropertySymbols","Object.getPrototypeOf","Object.is","Object.isExtensible","Object.isFrozen","Object.isSealed","Object.keys","Object.preventExtensions","Object.prototype.hasOwnProperty","Object.prototype.isPrototypeOf","Object.prototype.propertyIsEnumerable","Object.prototype.toLocaleString","Object.prototype.toSource","Object.prototype.toString","Object.prototype.unwatch","Object.prototype.valueOf","Object.prototype.watch","Object.seal","Object.setPrototypeOf","Array.from","Array.isArray","Array.of","Array.prototype.concat","Array.prototype.copyWithin","Array.prototype.entries","Array.prototype.every","Array.prototype.fill","Array.prototype.filter","Array.prototype.find","Array.prototype.findIndex","Array.prototype.forEach","Array.prototype.includes","Array.prototype.indexOf","Array.prototype.join","Array.prototype.keys","Array.prototype.lastIndexOf","Array.prototype.map","Array.prototype.pop","Array.prototype.push","Array.prototype.reduce","Array.prototype.reduceRight","Array.prototype.reverse","Array.prototype.shift","Array.prototype.slice","Array.prototype.some","Array.prototype.sort","Array.prototype.splice","Array.prototype.toLocaleString","Array.prototype.toSource","Array.prototype.toString","Array.prototype.unshift","Array.prototype.values","Function.prototype.apply","Function.prototype.bind","Function.prototype.call","Function.prototype.isGenerator","Function.prototype.toSource","Function.prototype.toString","JSON.parse","JSON.stringify","Number.isNaN","Number.isFinite","Number.isInteger","Number.isSafeInteger","Number.parseFloat","Number.parseInt","Math.abs","Math.acos","Math.acosh","Math.asin","Math.asinh","Math.atan","Math.atan2","Math.atanh","Math.cbrt","Math.ceil","Math.clz32","Math.cos","Math.cosh","Math.exp","Math.expm1","Math.floor","Math.fround","Math.hypot","Math.imul","Math.log","Math.log10","Math.log1p","Math.log2","Math.max","Math.min","Math.pow","Math.random","Math.round","Math.sign","Math.sin","Math.sinh","Math.sqrt","Math.tan","Math.tanh","Math.trunc","isNaN","isFinite","eval","parseFloat","parseInt","uneval"],u=null,c=function(){return this}();e.exports=o,e.exports.isNativeFn=a},function(e,t,n){"use strict";function r(e){this.gl=e,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function i(e,t){return e.name<t.name?-1:1}function o(e,t,n,i,o){var a=new r(e);return a.update(t,n,i,o),a}var a=n(57),s=n(60),u=n(58),c=n(61),l=n(81),f=n(59),d=r.prototype;d.bind=function(){this.program||this._relink();var e,t=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),n=this.gl.lastAttribCount;if(t>n)for(e=n;e<t;e++)this.gl.enableVertexAttribArray(e);else if(n>t)for(e=t;e<n;e++)this.gl.disableVertexAttribArray(e);this.gl.lastAttribCount=t,this.gl.useProgram(this.program)},d.dispose=function(){for(var e=this.gl.lastAttribCount,t=0;t<e;t++)this.gl.disableVertexAttribArray(t);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},d.update=function(e,t,n,r){function o(){p.program=c.program(h,p._vref,p._fref,w,E);for(var e=0;e<n.length;++e)R[e]=h.getUniformLocation(p.program,n[e].name)}if(!t||1===arguments.length){var d=e;e=d.vertex,t=d.fragment,n=d.uniforms,r=d.attributes}var p=this,h=p.gl,v=p._vref;p._vref=c.shader(h,h.VERTEX_SHADER,e),v&&v.dispose(),p.vertShader=p._vref.shader;var m=this._fref;if(p._fref=c.shader(h,h.FRAGMENT_SHADER,t),m&&m.dispose(),p.fragShader=p._fref.shader,!n||!r){var g=h.createProgram();if(h.attachShader(g,p.fragShader),h.attachShader(g,p.vertShader),h.linkProgram(g),!h.getProgramParameter(g,h.LINK_STATUS)){var y=h.getProgramInfoLog(g);throw new f(y,"Error linking program:"+y)}n=n||l.uniforms(h,g),r=r||l.attributes(h,g),h.deleteProgram(g)}r=r.slice(),r.sort(i);var _,b=[],w=[],E=[];for(_=0;_<r.length;++_){var A=r[_];if(A.type.indexOf("mat")>=0){for(var x=0|A.type.charAt(A.type.length-1),T=new Array(x),S=0;S<x;++S)T[S]=E.length,w.push(A.name+"["+S+"]"),"number"==typeof A.location?E.push(A.location+S):Array.isArray(A.location)&&A.location.length===x&&"number"==typeof A.location[S]?E.push(0|A.location[S]):E.push(-1);b.push({name:A.name,type:A.type,locations:T})}else b.push({name:A.name,type:A.type,locations:[E.length]}),w.push(A.name),"number"==typeof A.location?E.push(0|A.location):E.push(-1)}var M=0;for(_=0;_<E.length;++_)if(E[_]<0){for(;E.indexOf(M)>=0;)M+=1;E[_]=M}var R=new Array(n.length);o(),p._relink=o,p.types={uniforms:u(n),attributes:u(r)},p.attributes=s(h,p,b,E),Object.defineProperty(p,"uniforms",a(h,p,n,R))},e.exports=o},function(e,t,n){"use strict";function r(e){var t=new Function("y","return function(){return y}");return t(e)}function i(e,t){for(var n=new Array(e),r=0;r<e;++r)n[r]=t;return n}function o(e,t,n,o){function u(n){var r=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+n+"])}");return r(e,t,o)}function c(e,t,n){switch(n){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+e+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+e+")";default:var r=n.indexOf("vec");if(!(0<=r&&r<=1&&n.length===4+r)){if(0===n.indexOf("mat")&&4===n.length){var i=n.charCodeAt(n.length-1)-48;if(i<2||i>4)throw new s("","Invalid uniform dimension type for matrix "+name+": "+n);return"gl.uniformMatrix"+i+"fv(locations["+t+"],false,obj"+e+")";
}throw new s("","Unknown uniform data type for "+name+": "+n)}var i=n.charCodeAt(n.length-1)-48;if(i<2||i>4)throw new s("","Invalid data type");switch(n.charAt(0)){case"b":case"i":return"gl.uniform"+i+"iv(locations["+t+"],obj"+e+")";case"v":return"gl.uniform"+i+"fv(locations["+t+"],obj"+e+")";default:throw new s("","Unrecognized data type for vector "+name+": "+n)}}}function l(e,t){if("object"!=typeof t)return[[e,t]];var n=[];for(var r in t){var i=t[r],o=e;o+=parseInt(r)+""===r?"["+r+"]":"."+r,"object"==typeof i?n.push.apply(n,l(o,i)):n.push([o,i])}return n}function f(t){for(var r=["return function updateProperty(obj){"],i=l("",t),a=0;a<i.length;++a){var s=i[a],u=s[0],f=s[1];o[f]&&r.push(c(u,f,n[f].type))}r.push("return obj}");var d=new Function("gl","locations",r.join("\n"));return d(e,o)}function d(e){switch(e){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(0<=t&&t<=1&&e.length===4+t){var n=e.charCodeAt(e.length-1)-48;if(n<2||n>4)throw new s("","Invalid data type");return"b"===e.charAt(0)?i(n,!1):i(n,0)}if(0===e.indexOf("mat")&&4===e.length){var n=e.charCodeAt(e.length-1)-48;if(n<2||n>4)throw new s("","Invalid uniform dimension type for matrix "+name+": "+e);return i(n*n,0)}throw new s("","Unknown uniform data type for "+name+": "+e)}}function p(e,t,i){if("object"==typeof i){var a=h(i);Object.defineProperty(e,t,{get:r(a),set:f(i),enumerable:!0,configurable:!1})}else o[i]?Object.defineProperty(e,t,{get:u(i),set:f(i),enumerable:!0,configurable:!1}):e[t]=d(n[i].type)}function h(e){var t;if(Array.isArray(e)){t=new Array(e.length);for(var n=0;n<e.length;++n)p(t,n,e[n])}else{t={};for(var r in e)p(t,r,e[r])}return t}var v=a(n,!0);return{get:r(h(v)),set:f(v),enumerable:!0,configurable:!0}}var a=n(58),s=n(59);e.exports=o},function(e,t){"use strict";function n(e,t){for(var n={},r=0;r<e.length;++r)for(var i=e[r].name,o=i.split("."),a=n,s=0;s<o.length;++s){var u=o[s].split("[");if(u.length>1){u[0]in a||(a[u[0]]=[]),a=a[u[0]];for(var c=1;c<u.length;++c){var l=parseInt(u[c]);c<u.length-1||s<o.length-1?(l in a||(c<u.length-1?a[l]=[]:a[l]={}),a=a[l]):t?a[l]=r:a[l]=e[r].type}}else s<o.length-1?(u[0]in a||(a[u[0]]={}),a=a[u[0]]):t?a[u[0]]=r:a[u[0]]=e[r].type}return n}e.exports=n},function(e,t){function n(e,t,n){this.shortMessage=t||"",this.longMessage=n||"",this.rawError=e||"",this.message="gl-shader: "+(t||e||"")+(n?"\n"+n:""),this.stack=(new Error).stack}n.prototype=new Error,n.prototype.name="GLError",n.prototype.constructor=n,e.exports=n},function(e,t,n){"use strict";function r(e,t,n,r,i,o){this._gl=e,this._wrapper=t,this._index=n,this._locations=r,this._dimension=i,this._constFunc=o}function i(e,t,n,i,o,a,s){for(var u=["gl","v"],c=[],l=0;l<o;++l)u.push("x"+l),c.push("x"+l);u.push("if(x0.length===void 0){return gl.vertexAttrib"+o+"f(v,"+c.join()+")}else{return gl.vertexAttrib"+o+"fv(v,x0)}");var f=Function.apply(null,u),d=new r(e,t,n,i,o,f);Object.defineProperty(a,s,{set:function(t){return e.disableVertexAttribArray(i[n]),f(e,i[n],t),t},get:function(){return d},enumerable:!0})}function o(e,t,n,r,o,a,s){for(var u=new Array(o),c=new Array(o),l=0;l<o;++l)i(e,t,n[l],r,o,u,l),c[l]=u[l];Object.defineProperty(u,"location",{set:function(e){if(Array.isArray(e))for(var t=0;t<o;++t)c[t].location=e[t];else for(var t=0;t<o;++t)c[t].location=e+t;return e},get:function(){for(var e=new Array(o),t=0;t<o;++t)e[t]=r[n[t]];return e},enumerable:!0}),u.pointer=function(t,i,a,s){t=t||e.FLOAT,i=!!i,a=a||o*o,s=s||0;for(var u=0;u<o;++u){var c=r[n[u]];e.vertexAttribPointer(c,o,t,i,a,s+u*o),e.enableVertexAttribArray(c)}};var f=new Array(o),d=e["vertexAttrib"+o+"fv"];Object.defineProperty(a,s,{set:function(t){for(var i=0;i<o;++i){var a=r[n[i]];if(e.disableVertexAttribArray(a),Array.isArray(t[0]))d.call(e,a,t[i]);else{for(var s=0;s<o;++s)f[s]=t[o*i+s];d.call(e,a,f)}}return t},get:function(){return u},enumerable:!0})}function a(e,t,n,r){for(var a={},u=0,c=n.length;u<c;++u){var l=n[u],f=l.name,d=l.type,p=l.locations;switch(d){case"bool":case"int":case"float":i(e,t,p[0],r,1,a,f);break;default:if(d.indexOf("vec")>=0){var h=d.charCodeAt(d.length-1)-48;if(h<2||h>4)throw new s("","Invalid data type for attribute "+f+": "+d);i(e,t,p[0],r,h,a,f)}else{if(!(d.indexOf("mat")>=0))throw new s("","Unknown data type for attribute "+f+": "+d);var h=d.charCodeAt(d.length-1)-48;if(h<2||h>4)throw new s("","Invalid data type for attribute "+f+": "+d);o(e,t,p,r,h,a,f)}}}return a}e.exports=a;var s=n(59),u=r.prototype;u.pointer=function(e,t,n,r){var i=this,o=i._gl,a=i._locations[i._index];o.vertexAttribPointer(a,i._dimension,e||o.FLOAT,!!t,n||0,r||0),o.enableVertexAttribArray(a)},u.set=function(e,t,n,r){return this._constFunc(this._locations[this._index],e,t,n,r)},Object.defineProperty(u,"location",{get:function(){return this._locations[this._index]},set:function(e){return e!==this._locations[this._index]&&(this._locations[this._index]=0|e,this._wrapper.program=null),0|e}})},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){this.id=e,this.src=t,this.type=n,this.shader=r,this.count=o,this.programs=[],this.cache=a}function i(e){this.gl=e,this.shaders=[{},{}],this.programs={}}function o(e,t,n){var r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(r);try{var o=f(i,n,t)}catch(e){throw console.warn("Failed to format compiler error: "+e),new l(i,"Error compiling shader:\n"+i)}throw new l(i,o.short,o.long)}return r}function a(e,t,n,r,i){var o=e.createProgram();e.attachShader(o,t),e.attachShader(o,n);for(var a=0;a<r.length;++a)e.bindAttribLocation(o,i[a],r[a]);if(e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS)){var s=e.getProgramInfoLog(o);throw new l(s,"Error linking program: "+s)}return o}function s(e){var t=p.get(e);return t||(t=new i(e),p.set(e,t)),t}function u(e,t,n){return s(e).getShaderReference(t,n)}function c(e,t,n,r,i){return s(e).getProgram(t,n,r,i)}t.shader=u,t.program=c;var l=n(59),f=n(62),d="undefined"==typeof WeakMap?n(78):WeakMap,p=new d,h=0;r.prototype.dispose=function(){if(0===--this.count){for(var e=this.cache,t=e.gl,n=this.programs,r=0,i=n.length;r<i;++r){var o=e.programs[n[r]];o&&(delete e.programs[r],t.deleteProgram(o))}t.deleteShader(this.shader),delete e.shaders[this.type===t.FRAGMENT_SHADER|0][this.src]}};var v=i.prototype;v.getShaderReference=function(e,t){var n=this.gl,i=this.shaders[e===n.FRAGMENT_SHADER|0],a=i[t];if(a&&n.isShader(a.shader))a.count+=1;else{var s=o(n,e,t);a=i[t]=new r(h++,t,e,s,[],1,this)}return a},v.getProgram=function(e,t,n,r){var i=[e.id,t.id,n.join(":"),r.join(":")].join("@"),o=this.programs[i];return o&&this.gl.isProgram(o)||(this.programs[i]=o=a(this.gl,e.shader,t.shader,n,r),e.programs.push(i),t.programs.push(i)),o}},function(e,t,n){function r(e,t,n){"use strict";var r=a(t)||"of unknown name (see npm glsl-shader-name)",u="unknown type";void 0!==n&&(u=n===o.FRAGMENT_SHADER?"fragment":"vertex");for(var c=i("Error compiling %s shader %s:\n",u,r),l=i("%s%s",c,e),f=e.split("\n"),d={},p=0;p<f.length;p++){var h=f[p];if(""!==h){var v=parseInt(h.split(":")[2]);if(isNaN(v))throw new Error(i("Could not parse error: %s",h));d[v]=h}}for(var m=s(t).split("\n"),p=0;p<m.length;p++)if(d[p+3]||d[p+2]||d[p+1]){var g=m[p];if(c+=g+"\n",d[p+1]){var y=d[p+1];y=y.substr(y.split(":",3).join(":").length+1).trim(),c+=i("^^^ %s\n\n",y)}}return{long:c.trim(),short:l.trim()}}var i=n(63).sprintf,o=n(64),a=n(66),s=n(75);e.exports=r},function(e,t,n){!function(e){function n(){var e=arguments[0],t=n.cache;return t[e]&&t.hasOwnProperty(e)||(t[e]=n.parse(e)),n.format.call(null,t[e],arguments)}function r(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function i(e,t){return Array(t+1).join(e)}var o={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};n.format=function(e,t){var a,s,u,c,l,f,d,p=1,h=e.length,v="",m=[],g=!0,y="";for(s=0;s<h;s++)if(v=r(e[s]),"string"===v)m[m.length]=e[s];else if("array"===v){if(c=e[s],c[2])for(a=t[p],u=0;u<c[2].length;u++){if(!a.hasOwnProperty(c[2][u]))throw new Error(n("[sprintf] property '%s' does not exist",c[2][u]));a=a[c[2][u]]}else a=c[1]?t[c[1]]:t[p++];if("function"==r(a)&&(a=a()),o.not_string.test(c[8])&&o.not_json.test(c[8])&&"number"!=r(a)&&isNaN(a))throw new TypeError(n("[sprintf] expecting number but found %s",r(a)));switch(o.number.test(c[8])&&(g=a>=0),c[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":case"i":a=parseInt(a,10);break;case"j":a=JSON.stringify(a,null,c[6]?parseInt(c[6]):0);break;case"e":a=c[7]?a.toExponential(c[7]):a.toExponential();break;case"f":a=c[7]?parseFloat(a).toFixed(c[7]):parseFloat(a);break;case"g":a=c[7]?parseFloat(a).toPrecision(c[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&c[7]?a.substring(0,c[7]):a;break;case"u":a>>>=0;break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}o.json.test(c[8])?m[m.length]=a:(!o.number.test(c[8])||g&&!c[3]?y="":(y=g?"+":"-",a=a.toString().replace(o.sign,"")),f=c[4]?"0"===c[4]?"0":c[4].charAt(1):" ",d=c[6]-(y+a).length,l=c[6]&&d>0?i(f,d):"",m[m.length]=c[5]?y+a+l:"0"===f?y+l+a:l+y+a)}return m.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],r=[],i=0;t;){if(null!==(n=o.text.exec(t)))r[r.length]=n[0];else if(null!==(n=o.modulo.exec(t)))r[r.length]="%";else{if(null===(n=o.placeholder.exec(t)))throw new SyntaxError("[sprintf] unexpected placeholder");if(n[2]){i|=1;var a=[],s=n[2],u=[];if(null===(u=o.key.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a[a.length]=u[1];""!==(s=s.substring(u[0].length));)if(null!==(u=o.key_access.exec(s)))a[a.length]=u[1];else{if(null===(u=o.index_access.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");a[a.length]=u[1]}n[2]=a}else i|=2;if(3===i)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r[r.length]=n}t=t.substring(n[0].length)}return r};var a=function(e,t,r){return r=(t||[]).slice(0),r.splice(0,0,e),n.apply(null,r)};t.sprintf=n,t.vsprintf=a}("undefined"==typeof window?this:window)},function(e,t,n){var r=n(65);e.exports=function(e){return r[e]}},function(e,t){e.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},function(e,t,n){function r(e){for(var t=Array.isArray(e)?e:i(e),n=0;n<t.length;n++){var r=t[n];if("preprocessor"===r.type){var a=r.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(a&&a[2]){var s=a[1],u=a[2];return(s?o(u):u).trim()}}}}var i=n(67),o=n(74);e.exports=r},function(e,t,n){function r(e,t){var n=i(t),r=[];return r=r.concat(n(e)),r=r.concat(n(null))}var i=n(68);e.exports=r},function(e,t,n){function r(e){function t(e){e.length&&z.push({type:A[B],data:e,position:X,line:G,column:H})}function n(e){j=0,W+=e,N=W.length;for(var t;D=W[j],j<N;){switch(t=j,B){case f:j=R();break;case d:j=M();break;case p:j=S();break;case h:j=C();break;case v:j=P();break;case E:j=k();break;case m:j=F();break;case l:j=I();break;case b:j=T();break;case c:j=x()}if(t!==j)switch(W[t]){case"\n":H=0,++G;break;default:++H}}return U+=j,W=W.slice(j),z}function r(e){return V.length&&t(V.join("")),B=w,t("(eof)"),z}function x(){return V=V.length?[]:V,"/"===L&&"*"===D?(X=U+j-1,B=f,L=D,j+1):"/"===L&&"/"===D?(X=U+j-1,B=d,L=D,j+1):"#"===D?(B=p,X=U+j,j):/\s/.test(D)?(B=b,X=U+j,j):(q=/\d/.test(D),Y=/[^\w_]/.test(D),X=U+j,B=q?v:Y?h:l,j)}function T(){return/[^\s]/g.test(D)?(t(V.join("")),B=c,j):(V.push(D),L=D,j+1)}function S(){return"\r"!==D&&"\n"!==D||"\\"===L?(V.push(D),L=D,j+1):(t(V.join("")),B=c,j)}function M(){return S()}function R(){return"/"===D&&"*"===L?(V.push(D),t(V.join("")),B=c,j+1):(V.push(D),L=D,j+1)}function C(){if("."===L&&/\d/.test(D))return B=m,j;if("/"===L&&"*"===D)return B=f,j;if("/"===L&&"/"===D)return B=d,j;if("."===D&&V.length){for(;O(V););return B=m,j}if(";"===D||")"===D||"("===D){if(V.length)for(;O(V););return t(D),B=c,j+1}var e=2===V.length&&"="!==D;if(/[\w_\d\s]/.test(D)||e){for(;O(V););return B=c,j}return V.push(D),L=D,j+1}function O(e){for(var n,r,i=0;;){if(n=o.indexOf(e.slice(0,e.length+i).join("")),r=o[n],n===-1){if(i--+e.length>0)continue;r=e.slice(0,1).join("")}return t(r),X+=r.length,V=V.slice(r.length),V.length}}function k(){return/[^a-fA-F0-9]/.test(D)?(t(V.join("")),B=c,j):(V.push(D),L=D,j+1)}function P(){return"."===D?(V.push(D),B=m,L=D,j+1):/[eE]/.test(D)?(V.push(D),B=m,L=D,j+1):"x"===D&&1===V.length&&"0"===V[0]?(B=E,V.push(D),L=D,j+1):/[^\d]/.test(D)?(t(V.join("")),B=c,j):(V.push(D),L=D,j+1)}function F(){return"f"===D&&(V.push(D),L=D,j+=1),/[eE]/.test(D)?(V.push(D),L=D,j+1):"-"===D&&/[eE]/.test(L)?(V.push(D),L=D,j+1):/[^\d]/.test(D)?(t(V.join("")),B=c,j):(V.push(D),L=D,j+1)}function I(){if(/[^\d\w_]/.test(D)){var e=V.join("");return B=J.indexOf(e)>-1?_:K.indexOf(e)>-1?y:g,t(V.join("")),B=c,j}return V.push(D),L=D,j+1}var D,L,N,j=0,U=0,B=c,V=[],z=[],G=1,H=0,X=0,q=!1,Y=!1,W="";e=e||{};var K=a,J=i;return"300 es"===e.version&&(K=u,J=s),function(e){return z=[],null!==e?n(e.replace?e.replace(/\r\n/g,"\n"):e):r()}}e.exports=r;var i=n(69),o=n(70),a=n(71),s=n(72),u=n(73),c=999,l=9999,f=0,d=1,p=2,h=3,v=4,m=5,g=6,y=7,_=8,b=9,w=10,E=11,A=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},function(e,t){e.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},function(e,t){e.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},function(e,t){e.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},function(e,t,n){var r=n(69);e.exports=r.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},function(e,t,n){var r=n(71);r=r.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),e.exports=r.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},function(e,t){e.exports=function(e){return atob(e)}},function(e,t,n){function r(e,t,n){t="number"==typeof t?t:1,n=n||": ";var r=e.split(/\r?\n/),o=String(r.length+t-1).length;return r.map(function(e,r){var a=r+t,s=String(a).length,u=i(a,o-s);return u+n+e}).join("\n")}var i=n(76);e.exports=r},function(e,t,n){/*!
	 * pad-left <https://github.com/jonschlinkert/pad-left>
	 *
	 * Copyright (c) 2014-2015, Jon Schlinkert.
	 * Licensed under the MIT license.
	 */
"use strict";var r=n(77);e.exports=function(e,t,n){return n="undefined"!=typeof n?n+"":" ",r(n,t)+e}},function(e,t){/*!
	 * repeat-string <https://github.com/jonschlinkert/repeat-string>
	 *
	 * Copyright (c) 2014-2015, Jon Schlinkert.
	 * Licensed under the MIT License.
	 */
"use strict";function n(e,t){if("string"!=typeof e)throw new TypeError("expected a string");if(1===t)return e;if(2===t)return e+e;var n=e.length*t;if(r!==e||"undefined"==typeof r)r=e,i="";else if(i.length>=n)return i.substr(0,n);for(;n>i.length&&t>1;)1&t&&(i+=e),t>>=1,e+=e;return i+=e,i=i.substr(0,n)}var r,i="";e.exports=n},function(e,t,n){function r(){var e=i();return{get:function(t,n){var r=e(t);return r.hasOwnProperty("value")?r.value:n},set:function(t,n){e(t).value=n},has:function(t){return"value"in e(t)},delete:function(t){return delete e(t).value}}}var i=n(79);e.exports=r},function(e,t,n){function r(){var e={};return function(t){if(("object"!=typeof t||null===t)&&"function"!=typeof t)throw new Error("Weakmap-shim: Key must be object");var n=t.valueOf(e);return n&&n.identity===e?n:i(t,e)}}var i=n(80);e.exports=r},function(e,t){function n(e,t){var n={identity:t},r=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(e){return e!==t?r.apply(this,arguments):n},writable:!0}),n}e.exports=n},function(e,t){"use strict";function n(e,t){if(!a){var n=Object.keys(o);a={};for(var r=0;r<n.length;++r){var i=n[r];a[e[i]]=o[i]}}return a[t]}function r(e,t){for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=[],o=0;o<r;++o){var a=e.getActiveUniform(t,o);if(a){var s=n(e,a.type);if(a.size>1)for(var u=0;u<a.size;++u)i.push({name:a.name.replace("[0]","["+u+"]"),type:s});else i.push({name:a.name,type:s})}}return i}function i(e,t){for(var r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=[],o=0;o<r;++o){var a=e.getActiveAttrib(t,o);a&&i.push({name:a.name,type:n(e,a.type)})}return i}t.uniforms=r,t.attributes=i;var o={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},a=null},function(e,t){(function(t){"use strict";function n(e,r){if(r=r||t,e in r)return r[e];for(var i,o=0;o<n.vendor.length;o++)if(i=n.vendor[o]+e.charAt(0).toUpperCase()+e.slice(1),i in r)return r[i]}n.vendor="webkit,moz,ms,o,khtml,WebKit,Moz,MS,O,Khtml".split(","),e.exports=n}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<e.length;n++)t(e[n])}function i(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function o(e,t,n){var r=e;return f(t)?(n=t,"string"==typeof e&&(r={uri:e})):r=p(t,{uri:e}),r.callback=n,r}function a(e,t,n){return t=o(e,t,n),s(t)}function s(e){function t(){4===l.readyState&&o()}function n(){var e=void 0;if(e=l.response?l.response:l.responseText||u(l),b)try{e=JSON.parse(e)}catch(e){}return e}function r(e){return clearTimeout(h),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,c(e,w)}function o(){if(!p){var t;clearTimeout(h),t=e.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var r=w,i=null;return 0!==t?(r={body:n(),statusCode:t,method:m,headers:{},url:v,rawRequest:l},l.getAllResponseHeaders&&(r.headers=d(l.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),c(i,r,r.body)}}if("undefined"==typeof e.callback)throw new Error("callback argument missing");var s=!1,c=function(t,n,r){s||(s=!0,e.callback(t,n,r))},l=e.xhr||null;l||(l=e.cors||e.useXDR?new a.XDomainRequest:new a.XMLHttpRequest);var f,p,h,v=l.url=e.uri||e.url,m=l.method=e.method||"GET",g=e.body||e.data,y=l.headers=e.headers||{},_=!!e.sync,b=!1,w={body:void 0,headers:{},statusCode:0,method:m,url:v,rawRequest:l};if("json"in e&&e.json!==!1&&(b=!0,y.accept||y.Accept||(y.Accept="application/json"),"GET"!==m&&"HEAD"!==m&&(y["content-type"]||y["Content-Type"]||(y["Content-Type"]="application/json"),g=JSON.stringify(e.json===!0?g:e.json))),l.onreadystatechange=t,l.onload=o,l.onerror=r,l.onprogress=function(){},l.onabort=function(){p=!0},l.ontimeout=r,l.open(m,v,!_,e.username,e.password),_||(l.withCredentials=!!e.withCredentials),!_&&e.timeout>0&&(h=setTimeout(function(){if(!p){p=!0,l.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",r(e)}},e.timeout)),l.setRequestHeader)for(f in y)y.hasOwnProperty(f)&&l.setRequestHeader(f,y[f]);else if(e.headers&&!i(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(l.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(l),l.send(g||null),l}function u(e){if("document"===e.responseType)return e.responseXML;var t=204===e.status&&e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function c(){}var l=n(84),f=n(85),d=n(86),p=n(89);e.exports=a,a.XMLHttpRequest=l.XMLHttpRequest||c,a.XDomainRequest="withCredentials"in new a.XMLHttpRequest?a.XMLHttpRequest:l.XDomainRequest,r(["get","put","post","patch","head","delete"],function(e){a["delete"===e?"del":e]=function(t,n,r){return n=o(t,n,r),n.method=e.toUpperCase(),s(n)}})},function(e,t){(function(t){"undefined"!=typeof window?e.exports=window:"undefined"!=typeof t?e.exports=t:"undefined"!=typeof self?e.exports=self:e.exports={}}).call(t,function(){return this}())},function(e,t){function n(e){var t=r.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}e.exports=n;var r=Object.prototype.toString},function(e,t,n){var r=n(87),i=n(88),o=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};var t={};return i(r(e).split("\n"),function(e){var n=e.indexOf(":"),i=r(e.slice(0,n)).toLowerCase(),a=r(e.slice(n+1));"undefined"==typeof t[i]?t[i]=a:o(t[i])?t[i].push(a):t[i]=[t[i],a]}),t}},function(e,t){function n(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=n,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}},function(e,t,n){function r(e,t,n){if(!s(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===u.call(e)?i(e,t,n):"string"==typeof e?o(e,t,n):a(e,t,n)}function i(e,t,n){for(var r=0,i=e.length;r<i;r++)c.call(e,r)&&t.call(n,e[r],r,e)}function o(e,t,n){for(var r=0,i=e.length;r<i;r++)t.call(n,e.charAt(r),r,e)}function a(e,t,n){for(var r in e)c.call(e,r)&&t.call(n,e[r],r,e)}var s=n(85);e.exports=r;var u=Object.prototype.toString,c=Object.prototype.hasOwnProperty},function(e,t){function n(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var i in n)r.call(n,i)&&(e[i]=n[i])}return e}e.exports=n;var r=Object.prototype.hasOwnProperty},function(e,t,n){var r,i,o;(function(e){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(a,s){"object"===n(t)&&"object"===n(e)?e.exports=s():(i=[],r=s,o="function"==typeof r?r.apply(t,i):r,!(void 0!==o&&(e.exports=o)))}(void 0,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}var i=n(1),o=r(i);e.exports=o.default},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(2),o=r(i),a=n(6),s=r(a),u=n(3),c=r(u),l=n(7),f=r(l),d=n(8),p=r(d),h=n(10),v=r(h),m=n(11),g=r(m),y=n(12),_=r(y),b=n(13),w=r(b),E=n(14),A=r(E),x=n(15),T=r(x),S=n(16),M=r(S),R=n(9),C=r(R),O=n(17),k=r(O);t.default={color:{Color:o.default,math:s.default,interpret:c.default},controllers:{Controller:f.default,BooleanController:p.default,OptionController:v.default,StringController:g.default,NumberController:_.default,NumberControllerBox:w.default,NumberControllerSlider:A.default,FunctionController:T.default,ColorController:M.default},dom:{dom:C.default},gui:{GUI:k.default},GUI:k.default}},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(v.recalculateRGB(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(v.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function a(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(v.recalculateHSV(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(v.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}t.__esModule=!0;var s=n(3),u=r(s),c=n(6),l=r(c),f=n(4),d=r(f),p=n(5),h=r(p),v=function(){function e(){if(i(this,e),this.__state=u.default.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return e.prototype.toString=function(){return(0,d.default)(this)},e.prototype.toHexString=function(){return(0,d.default)(this,!0)},e.prototype.toOriginal=function(){return this.__state.conversion.write(this)},e}();v.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=l.default.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");h.default.extend(e.__state,l.default.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},v.recalculateHSV=function(e){var t=l.default.rgb_to_hsv(e.r,e.g,e.b);h.default.extend(e.__state,{s:t.s,v:t.v}),h.default.isNaN(t.h)?h.default.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},v.COMPONENTS=["r","g","b","h","s","v","hex","a"],o(v.prototype,"r",2),o(v.prototype,"g",1),o(v.prototype,"b",0),a(v.prototype,"h"),a(v.prototype,"s"),a(v.prototype,"v"),Object.defineProperty(v.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(v.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=l.default.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),t.default=v},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(4),o=r(i),a=n(5),s=r(a),u=[{litmus:s.default.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:o.default},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:o.default},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:o.default},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:o.default}}},{litmus:s.default.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:s.default.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:s.default.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(s.default.isNumber(e.r)&&s.default.isNumber(e.g)&&s.default.isNumber(e.b)&&s.default.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(s.default.isNumber(e.r)&&s.default.isNumber(e.g)&&s.default.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(s.default.isNumber(e.h)&&s.default.isNumber(e.s)&&s.default.isNumber(e.v)&&s.default.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(s.default.isNumber(e.h)&&s.default.isNumber(e.s)&&s.default.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],c=void 0,l=void 0,f=function(){l=!1;var e=arguments.length>1?s.default.toArray(arguments):arguments[0];return s.default.each(u,function(t){if(t.litmus(e))return s.default.each(t.conversions,function(t,n){if(c=t.read(e),l===!1&&c!==!1)return l=c,c.conversionName=n,c.conversion=t,s.default.BREAK}),s.default.BREAK}),l};t.default=f},function(e,t){t.__esModule=!0,t.default=function(e,t){var n=e.__state.conversionName.toString(),r=Math.round(e.r),i=Math.round(e.g),o=Math.round(e.b),a=e.a,s=Math.round(e.h),u=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var l=e.hex.toString(16);l.length<6;)l="0"+l;return"#"+l}return"CSS_RGB"===n?"rgb("+r+","+i+","+o+")":"CSS_RGBA"===n?"rgba("+r+","+i+","+o+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+r+","+i+","+o+"]":"RGBA_ARRAY"===n?"["+r+","+i+","+o+","+a+"]":"RGB_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+"}":"RGBA_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+u+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+u+",v:"+c+",a:"+a+"}":"unknown format"}},function(e,t){t.__esModule=!0;var n=Array.prototype.forEach,r=Array.prototype.slice,i={BREAK:{},extend:function(e){return this.each(r.call(arguments,1),function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))},this),e},defaults:function(e){return this.each(r.call(arguments,1),function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))},this),e},compose:function(){var e=r.call(arguments);return function(){for(var t=r.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,r){if(e)if(n&&e.forEach&&e.forEach===n)e.forEach(t,r);else if(e.length===e.length+0){var i=void 0,o=void 0;for(i=0,o=e.length;i<o;i++)if(i in e&&t.call(r,e[i],i)===this.BREAK)return}else for(var a in e)if(t.call(r,e[a],a)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t){var n=void 0;return function(){function r(){n=null}var i=this,o=arguments,a=!n;clearTimeout(n),n=setTimeout(r,t),a&&e.apply(i,o)}},toArray:function(e){return e.toArray?e.toArray():r.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return isNaN(e)}),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}};t.default=i},function(e,t){t.__esModule=!0;var n=void 0,r={hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,n){var r=Math.min(e,t,n),i=Math.max(e,t,n),o=i-r,a=void 0,s=void 0;return 0===i?{h:NaN,s:0,v:0}:(s=o/i,a=e===i?(t-n)/o:t===i?2+(n-e)/o:4+(e-t)/o,a/=6,a<0&&(a+=1),{h:360*a,s:s,v:i/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,r){return r<<(n=8*t)|e&~(255<<n)}};t.default=r},function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function(){function e(t,r){n(this,e),this.initialValue=t[r],this.domElement=document.createElement("div"),this.object=t,this.property=r,this.__onChange=void 0,this.__onFinishChange=void 0}return e.prototype.onChange=function(e){return this.__onChange=e,this},e.prototype.onFinishChange=function(e){return this.__onFinishChange=e,this},e.prototype.setValue=function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this},e.prototype.getValue=function(){return this.object[this.property]},e.prototype.updateDisplay=function(){return this},e.prototype.isModified=function(){return this.initialValue!==this.getValue()},e}();t.default=r},function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":n(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":n(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var u=r(7),c=i(u),l=r(9),f=i(l),d=function(e){function t(n,r){function i(){u.setValue(!u.__prev)}o(this,t);var s=a(this,e.call(this,n,r)),u=s;return s.__prev=s.getValue(),s.__checkbox=document.createElement("input"),s.__checkbox.setAttribute("type","checkbox"),f.default.bind(s.__checkbox,"change",i,!1),s.domElement.appendChild(s.__checkbox),s.updateDisplay(),s}return s(t,e),t.prototype.setValue=function(t){var n=e.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n},t.prototype.updateDisplay=function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,e.prototype.updateDisplay.call(this)},t}(c.default);t.default=d},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if("0"===e||a.default.isUndefined(e))return 0;var t=e.match(c);return a.default.isNull(t)?0:parseFloat(t[1])}t.__esModule=!0;var o=n(5),a=r(o),s={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},u={};a.default.each(s,function(e,t){a.default.each(e,function(e){u[e]=t})});var c=/(\d+(\.\d+)?)px/,l={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var r=n,i=t;a.default.isUndefined(i)&&(i=!0),a.default.isUndefined(r)&&(r=!0),e.style.position="absolute",i&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,r){var i=n||{},o=u[t];if(!o)throw new Error("Event type "+t+" not supported.");var s=document.createEvent(o);switch(o){case"MouseEvents":var c=i.x||i.clientX||0,l=i.y||i.clientY||0;s.initMouseEvent(t,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,c,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var f=s.initKeyboardEvent||s.initKeyEvent;a.default.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),f(t,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(t,i.bubbles||!1,i.cancelable||!0)}a.default.defaults(s,r),e.dispatchEvent(s)},bind:function(e,t,n,r){var i=r||!1;return e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on"+t,n),l},unbind:function(e,t,n,r){var i=r||!1;return e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent&&e.detachEvent("on"+t,n),l},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);n.indexOf(t)===-1&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return l},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),r=n.indexOf(t);r!==-1&&(n.splice(r,1),e.className=n.join(" "))}else e.className=void 0;return l},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return i(t["border-left-width"])+i(t["border-right-width"])+i(t["padding-left"])+i(t["padding-right"])+i(t.width)},getHeight:function(e){var t=getComputedStyle(e);return i(t["border-top-width"])+i(t["border-bottom-width"])+i(t["padding-top"])+i(t["padding-bottom"])+i(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent;while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};t.default=l},function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":n(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":n(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var u=r(7),c=i(u),l=r(9),f=i(l),d=r(5),p=i(d),h=function(e){function t(n,r,i){o(this,t);var s=a(this,e.call(this,n,r)),u=i,c=s;return s.__select=document.createElement("select"),p.default.isArray(u)&&!function(){var e={};p.default.each(u,function(t){e[t]=t}),u=e}(),p.default.each(u,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),c.__select.appendChild(n)}),s.updateDisplay(),f.default.bind(s.__select,"change",function(){var e=this.options[this.selectedIndex].value;c.setValue(e)}),s.domElement.appendChild(s.__select),s}return s(t,e),t.prototype.setValue=function(t){var n=e.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n},t.prototype.updateDisplay=function(){return f.default.isActive(this.__select)?this:(this.__select.value=this.getValue(),e.prototype.updateDisplay.call(this))},t}(c.default);t.default=h},function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":n(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":n(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var u=r(7),c=i(u),l=r(9),f=i(l),d=function(e){function t(n,r){function i(){c.setValue(c.__input.value)}function s(){c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}o(this,t);var u=a(this,e.call(this,n,r)),c=u;return u.__input=document.createElement("input"),u.__input.setAttribute("type","text"),f.default.bind(u.__input,"keyup",i),f.default.bind(u.__input,"change",i),f.default.bind(u.__input,"blur",s),f.default.bind(u.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),u.updateDisplay(),u.domElement.appendChild(u.__input),u}return s(t,e),t.prototype.updateDisplay=function(){return f.default.isActive(this.__input)||(this.__input.value=this.getValue()),e.prototype.updateDisplay.call(this)},t}(c.default);t.default=d},function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":n(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":n(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}t.__esModule=!0;var c=r(7),l=i(c),f=r(5),d=i(f),p=function(e){function t(n,r,i){o(this,t);var s=a(this,e.call(this,n,r)),c=i||{};return s.__min=c.min,s.__max=c.max,s.__step=c.step,d.default.isUndefined(s.__step)?0===s.initialValue?s.__impliedStep=1:s.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__impliedStep=s.__step,s.__precision=u(s.__impliedStep),s}return s(t,e),t.prototype.setValue=function(t){var n=t;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!==0&&(n=Math.round(n/this.__step)*this.__step),e.prototype.setValue.call(this,n)},t.prototype.min=function(e){return this.__min=e,this},t.prototype.max=function(e){return this.__max=e,this},t.prototype.step=function(e){return this.__step=e,this.__impliedStep=e,this.__precision=u(e),this},t}(l.default);t.default=p},function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":n(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":n(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}t.__esModule=!0;var c=r(12),l=i(c),f=r(9),d=i(f),p=r(5),h=i(p),v=function(e){function t(n,r,i){function s(){var e=parseFloat(m.__input.value);h.default.isNaN(e)||m.setValue(e)}function u(){m.__onFinishChange&&m.__onFinishChange.call(m,m.getValue())}function c(){u()}function l(e){var t=g-e.clientY;m.setValue(m.getValue()+t*m.__impliedStep),g=e.clientY}function f(){d.default.unbind(window,"mousemove",l),d.default.unbind(window,"mouseup",f),u()}function p(e){d.default.bind(window,"mousemove",l),d.default.bind(window,"mouseup",f),g=e.clientY}o(this,t);var v=a(this,e.call(this,n,r,i));v.__truncationSuspended=!1;var m=v,g=void 0;return v.__input=document.createElement("input"),v.__input.setAttribute("type","text"),d.default.bind(v.__input,"change",s),d.default.bind(v.__input,"blur",c),d.default.bind(v.__input,"mousedown",p),d.default.bind(v.__input,"keydown",function(e){13===e.keyCode&&(m.__truncationSuspended=!0,this.blur(),m.__truncationSuspended=!1,u())}),v.updateDisplay(),v.domElement.appendChild(v.__input),v}return s(t,e),t.prototype.updateDisplay=function(){return this.__input.value=this.__truncationSuspended?this.getValue():u(this.getValue(),this.__precision),e.prototype.updateDisplay.call(this)},t}(l.default);t.default=v},function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":n(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":n(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n,r,i){return r+(i-r)*((e-t)/(n-t))}t.__esModule=!0;var c=r(12),l=i(c),f=r(9),d=i(f),p=function(e){function t(n,r,i,s,c){function l(e){document.activeElement.blur(),d.default.bind(window,"mousemove",f),d.default.bind(window,"mouseup",p),f(e)}function f(e){e.preventDefault();var t=v.__background.getBoundingClientRect();return v.setValue(u(e.clientX,t.left,t.right,v.__min,v.__max)),!1}function p(){d.default.unbind(window,"mousemove",f),d.default.unbind(window,"mouseup",p),v.__onFinishChange&&v.__onFinishChange.call(v,v.getValue())}o(this,t);var h=a(this,e.call(this,n,r,{min:i,max:s,step:c})),v=h;return h.__background=document.createElement("div"),h.__foreground=document.createElement("div"),d.default.bind(h.__background,"mousedown",l),d.default.addClass(h.__background,"slider"),d.default.addClass(h.__foreground,"slider-fg"),h.updateDisplay(),h.__background.appendChild(h.__foreground),h.domElement.appendChild(h.__background),h}return s(t,e),t.prototype.updateDisplay=function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",e.prototype.updateDisplay.call(this)},t}(l.default);t.default=p},function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":n(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":n(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var u=r(7),c=i(u),l=r(9),f=i(l),d=function(e){function t(n,r,i){o(this,t);var s=a(this,e.call(this,n,r)),u=s;return s.__button=document.createElement("div"),s.__button.innerHTML=void 0===i?"Fire":i,f.default.bind(s.__button,"click",function(e){return e.preventDefault(),u.fire(),!1}),f.default.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return s(t,e),t.prototype.fire=function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())},t}(c.default);t.default=d},function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":n(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":n(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);
}function u(e,t,n,r){e.style.background="",_.default.each(w,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+n+" 0%, "+r+" 100%); "})}function c(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}t.__esModule=!0;var l=r(7),f=i(l),d=r(9),p=i(d),h=r(2),v=i(h),m=r(3),g=i(m),y=r(5),_=i(y),b=function(e){function t(n,r){function i(e){h(e),p.default.bind(window,"mousemove",h),p.default.bind(window,"mouseup",s)}function s(){p.default.unbind(window,"mousemove",h),p.default.unbind(window,"mouseup",s),d()}function l(){var e=(0,g.default)(this.value);e!==!1?(b.__color.__state=e,b.setValue(b.__color.toOriginal())):this.value=b.__color.toString()}function f(){p.default.unbind(window,"mousemove",m),p.default.unbind(window,"mouseup",f),d()}function d(){b.__onFinishChange&&b.__onFinishChange.call(b,b.__color.toOriginal())}function h(e){e.preventDefault();var t=b.__saturation_field.getBoundingClientRect(),n=(e.clientX-t.left)/(t.right-t.left),r=1-(e.clientY-t.top)/(t.bottom-t.top);return r>1?r=1:r<0&&(r=0),n>1?n=1:n<0&&(n=0),b.__color.v=r,b.__color.s=n,b.setValue(b.__color.toOriginal()),!1}function m(e){e.preventDefault();var t=b.__hue_field.getBoundingClientRect(),n=1-(e.clientY-t.top)/(t.bottom-t.top);return n>1?n=1:n<0&&(n=0),b.__color.h=360*n,b.setValue(b.__color.toOriginal()),!1}o(this,t);var y=a(this,e.call(this,n,r));y.__color=new v.default(y.getValue()),y.__temp=new v.default(0);var b=y;y.domElement=document.createElement("div"),p.default.makeSelectable(y.domElement,!1),y.__selector=document.createElement("div"),y.__selector.className="selector",y.__saturation_field=document.createElement("div"),y.__saturation_field.className="saturation-field",y.__field_knob=document.createElement("div"),y.__field_knob.className="field-knob",y.__field_knob_border="2px solid ",y.__hue_knob=document.createElement("div"),y.__hue_knob.className="hue-knob",y.__hue_field=document.createElement("div"),y.__hue_field.className="hue-field",y.__input=document.createElement("input"),y.__input.type="text",y.__input_textShadow="0 1px 1px ",p.default.bind(y.__input,"keydown",function(e){13===e.keyCode&&l.call(this)}),p.default.bind(y.__input,"blur",l),p.default.bind(y.__selector,"mousedown",function(){p.default.addClass(this,"drag").bind(window,"mouseup",function(){p.default.removeClass(b.__selector,"drag")})});var w=document.createElement("div");return _.default.extend(y.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),_.default.extend(y.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:y.__field_knob_border+(y.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),_.default.extend(y.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),_.default.extend(y.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),_.default.extend(w.style,{width:"100%",height:"100%",background:"none"}),u(w,"top","rgba(0,0,0,0)","#000"),_.default.extend(y.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),c(y.__hue_field),_.default.extend(y.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:y.__input_textShadow+"rgba(0,0,0,0.7)"}),p.default.bind(y.__saturation_field,"mousedown",i),p.default.bind(y.__field_knob,"mousedown",i),p.default.bind(y.__hue_field,"mousedown",function(e){m(e),p.default.bind(window,"mousemove",m),p.default.bind(window,"mouseup",f)}),y.__saturation_field.appendChild(w),y.__selector.appendChild(y.__field_knob),y.__selector.appendChild(y.__saturation_field),y.__selector.appendChild(y.__hue_field),y.__hue_field.appendChild(y.__hue_knob),y.domElement.appendChild(y.__input),y.domElement.appendChild(y.__selector),y.updateDisplay(),y}return s(t,e),t.prototype.updateDisplay=function(){var e=(0,g.default)(this.getValue());if(e!==!1){var t=!1;_.default.each(v.default.COMPONENTS,function(n){if(!_.default.isUndefined(e[n])&&!_.default.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&_.default.extend(this.__color.__state,e)}_.default.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,r=255-n;_.default.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,u(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),_.default.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})},t}(f.default),w=["-moz-","-o-","-webkit-","-ms-",""];t.default=b},function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){var r=document.createElement("li");return t&&r.appendChild(t),n?e.__ul.insertBefore(r,n):e.__ul.appendChild(r),e.onResize(),r}function a(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];t?n.innerHTML=n.value+"*":n.innerHTML=n.value}function s(e,t,n){if(n.__li=t,n.__gui=e,X.default.extend(n,{options:function(t){if(arguments.length>1){var r=n.__li.nextElementSibling;return n.remove(),c(e,n.object,n.property,{before:r,factoryArgs:[X.default.toArray(arguments)]})}if(X.default.isArray(t)||X.default.isObject(t)){var i=n.__li.nextElementSibling;return n.remove(),c(e,n.object,n.property,{before:i,factoryArgs:[t]})}},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof D.default)!function(){var e=new F.default(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});X.default.each(["updateDisplay","onChange","onFinishChange","step"],function(t){var r=n[t],i=e[t];n[t]=e[t]=function(){var t=Array.prototype.slice.call(arguments);return i.apply(e,t),r.apply(n,t)}}),G.default.addClass(t,"has-slider"),n.domElement.insertBefore(e.domElement,n.domElement.firstElementChild)}();else if(n instanceof F.default){var r=function(t){if(X.default.isNumber(n.__min)&&X.default.isNumber(n.__max)){var r=n.__li.firstElementChild.firstElementChild.innerHTML,i=n.__gui.__listening.indexOf(n)>-1;n.remove();var o=c(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return o.name(r),i&&o.listen(),o}return t};n.min=X.default.compose(r,n.min),n.max=X.default.compose(r,n.max)}else n instanceof C.default?(G.default.bind(t,"click",function(){G.default.fakeEvent(n.__checkbox,"click")}),G.default.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof k.default?(G.default.bind(t,"click",function(){G.default.fakeEvent(n.__button,"click")}),G.default.bind(t,"mouseover",function(){G.default.addClass(n.__button,"hover")}),G.default.bind(t,"mouseout",function(){G.default.removeClass(n.__button,"hover")})):n instanceof N.default&&(G.default.addClass(t,"color"),n.updateDisplay=X.default.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=X.default.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&a(e.getRoot(),!0),t},n.setValue)}function u(e,t){var n=e.getRoot(),r=n.__rememberedObjects.indexOf(t.object);if(r!==-1){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[t.property]=t,n.load&&n.load.remembered){var o=n.load.remembered,a=void 0;if(o[e.preset])a=o[e.preset];else{if(!o[Z])return;a=o[Z]}if(a[r]&&void 0!==a[r][t.property]){var s=a[r][t.property];t.initialValue=s,t.setValue(s)}}}}function c(e,t,n,r){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var i=void 0;if(r.color)i=new N.default(t,n);else{var a=[t,n].concat(r.factoryArgs);i=T.default.apply(e,a)}r.before instanceof M.default&&(r.before=r.before.__li),u(e,i),G.default.addClass(i.domElement,"c");var c=document.createElement("span");G.default.addClass(c,"property-name"),c.innerHTML=i.property;var l=document.createElement("div");l.appendChild(c),l.appendChild(i.domElement);var f=o(e,l,r.before);return G.default.addClass(f,ie.CLASS_CONTROLLER_ROW),i instanceof N.default?G.default.addClass(f,"color"):G.default.addClass(f,_(i.getValue())),s(e,f,i),e.__controllers.push(i),i}function l(e,t){return document.location.href+"."+t}function f(e,t,n){var r=document.createElement("option");r.innerHTML=t,r.value=t,e.__preset_select.appendChild(r),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function d(e,t){t.style.display=e.useLocalStorage?"block":"none"}function p(e){var t=e.__save_row=document.createElement("li");G.default.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),G.default.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",G.default.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",G.default.addClass(r,"button"),G.default.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",G.default.addClass(i,"button"),G.default.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",G.default.addClass(o,"button"),G.default.addClass(o,"revert");var a=e.__preset_select=document.createElement("select");e.load&&e.load.remembered?X.default.each(e.load.remembered,function(t,n){f(e,n,n===e.preset)}):f(e,Z,!1),G.default.bind(a,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(a),t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(o),Q&&!function(){var t=document.getElementById("dg-local-explain"),n=document.getElementById("dg-local-storage"),r=document.getElementById("dg-save-locally");r.style.display="block","true"===localStorage.getItem(l(e,"isLocal"))&&n.setAttribute("checked","checked"),d(e,t),G.default.bind(n,"change",function(){e.useLocalStorage=!e.useLocalStorage,d(e,t)})}();var s=document.getElementById("dg-new-constructor");G.default.bind(s,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||$.hide()}),G.default.bind(n,"click",function(){s.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),$.show(),s.focus(),s.select()}),G.default.bind(r,"click",function(){e.save()}),G.default.bind(i,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),G.default.bind(o,"click",function(){e.revert()})}function h(e){function t(t){return t.preventDefault(),e.width+=i-t.clientX,e.onResize(),i=t.clientX,!1}function n(){G.default.removeClass(e.__closeButton,ie.CLASS_DRAG),G.default.unbind(window,"mousemove",t),G.default.unbind(window,"mouseup",n)}function r(r){return r.preventDefault(),i=r.clientX,G.default.addClass(e.__closeButton,ie.CLASS_DRAG),G.default.bind(window,"mousemove",t),G.default.bind(window,"mouseup",n),!1}var i=void 0;e.__resize_handle=document.createElement("div"),X.default.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),G.default.bind(e.__resize_handle,"mousedown",r),G.default.bind(e.__closeButton,"mousedown",r),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function v(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function m(e,t){var n={};return X.default.each(e.__rememberedObjects,function(r,i){var o={},a=e.__rememberedObjectIndecesToControllers[i];X.default.each(a,function(e,n){o[n]=t?e.initialValue:e.getValue()}),n[i]=o}),n}function g(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}function y(e){0!==e.length&&U.default.call(window,function(){y(e)}),X.default.each(e,function(e){e.updateDisplay()})}var _="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":"undefined"==typeof e?"undefined":n(e)},b=r(18),w=i(b),E=r(19),A=i(E),x=r(20),T=i(x),S=r(7),M=i(S),R=r(8),C=i(R),O=r(15),k=i(O),P=r(13),F=i(P),I=r(14),D=i(I),L=r(16),N=i(L),j=r(21),U=i(j),B=r(22),V=i(B),z=r(9),G=i(z),H=r(5),X=i(H),q=r(23),Y=i(q);w.default.inject(Y.default);var W="dg",K=72,J=20,Z="Default",Q=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),$=void 0,ee=!0,te=void 0,ne=!1,re=[],ie=function e(t){function n(){var e=r.getRoot();e.width+=1,X.default.defer(function(){e.width-=1})}var r=this,i=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),G.default.addClass(this.domElement,W),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=X.default.defaults(i,{autoPlace:!0,width:e.DEFAULT_WIDTH}),i=X.default.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),X.default.isUndefined(i.load)?i.load={preset:Z}:i.preset&&(i.load.preset=i.preset),X.default.isUndefined(i.parent)&&i.hideable&&re.push(this),i.resizable=X.default.isUndefined(i.parent)&&i.resizable,i.autoPlace&&X.default.isUndefined(i.scrollable)&&(i.scrollable=!0);var a=Q&&"true"===localStorage.getItem(l(this,"isLocal")),s=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:i.load.preset},set:function(e){r.parent?r.getRoot().preset=e:i.load.preset=e,g(this),r.revert()}},width:{get:function(){return i.width},set:function(e){i.width=e,v(r,e)}},name:{get:function(){return i.name},set:function(e){i.name=e,titleRowName&&(titleRowName.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(t){i.closed=t,i.closed?G.default.addClass(r.__ul,e.CLASS_CLOSED):G.default.removeClass(r.__ul,e.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return a},set:function(e){Q&&(a=e,e?G.default.bind(window,"unload",s):G.default.unbind(window,"unload",s),localStorage.setItem(l(r,"isLocal"),e))}}}),X.default.isUndefined(i.parent)){if(i.closed=!1,G.default.addClass(this.domElement,e.CLASS_MAIN),G.default.makeSelectable(this.domElement,!1),Q&&a){r.useLocalStorage=!0;var u=localStorage.getItem(l(this,"gui"));u&&(i.load=JSON.parse(u))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,G.default.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),G.default.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{void 0===i.closed&&(i.closed=!0);var c=document.createTextNode(i.name);G.default.addClass(c,"controller-name");var f=o(r,c),d=function(e){return e.preventDefault(),r.closed=!r.closed,!1};G.default.addClass(this.__ul,e.CLASS_CLOSED),G.default.addClass(f,"title"),G.default.bind(f,"click",d),i.closed||(this.closed=!1)}i.autoPlace&&(X.default.isUndefined(i.parent)&&(ee&&(te=document.createElement("div"),G.default.addClass(te,W),G.default.addClass(te,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(te),ee=!1),te.appendChild(this.domElement),G.default.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||v(r,i.width)),this.__resizeHandler=function(){r.onResizeDebounced()},G.default.bind(window,"resize",this.__resizeHandler),G.default.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),G.default.bind(this.__ul,"transitionend",this.__resizeHandler),G.default.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&h(this),s=function(){Q&&"true"===localStorage.getItem(l(r,"isLocal"))&&localStorage.setItem(l(r,"gui"),JSON.stringify(r.getSaveObject()))},this.saveToLocalStorageIfPossible=s,i.parent||n()};ie.toggleHide=function(){ne=!ne,X.default.each(re,function(e){e.domElement.style.display=ne?"none":""})},ie.CLASS_AUTO_PLACE="a",ie.CLASS_AUTO_PLACE_CONTAINER="ac",ie.CLASS_MAIN="main",ie.CLASS_CONTROLLER_ROW="cr",ie.CLASS_TOO_TALL="taller-than-window",ie.CLASS_CLOSED="closed",ie.CLASS_CLOSE_BUTTON="close-button",ie.CLASS_DRAG="drag",ie.DEFAULT_WIDTH=245,ie.TEXT_CLOSED="Close Controls",ie.TEXT_OPEN="Open Controls",ie._keydownHandler=function(e){"text"===document.activeElement.type||e.which!==K&&e.keyCode!==K||ie.toggleHide()},G.default.bind(window,"keydown",ie._keydownHandler,!1),X.default.extend(ie.prototype,{add:function(e,t){return c(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return c(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;X.default.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&te.removeChild(this.domElement),G.default.unbind(window,"keydown",ie._keydownHandler,!1),G.default.unbind(window,"resize",this.__resizeHandler),this.saveToLocalStorageIfPossible&&G.default.unbind(window,"unload",this.saveToLocalStorageIfPossible)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new ie(t);this.__folders[e]=n;var r=o(this,n.domElement);return G.default.addClass(r,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=G.default.getOffset(e.__ul).top,n=0;X.default.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=G.default.getHeight(t))}),window.innerHeight-t-J<n?(G.default.addClass(e.domElement,ie.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-J+"px"):(G.default.removeClass(e.domElement,ie.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&X.default.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:X.default.debounce(function(){this.onResize()},200),remember:function(){if(X.default.isUndefined($)&&($=new V.default,$.domElement.innerHTML=A.default),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;X.default.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&p(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&v(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=m(this)),e.folders={},X.default.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=m(this),a(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[Z]=m(this,!0)),this.load.remembered[e]=m(this),this.preset=e,f(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){X.default.each(this.__controllers,function(t){this.getRoot().load.remembered?u(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),X.default.each(this.__folders,function(e){e.revert(e)}),e||a(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&y(this.__listening)},updateDisplay:function(){X.default.each(this.__controllers,function(e){e.updateDisplay()}),X.default.each(this.__folders,function(e){e.updateDisplay()})}}),e.exports=ie},function(e,t){e.exports={load:function(e,t){var n=t||document,r=n.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=e,n.getElementsByTagName("head")[0].appendChild(r)},inject:function(e,t){var n=t||document,r=document.createElement("style");r.type="text/css",r.innerHTML=e;var i=n.getElementsByTagName("head")[0];try{i.appendChild(r)}catch(e){}}}},function(e,t){e.exports='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(10),o=r(i),a=n(13),s=r(a),u=n(14),c=r(u),l=n(11),f=r(l),d=n(15),p=r(d),h=n(8),v=r(h),m=n(5),g=r(m),y=function(e,t){var n=e[t];return g.default.isArray(arguments[2])||g.default.isObject(arguments[2])?new o.default(e,t,arguments[2]):g.default.isNumber(n)?g.default.isNumber(arguments[2])&&g.default.isNumber(arguments[3])?g.default.isNumber(arguments[4])?new c.default(e,t,arguments[2],arguments[3],arguments[4]):new c.default(e,t,arguments[2],arguments[3]):g.default.isNumber(arguments[4])?new s.default(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new s.default(e,t,{min:arguments[2],max:arguments[3]}):g.default.isString(n)?new f.default(e,t):g.default.isFunction(n)?new p.default(e,t,""):g.default.isBoolean(n)?new v.default(e,t):null};t.default=y},function(e,t){function n(e){setTimeout(e,1e3/60)}t.__esModule=!0,t.default=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||n},function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=n(9),a=r(o),s=n(5),u=r(s),c=function(){function e(){i(this,e),this.backgroundElement=document.createElement("div"),u.default.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),a.default.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),u.default.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;a.default.bind(this.backgroundElement,"click",function(){t.hide()})}return e.prototype.show=function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),u.default.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})},e.prototype.hide=function e(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",a.default.unbind(t.domElement,"webkitTransitionEnd",e),a.default.unbind(t.domElement,"transitionend",e),a.default.unbind(t.domElement,"oTransitionEnd",e)};a.default.bind(this.domElement,"webkitTransitionEnd",e),a.default.bind(this.domElement,"transitionend",e),a.default.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},e.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-a.default.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-a.default.getHeight(this.domElement)/2+"px"},e}();t.default=c},function(e,t,n){t=e.exports=n(24)(),t.push([e.id,".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid transparent; }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name,\n  .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: #000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.color {\n    border-left: 3px solid; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2FA1D6; }\n    .dg .cr.number input[type=text] {\n      color: #2FA1D6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.function:hover, .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2FA1D6;\n    max-width: 100%; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n",""]);
},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<t.length;i++){var a=t[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}}])})}).call(t,n(91)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.defaultExcept=["127.0.0.1","0.0.0.0","localhost"],r=t.redirect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=e+":";document.location.protocol!==r&&t.indexOf(document.location.hostname)<0&&(document.location.protocol=r)};t.default=r},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,r){n(this,e),this.time=0,this.since=0,this.offset=0,this.rate=1,this.step=-1,this.dt=0,this.paused=!1,this.end=-1,this.loop=!1,this.reset(t,r)}return r(e,[{key:"now",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return(e-this.offset)*this.rate}},{key:"tick",value:function(e){var t=this.time,n=0;if(this.step>=0)n=this.step*this.rate,t+=n;else{var r=t;t=this.now(e),n=t-r}return this.paused?(this.offset+=n,n=0):this.end<0?this.time=t:this.loop?this.time=t%this.end:(this.time=(this.rate>0?Math.min:Math.max)(t,this.end),this.time!==t&&(this.paused=!0)),this.dt=n,this}},{key:"seek",value:function(e){return this.offset=-e,this}},{key:"scrub",value:function(e){return this.offset-=e,this}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.since=this.offset=t,this.time=this.now(e),this}}]),e}();t.Timer=i,t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Tendrils=t.glSettings=t.defaults=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(56),c=r(u),l=n(95),f=r(l),d=n(112),p=r(d),h=n(93),v=r(h),m=n(127),g=n(131),y=r(g),_=n(133),b=n(128),w=r(b),E=n(134),A=r(E),x=n(135),T=r(x),S=n(136),M=r(S),R=n(137),C=r(R),O=n(138),k=r(O),P=n(130),F=r(P),I=n(139),D=r(I),L=n(140),N=r(L),j=t.defaults=function(){return{state:{rootNum:Math.pow(2,9),autoClearView:!1,autoFade:!0,damping:.043,speedLimit:.01,forceWeight:.016,varyForce:-.1,flowWeight:1,varyFlow:.2,noiseWeight:.002,varyNoise:.3,flowDecay:.003,flowWidth:5,noiseScale:2.125,varyNoiseScale:.5,noiseSpeed:25e-5,varyNoiseSpeed:.1,target:0,varyTarget:1,lineWidth:1,speedAlpha:1e-6,colorMapAlpha:.4,baseColor:[1,1,1,.5],flowColor:[1,1,1,.04],fadeColor:[.1333,.1333,.1333,0]},timer:Object.assign(new v.default,{step:1e3/60}),numBuffers:0,logicShader:null,renderShader:[T.default,M.default],flowShader:[C.default,k.default],fillShader:[F.default,D.default],copyShader:[F.default,N.default],colorMap:null}},U=(t.glSettings={preserveDrawingBuffer:!0,antialias:!0},t.Tendrils=function(){function e(t,n){o(this,e);var r=a({},j(),n);this.gl=t,this.state=r.state,(this.colorMap=r.colorMap)||(this.colorMap=(0,f.default)(this.gl,[1,1],{float:!0})),this.screen=new w.default(this.gl),this.flow=(0,f.default)(this.gl,[1,1],{float:!0}),this.targets=(0,f.default)(this.gl,[1,1],{float:!0}),this.buffers=[],this.setupBuffers(r.numBuffers),this.logicShader=null,this.renderShader=Array.isArray(r.renderShader)?c.default.apply(void 0,[this.gl].concat(i(r.renderShader))):r.renderShader,this.flowShader=Array.isArray(r.flowShader)?c.default.apply(void 0,[this.gl].concat(i(r.flowShader))):r.flowShader,this.copyShader=Array.isArray(r.copyShader)?c.default.apply(void 0,[this.gl].concat(i(r.copyShader))):r.copyShader,this.fillShader=Array.isArray(r.fillShader)?c.default.apply(void 0,[this.gl].concat(i(r.fillShader))):r.fillShader,this.uniforms={render:{},update:{}},this.particles=null,this.viewRes=[0,0],this.viewSize=[0,0],this.timer=r.timer,this.tempData=[]}return s(e,[{key:"setup",value:function(){return this.setupParticles.apply(this,arguments),this.reset(),this}},{key:"reset",value:function(){return this.spawn(),this}},{key:"dispose",value:function(){return this.particles.dispose(),delete this.particles,this}},{key:"setupBuffers",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.buffers.length<e;)this.buffers.push((0,f.default)(this.gl,[1,1]));for(;this.buffers.length>e;)this.buffers.pop().dispose();return this}},{key:"setupParticles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.rootNum,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;this.state.rootNum=e;var n=[e,e];return this.particles=new p.default(this.gl,{shape:n,geomShape:[n[0],2*n[1]],logicFrag:A.default,render:this.renderShader}),this.logicShader=this.particles.logic,this.particles.setup(t),this.targets.shape=n,this}},{key:"clear",value:function(){return this.clearView(),this.clearFlow(),this}},{key:"clearView",value:function(){var e=this;return this.buffers.forEach(function(t){t.bind(),e.gl.clear(e.gl.COLOR_BUFFER_BIT)}),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this}},{key:"clearFlow",value:function(){return this.flow.bind(),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this}},{key:"restart",value:function(){return this.clear(),this.reset(),this}},{key:"step",value:function(){return this.timer.paused||(this.particles.logic=this.logicShader,this.gl.disable(this.gl.BLEND),Object.assign(this.uniforms.update,this.state,{dt:this.timer.dt,time:this.timer.time,start:this.timer.since,flow:this.flow.color[0].bind(1),targets:this.targets.color[0].bind(2),viewSize:this.viewSize,viewRes:this.viewRes}),this.particles.step(this.uniforms.update),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this}},{key:"draw",value:function(){return this.viewport(),Object.assign(this.uniforms.render,this.state,{time:this.timer.time,previous:this.particles.buffers[1].color[0].bind(1),viewSize:this.viewSize,viewRes:this.viewRes,colorMap:(this.colorMap.color&&this.colorMap.color[0]?this.colorMap.color[0]:this.colorMap).bind(2),colorMapRes:this.colorMap.shape}),this.particles.render=this.flowShader,this.flow.bind(),this.gl.lineWidth(Math.max(0,this.state.flowWidth)),this.particles.draw(this.uniforms.render,this.gl.LINES),0===this.buffers.length?this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null):this.buffers[0].bind(),this.state.autoClearView&&this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.state.autoFade&&this.drawFade(),this.particles.render=this.renderShader,this.gl.lineWidth(Math.max(0,this.state.lineWidth)),this.particles.draw(this.uniforms.render,this.gl.LINES),this}},{key:"drawFade",value:function(){return this.state.fadeColor[3]>0&&this.drawFill(this.state.fadeColor),this}},{key:"drawFill",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.fadeColor;return this.fillShader.bind(),this.fillShader.uniforms.color=e,this.screen.render(),this}},{key:"drawBuffer",value:function(e){return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.state.autoClearView&&this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.copyBuffer(e).stepBuffers()}},{key:"copyBuffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e<this.buffers.length&&(this.copyShader.bind(),Object.assign(this.copyShader.uniforms,{view:this.buffers[e].color[0].bind(0),viewRes:this.viewRes}),this.screen.render()),this}},{key:"stepBuffers",value:function(){return this.buffers.length>1&&(0,m.step)(this.buffers),this}},{key:"resize",value:function(){var e=this;return this.viewRes[0]=this.gl.drawingBufferWidth,this.viewRes[1]=this.gl.drawingBufferHeight,(0,_.coverAspect)(this.viewSize,this.viewRes),this.buffers.forEach(function(t){return t.shape=e.viewRes}),this.flow.shape=this.viewRes,this}},{key:"viewport",value:function(){return this.gl.viewport(0,0,this.viewRes[0],this.viewRes[1]),this}},{key:"spawn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.default;return this.particles.spawn(e),this}},{key:"spawnShader",value:function(e,t){var n;this.timer.tick(),this.particles.logic=e,this.gl.disable(this.gl.BLEND);for(var r=arguments.length,i=Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(n=this.particles).step.apply(n,[p.default.applyUpdate(a({},this.state,{time:this.timer.time,viewSize:this.viewSize,viewRes:this.viewRes}),t)].concat(i)),this.particles.logic=this.logicShader,this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this}}]),e}());t.default=U},function(e,t,n){"use strict";function r(e){var t=e.getParameter(e.FRAMEBUFFER_BINDING),n=e.getParameter(e.RENDERBUFFER_BINDING),r=e.getParameter(e.TEXTURE_BINDING_2D);return[t,n,r]}function i(e,t){e.bindFramebuffer(e.FRAMEBUFFER,t[0]),e.bindRenderbuffer(e.RENDERBUFFER,t[1]),e.bindTexture(e.TEXTURE_2D,t[2])}function o(e,t){var n=e.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL);y=new Array(n+1);for(var r=0;r<=n;++r){for(var i=new Array(n),o=0;o<r;++o)i[o]=e.COLOR_ATTACHMENT0+o;for(var o=r;o<n;++o)i[o]=e.NONE;y[r]=i}}function a(e){switch(e){case h:throw new Error("gl-fbo: Framebuffer unsupported");case v:throw new Error("gl-fbo: Framebuffer incomplete attachment");case m:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case g:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function s(e,t,n,r,i,o){if(!r)return null;var a=p(e,t,n,i,r);return a.magFilter=e.NEAREST,a.minFilter=e.NEAREST,a.mipSamples=1,a.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,o,e.TEXTURE_2D,a.handle,0),a}function u(e,t,n,r,i){var o=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,o),e.renderbufferStorage(e.RENDERBUFFER,r,t,n),e.framebufferRenderbuffer(e.FRAMEBUFFER,i,e.RENDERBUFFER,o),o}function c(e){var t=r(e.gl),n=e.gl,o=e.handle=n.createFramebuffer(),c=e._shape[0],l=e._shape[1],f=e.color.length,d=e._ext,p=e._useStencil,h=e._useDepth,v=e._colorType;n.bindFramebuffer(n.FRAMEBUFFER,o);for(var m=0;m<f;++m)e.color[m]=s(n,c,l,v,n.RGBA,n.COLOR_ATTACHMENT0+m);0===f?(e._color_rb=u(n,c,l,n.RGBA4,n.COLOR_ATTACHMENT0),d&&d.drawBuffersWEBGL(y[0])):f>1&&d.drawBuffersWEBGL(y[f]);var g=n.getExtension("WEBGL_depth_texture");g?p?e.depth=s(n,c,l,g.UNSIGNED_INT_24_8_WEBGL,n.DEPTH_STENCIL,n.DEPTH_STENCIL_ATTACHMENT):h&&(e.depth=s(n,c,l,n.UNSIGNED_SHORT,n.DEPTH_COMPONENT,n.DEPTH_ATTACHMENT)):h&&p?e._depth_rb=u(n,c,l,n.DEPTH_STENCIL,n.DEPTH_STENCIL_ATTACHMENT):h?e._depth_rb=u(n,c,l,n.DEPTH_COMPONENT16,n.DEPTH_ATTACHMENT):p&&(e._depth_rb=u(n,c,l,n.STENCIL_INDEX,n.STENCIL_ATTACHMENT));var _=n.checkFramebufferStatus(n.FRAMEBUFFER);if(_!==n.FRAMEBUFFER_COMPLETE){e._destroyed=!0,n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteFramebuffer(e.handle),e.handle=null,e.depth&&(e.depth.dispose(),e.depth=null),e._depth_rb&&(n.deleteRenderbuffer(e._depth_rb),e._depth_rb=null);for(var m=0;m<e.color.length;++m)e.color[m].dispose(),e.color[m]=null;e._color_rb&&(n.deleteRenderbuffer(e._color_rb),e._color_rb=null),i(n,t),a(_)}i(n,t)}function l(e,t,n,r,i,o,a,s){this.gl=e,this._shape=[0|t,0|n],this._destroyed=!1,this._ext=s,this.color=new Array(i);for(var u=0;u<i;++u)this.color[u]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=r,this._useDepth=o,this._useStencil=a;var l=this,f=[0|t,0|n];Object.defineProperties(f,{0:{get:function(){return l._shape[0]},set:function(e){return l.width=e}},1:{get:function(){return l._shape[1]},set:function(e){return l.height=e}}}),this._shapeVector=f,c(this)}function f(e,t,n){if(e._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(e._shape[0]!==t||e._shape[1]!==n){var o=e.gl,s=o.getParameter(o.MAX_RENDERBUFFER_SIZE);if(t<0||t>s||n<0||n>s)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");e._shape[0]=t,e._shape[1]=n;for(var u=r(o),c=0;c<e.color.length;++c)e.color[c].shape=e._shape;e._color_rb&&(o.bindRenderbuffer(o.RENDERBUFFER,e._color_rb),o.renderbufferStorage(o.RENDERBUFFER,o.RGBA4,e._shape[0],e._shape[1])),e.depth&&(e.depth.shape=e._shape),e._depth_rb&&(o.bindRenderbuffer(o.RENDERBUFFER,e._depth_rb),e._useDepth&&e._useStencil?o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,e._shape[0],e._shape[1]):e._useDepth?o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,e._shape[0],e._shape[1]):e._useStencil&&o.renderbufferStorage(o.RENDERBUFFER,o.STENCIL_INDEX,e._shape[0],e._shape[1])),o.bindFramebuffer(o.FRAMEBUFFER,e.handle);var l=o.checkFramebufferStatus(o.FRAMEBUFFER);l!==o.FRAMEBUFFER_COMPLETE&&(e.dispose(),i(o,u),a(l)),i(o,u)}}function d(e,t,n,r){h||(h=e.FRAMEBUFFER_UNSUPPORTED,v=e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,m=e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,g=e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var i=e.getExtension("WEBGL_draw_buffers");if(!y&&i&&o(e,i),Array.isArray(t)&&(r=n,n=0|t[1],t=0|t[0]),"number"!=typeof t)throw new Error("gl-fbo: Missing shape parameter");var a=e.getParameter(e.MAX_RENDERBUFFER_SIZE);if(t<0||t>a||n<0||n>a)throw new Error("gl-fbo: Parameters are too large for FBO");r=r||{};var s=1;if("color"in r){if(s=Math.max(0|r.color,0),s<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(s>1){if(!i)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(s>e.getParameter(i.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+s+" draw buffers")}}var u=e.UNSIGNED_BYTE,c=e.getExtension("OES_texture_float");if(r.float&&s>0){if(!c)throw new Error("gl-fbo: Context does not support floating point textures");u=e.FLOAT}else r.preferFloat&&s>0&&c&&(u=e.FLOAT);var f=!0;"depth"in r&&(f=!!r.depth);var d=!1;return"stencil"in r&&(d=!!r.stencil),new l(e,t,n,u,s,f,d,i)}var p=n(96);e.exports=d;var h,v,m,g,y=null,_=l.prototype;Object.defineProperties(_,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(e){if(Array.isArray(e)||(e=[0|e,0|e]),2!==e.length)throw new Error("gl-fbo: Shape vector must be length 2");var t=0|e[0],n=0|e[1];return f(this,t,n),[t,n]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(e){return e|=0,f(this,e,this._shape[1]),e},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(e){return e|=0,f(this,this._shape[0],e),e},enumerable:!1}}),_.bind=function(){if(!this._destroyed){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.handle),e.viewport(0,0,this._shape[0],this._shape[1])}},_.dispose=function(){if(!this._destroyed){this._destroyed=!0;var e=this.gl;e.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(e.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var t=0;t<this.color.length;++t)this.color[t].dispose(),this.color[t]=null;this._color_rb&&(e.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},function(e,t,n){"use strict";function r(e){g=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST],y=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR],_=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}function i(e){return"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&e instanceof ImageData}function o(e,t,n){var r=e.gl,i=r.getParameter(r.MAX_TEXTURE_SIZE);if(t<0||t>i||n<0||n>i)throw new Error("gl-texture2d: Invalid texture size");return e._shape=[t,n],e.bind(),r.texImage2D(r.TEXTURE_2D,0,e.format,t,n,0,e.format,e.type,null),e._mipLevels=[0],e}function a(e,t,n,r,i,o){this.gl=e,this.handle=t,this.format=i,this.type=o,this._shape=[n,r],this._mipLevels=[0],this._magFilter=e.NEAREST,this._minFilter=e.NEAREST,this._wrapS=e.CLAMP_TO_EDGE,this._wrapT=e.CLAMP_TO_EDGE,this._anisoSamples=1;var a=this,s=[this._wrapS,this._wrapT];Object.defineProperties(s,[{get:function(){return a._wrapS},set:function(e){return a.wrapS=e}},{get:function(){return a._wrapT},set:function(e){return a.wrapT=e}}]),this._wrapVector=s;var u=[this._shape[0],this._shape[1]];Object.defineProperties(u,[{get:function(){return a._shape[0]},set:function(e){return a.width=e}},{get:function(){return a._shape[1]},set:function(e){return a.height=e}}]),this._shapeVector=u}function s(e,t){return 3===e.length?1===t[2]&&t[1]===e[0]*e[2]&&t[0]===e[2]:1===t[0]&&t[1]===e[0]}function u(e,t,n,r,i,o,a,u){var c=u.dtype,l=u.shape.slice();if(l.length<2||l.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var f=0,d=0,p=s(l,u.stride.slice());"float32"===c?f=e.FLOAT:"float64"===c?(f=e.FLOAT,p=!1,c="float32"):"uint8"===c?f=e.UNSIGNED_BYTE:(f=e.UNSIGNED_BYTE,p=!1,c="uint8");var g=1;if(2===l.length)d=e.LUMINANCE,l=[l[0],l[1],1],u=h(u.data,l,[u.stride[0],u.stride[1],1],u.offset);else{if(3!==l.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===l[2])d=e.ALPHA;else if(2===l[2])d=e.LUMINANCE_ALPHA;else if(3===l[2])d=e.RGB;else{if(4!==l[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");d=e.RGBA}g=l[2]}if(d!==e.LUMINANCE&&d!==e.ALPHA||i!==e.LUMINANCE&&i!==e.ALPHA||(d=i),d!==i)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var y=u.size,_=a.indexOf(r)<0;if(_&&a.push(r),f===o&&p)0===u.offset&&u.data.length===y?_?e.texImage2D(e.TEXTURE_2D,r,i,l[0],l[1],0,i,o,u.data):e.texSubImage2D(e.TEXTURE_2D,r,t,n,l[0],l[1],i,o,u.data):_?e.texImage2D(e.TEXTURE_2D,r,i,l[0],l[1],0,i,o,u.data.subarray(u.offset,u.offset+y)):e.texSubImage2D(e.TEXTURE_2D,r,t,n,l[0],l[1],i,o,u.data.subarray(u.offset,u.offset+y));else{var w;w=o===e.FLOAT?m.mallocFloat32(y):m.mallocUint8(y);var E=h(w,l,[l[2],l[2]*l[0],1]);f===e.FLOAT&&o===e.UNSIGNED_BYTE?b(E,u):v.assign(E,u),_?e.texImage2D(e.TEXTURE_2D,r,i,l[0],l[1],0,i,o,w.subarray(0,y)):e.texSubImage2D(e.TEXTURE_2D,r,t,n,l[0],l[1],i,o,w.subarray(0,y)),o===e.FLOAT?m.freeFloat32(w):m.freeUint8(w)}}function c(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}function l(e,t,n,r,i){var o=e.getParameter(e.MAX_TEXTURE_SIZE);if(t<0||t>o||n<0||n>o)throw new Error("gl-texture2d: Invalid texture shape");if(i===e.FLOAT&&!e.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var s=c(e);return e.texImage2D(e.TEXTURE_2D,0,r,t,n,0,r,i,null),new a(e,s,t,n,r,i)}function f(e,t,n,r,i,o){var s=c(e);return e.texImage2D(e.TEXTURE_2D,0,i,i,o,t),new a(e,s,n,r,i,o)}function d(e,t){var n=t.dtype,r=t.shape.slice(),i=e.getParameter(e.MAX_TEXTURE_SIZE);if(r[0]<0||r[0]>i||r[1]<0||r[1]>i)throw new Error("gl-texture2d: Invalid texture size");var o=s(r,t.stride.slice()),u=0;"float32"===n?u=e.FLOAT:"float64"===n?(u=e.FLOAT,o=!1,n="float32"):"uint8"===n?u=e.UNSIGNED_BYTE:(u=e.UNSIGNED_BYTE,o=!1,n="uint8");var l=0;if(2===r.length)l=e.LUMINANCE,r=[r[0],r[1],1],t=h(t.data,r,[t.stride[0],t.stride[1],1],t.offset);else{if(3!==r.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===r[2])l=e.ALPHA;else if(2===r[2])l=e.LUMINANCE_ALPHA;else if(3===r[2])l=e.RGB;else{if(4!==r[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");l=e.RGBA}}u!==e.FLOAT||e.getExtension("OES_texture_float")||(u=e.UNSIGNED_BYTE,o=!1);var f,d,p=t.size;if(o)f=0===t.offset&&t.data.length===p?t.data:t.data.subarray(t.offset,t.offset+p);else{var g=[r[2],r[2]*r[0],1];d=m.malloc(p,n);var y=h(d,r,g,0);"float32"!==n&&"float64"!==n||u!==e.UNSIGNED_BYTE?v.assign(y,t):b(y,t),f=d.subarray(0,p)}var _=c(e);return e.texImage2D(e.TEXTURE_2D,0,l,r[0],r[1],0,l,u,f),o||m.free(d),new a(e,_,r[0],r[1],l,u)}function p(e){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(g||r(e),"number"==typeof arguments[1])return l(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return l(e,0|arguments[1][0],0|arguments[1][1],arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var t=arguments[1],n=i(t)?t:t.raw;if(n)return f(e,n,0|t.width,0|t.height,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if(t.shape&&t.data&&t.stride)return d(e,t)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}var h=n(97),v=n(100),m=n(105);e.exports=p;var g=null,y=null,_=null,b=function(e,t){v.muls(e,t,255)},w=a.prototype;Object.defineProperties(w,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&g.indexOf(e)>=0&&(t.getExtension("OES_texture_float_linear")||(e=t.NEAREST)),y.indexOf(e)<0)throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&g.indexOf(e)>=0&&(t.getExtension("OES_texture_float_linear")||(e=t.NEAREST)),y.indexOf(e)<0)throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e),this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;if(this._anisoSamples=0|Math.max(e,1),t!==this._anisoSamples){var n=this.gl.getExtension("EXT_texture_filter_anisotropic");n&&this.gl.texParameterf(this.gl.TEXTURE_2D,n.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){if(this.bind(),_.indexOf(e)<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e),this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){if(this.bind(),_.indexOf(e)<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e),this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(Array.isArray(e)||(e=[e,e]),2!==e.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var t=0;t<2;++t)if(_.indexOf(e[t])<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);this._wrapS=e[0],this._wrapT=e[1];var n=this.gl;return this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,this._wrapS),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,this._wrapT),e}},shape:{get:function(){return this._shapeVector},set:function(e){if(Array.isArray(e)){if(2!==e.length)throw new Error("gl-texture2d: Invalid texture shape")}else e=[0|e,0|e];return o(this,0|e[0],0|e[1]),[0|e[0],0|e[1]]}},width:{get:function(){return this._shape[0]},set:function(e){return e|=0,o(this,e,this._shape[1]),e}},height:{get:function(){return this._shape[1]},set:function(e){return e|=0,o(this,this._shape[0],e),e}}}),w.bind=function(e){var t=this.gl;return void 0!==e&&t.activeTexture(t.TEXTURE0+(0|e)),t.bindTexture(t.TEXTURE_2D,this.handle),void 0!==e?0|e:t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0},w.dispose=function(){this.gl.deleteTexture(this.handle)},w.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var e=Math.min(this._shape[0],this._shape[1]),t=0;e>0;++t,e>>>=1)this._mipLevels.indexOf(t)<0&&this._mipLevels.push(t)},w.setPixels=function(e,t,n,r){var o=this.gl;this.bind(),Array.isArray(t)?(r=n,n=0|t[1],t=0|t[0]):(t=t||0,n=n||0),r=r||0;var a=i(e)?e:e.raw;if(a){var s=this._mipLevels.indexOf(r)<0;s?(o.texImage2D(o.TEXTURE_2D,0,this.format,this.format,this.type,a),this._mipLevels.push(r)):o.texSubImage2D(o.TEXTURE_2D,r,t,n,this.format,this.type,a)}else{if(!(e.shape&&e.stride&&e.data))throw new Error("gl-texture2d: Unsupported data type");if(e.shape.length<2||t+e.shape[1]>this._shape[1]>>>r||n+e.shape[0]>this._shape[0]>>>r||t<0||n<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");u(o,t,n,r,this.format,this.type,this._mipLevels,e)}}},function(e,t,n){function r(e,t){return e[0]-t[0]}function i(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(r);var i=new Array(n.length);for(e=0;e<i.length;++e)i[e]=n[e][1];return i}function o(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var r="generic"===e;if(t===-1){var o="function "+n+"(a){this.data=a;};\tvar proto="+n+".prototype;\tproto.dtype='"+e+"';\tproto.index=function(){return -1};\tproto.size=0;\tproto.dimension=-1;\tproto.shape=proto.stride=proto.order=[];\tproto.lo=proto.hi=proto.transpose=proto.step=\tfunction(){return new "+n+"(this.data);};\tproto.get=proto.set=function(){};\tproto.pick=function(){return null};\treturn function construct_"+n+"(a){return new "+n+"(a);}",a=new Function(o);return a()}if(0===t){var o="function "+n+"(a,d) {\tthis.data = a;\tthis.offset = d\t};\tvar proto="+n+".prototype;\tproto.dtype='"+e+"';\tproto.index=function(){return this.offset};\tproto.dimension=0;\tproto.size=1;\tproto.shape=\tproto.stride=\tproto.order=[];\tproto.lo=\tproto.hi=\tproto.transpose=\tproto.step=function "+n+"_copy() {\treturn new "+n+"(this.data,this.offset)\t};\tproto.pick=function "+n+"_pick(){\treturn TrivialArray(this.data);\t};\tproto.valueOf=proto.get=function "+n+"_get(){\treturn "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};\tproto.set=function "+n+"_set(v){\treturn "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"\t};\treturn function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",a=new Function("TrivialArray",o);return a(f[e][0])}var o=["'use strict'"],s=u(t),c=s.map(function(e){return"i"+e}),l="this.offset+"+s.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),d=s.map(function(e){return"b"+e}).join(","),p=s.map(function(e){return"c"+e}).join(",");o.push("function "+n+"(a,"+d+","+p+",d){this.data=a","this.shape=["+d+"]","this.stride=["+p+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){\treturn "+s.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+n+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);\tif(s0>s1){\tif(s1>s2){\treturn [2,1,0];\t}else if(s0>s2){\treturn [1,2,0];\t}else{\treturn [1,0,2];\t}\t}else if(s0>s2){\treturn [2,0,1];\t}else if(s2>s1){\treturn [0,1,2];\t}else{\treturn [0,2,1];\t}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),r?o.push("return this.data.set("+l+",v)}"):o.push("return this.data["+l+"]=v}"),o.push("proto.get=function "+n+"_get("+c.join(",")+"){"),r?o.push("return this.data.get("+l+")}"):o.push("return this.data["+l+"]}"),o.push("proto.index=function "+n+"_index(",c.join(),"){return "+l+"}"),o.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+s.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+s.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var h=s.map(function(e){return"a"+e+"=this.shape["+e+"]"}),v=s.map(function(e){return"c"+e+"=this.stride["+e+"]"});o.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+h.join(",")+","+v.join(","));for(var m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){\td=i"+m+"|0;\tb+=c"+m+"*d;\ta"+m+"-=d}");o.push("return new "+n+"(this.data,"+s.map(function(e){return"a"+e}).join(",")+","+s.map(function(e){return"c"+e}).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+s.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+s.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'){\td=i"+m+"|0;\tif(d<0){\tc+=b"+m+"*(a"+m+"-1);\ta"+m+"=ceil(-a"+m+"/d)\t}else{\ta"+m+"=ceil(a"+m+"/d)\t}\tb"+m+"*=d\t}");o.push("return new "+n+"(this.data,"+s.map(function(e){return"a"+e}).join(",")+","+s.map(function(e){return"b"+e}).join(",")+",c)}");for(var g=new Array(t),y=new Array(t),m=0;m<t;++m)g[m]="a[i"+m+"]",y[m]="b[i"+m+"]";o.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+g.join(",")+","+y.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(var m=0;m<t;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+s.map(function(e){return"shape["+e+"]"}).join(",")+","+s.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var a=new Function("CTOR_LIST","ORDER",o.join("\n"));return a(f[e],i)}function a(e){if(c(e))return"buffer";if(l)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}function s(e,t,n,r){if(void 0===e){var i=f.array[0];return i([])}"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var s=t.length;if(void 0===n){n=new Array(s);for(var u=s-1,c=1;u>=0;--u)n[u]=c,c*=t[u]}if(void 0===r){r=0;for(var u=0;u<s;++u)n[u]<0&&(r-=(t[u]-1)*n[u])}for(var l=a(e),d=f[l];d.length<=s+1;)d.push(o(l,d.length-1));var i=d[s+1];return i(e,t,n,r)}var u=n(98),c=n(99),l="undefined"!=typeof Float64Array,f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};e.exports=s},function(e,t){"use strict";function n(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}e.exports=n;
},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function r(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}/*!
	 * Determine if an object is a Buffer
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
e.exports=function(e){return null!=e&&(n(e)||r(e)||!!e._isBuffer)}},function(e,t,n){"use strict";function r(e){if(!e)return s;for(var t=0;t<e.args.length;++t){var n=e.args[t];0===t?e.args[t]={name:n,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:e.args[t]={name:n,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function i(e){return a({args:e.args,pre:r(e.pre),body:r(e.body),post:r(e.proc),funcName:e.funcName})}function o(e){for(var t=[],n=0;n<e.args.length;++n)t.push("a"+n);var r=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return r(i(e))}var a=n(101),s={body:"",args:[],thisVars:[],localVars:[]},u={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in u){var n=u[e];t[e]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:e}),t[e+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a"+n+"=b"},rvalue:!0,funcName:e+"eq"}),t[e+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:e+"s"}),t[e+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a"+n+"=s"},rvalue:!0,funcName:e+"seq"})}}();var c={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in c){var n=c[e];t[e]=o({args:["array","array"],body:{args:["a","b"],body:"a="+n+"b"},funcName:e}),t[e+"eq"]=o({args:["array"],body:{args:["a"],body:"a="+n+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in l){var n=l[e];t[e]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:e}),t[e+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:e+"s"}),t[e+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a=a"+n+"b"},rvalue:!0,count:2,funcName:e+"eq"}),t[e+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+n+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var f=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<f.length;++e){var n=f[e];t[n]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:n}),t[n+"eq"]=o({args:["array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"})}}();var d=["max","min","atan2","pow"];!function(){for(var e=0;e<d.length;++e){var n=d[e];t[n]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n}),t[n+"s"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n+"s"}),t[n+"eq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"}),t[n+"seq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"seq"})}}();var p=["atan2","pow"];!function(){for(var e=0;e<p.length;++e){var n=p[e];t[n+"op"]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"op"}),t[n+"ops"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"ops"}),t[n+"opeq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opeq"}),t[n+"opseq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opseq"})}}(),t.any=a({args:["array"],pre:s,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=a({args:["array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=a({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=a({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=a({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=a({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=o({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=o({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=o({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=a({args:["array","array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},function(e,t,n){"use strict";function r(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function i(e){var t=new r;t.pre=e.pre,t.body=e.body,t.post=e.post;var n=e.args.slice(0);t.argTypes=n;for(var i=0;i<n.length;++i){var a=n[i];if("array"===a||"object"==typeof a&&a.blockIndices){if(t.argTypes[i]="array",t.arrayArgs.push(i),t.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),t.shimArgs.push("array"+i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)t.scalarArgs.push(i),t.shimArgs.push("scalar"+i);else if("index"===a){if(t.indexArgs.push(i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(t.shapeArgs.push(i),i<t.pre.args.length&&t.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<t.post.args.length&&t.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof a||!a.offset)throw new Error("cwise: Unknown argument type "+n[i]);t.argTypes[i]="offset",t.offsetArgs.push({array:a.array,offset:a.offset}),t.offsetArgIndex.push(i)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,o(t)}var o=n(102);e.exports=i},function(e,t,n){"use strict";function r(e){var t=["'use strict'","var CACHED={}"],n=[],r=e.funcName+"_cwise_thunk";t.push(["return function ",r,"(",e.shimArgs.join(","),"){"].join(""));for(var o=[],a=[],s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],u=[],c=[],l=0;l<e.arrayArgs.length;++l){var f=e.arrayArgs[l];n.push(["t",f,"=array",f,".dtype,","r",f,"=array",f,".order"].join("")),o.push("t"+f),o.push("r"+f),a.push("t"+f),a.push("r"+f+".join()"),s.push("array"+f+".data"),s.push("array"+f+".stride"),s.push("array"+f+".offset|0"),l>0&&(u.push("array"+e.arrayArgs[0]+".shape.length===array"+f+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[l]))),c.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+f+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[l])+"]"))}e.arrayArgs.length>1&&(t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),t.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}"));for(var l=0;l<e.scalarArgs.length;++l)s.push("scalar"+e.scalarArgs[l]);n.push(["type=[",a.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------");var d=new Function("compile",t.join("\n"));return d(i.bind(void 0,e))}var i=n(103);e.exports=r},function(e,t,n){"use strict";function r(e,t,n){var r,i,o=e.length,a=t.arrayArgs.length,s=t.indexArgs.length>0,u=[],c=[],l=0,f=0;for(r=0;r<o;++r)c.push(["i",r,"=0"].join(""));for(i=0;i<a;++i)for(r=0;r<o;++r)f=l,l=e[r],0===r?c.push(["d",i,"s",r,"=t",i,"p",l].join("")):c.push(["d",i,"s",r,"=(t",i,"p",l,"-s",f,"*t",i,"p",f,")"].join(""));for(u.push("var "+c.join(",")),r=o-1;r>=0;--r)l=e[r],u.push(["for(i",r,"=0;i",r,"<s",l,";++i",r,"){"].join(""));for(u.push(n),r=0;r<o;++r){for(f=l,l=e[r],i=0;i<a;++i)u.push(["p",i,"+=d",i,"s",r].join(""));s&&(r>0&&u.push(["index[",f,"]-=s",f].join("")),u.push(["++index[",l,"]"].join(""))),u.push("}")}return u.join("\n")}function i(e,t,n,i){for(var o=t.length,a=n.arrayArgs.length,s=n.blockSize,u=n.indexArgs.length>0,c=[],l=0;l<a;++l)c.push(["var offset",l,"=p",l].join(""));for(var l=e;l<o;++l)c.push(["for(var j"+l+"=SS[",t[l],"]|0;j",l,">0;){"].join("")),c.push(["if(j",l,"<",s,"){"].join("")),c.push(["s",t[l],"=j",l].join("")),c.push(["j",l,"=0"].join("")),c.push(["}else{s",t[l],"=",s].join("")),c.push(["j",l,"-=",s,"}"].join("")),u&&c.push(["index[",t[l],"]=j",l].join(""));for(var l=0;l<a;++l){for(var f=["offset"+l],d=e;d<o;++d)f.push(["j",d,"*t",l,"p",t[d]].join(""));c.push(["p",l,"=(",f.join("+"),")"].join(""))}c.push(r(t,n,i));for(var l=e;l<o;++l)c.push("}");return c.join("\n")}function o(e){for(var t=0,n=e[0].length;t<n;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}function a(e,t,n){for(var r=e.body,i=[],o=[],a=0;a<e.args.length;++a){var s=e.args[a];if(!(s.count<=0)){var u=new RegExp(s.name,"g"),c="",l=t.arrayArgs.indexOf(a);switch(t.argTypes[a]){case"offset":var f=t.offsetArgIndex.indexOf(a),d=t.offsetArgs[f];l=d.array,c="+q"+f;case"array":c="p"+l+c;var p="l"+a,h="a"+l;if(0===t.arrayBlockIndices[l])1===s.count?"generic"===n[l]?s.lvalue?(i.push(["var ",p,"=",h,".get(",c,")"].join("")),r=r.replace(u,p),o.push([h,".set(",c,",",p,")"].join(""))):r=r.replace(u,[h,".get(",c,")"].join("")):r=r.replace(u,[h,"[",c,"]"].join("")):"generic"===n[l]?(i.push(["var ",p,"=",h,".get(",c,")"].join("")),r=r.replace(u,p),s.lvalue&&o.push([h,".set(",c,",",p,")"].join(""))):(i.push(["var ",p,"=",h,"[",c,"]"].join("")),r=r.replace(u,p),s.lvalue&&o.push([h,"[",c,"]=",p].join("")));else{for(var v=[s.name],m=[c],g=0;g<Math.abs(t.arrayBlockIndices[l]);g++)v.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(g+1)+"*t"+l+"b"+g);if(u=new RegExp(v.join(""),"g"),c=m.join("+"),"generic"===n[l])throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(u,[h,"[",c,"]"].join(""))}break;case"scalar":r=r.replace(u,"Y"+t.scalarArgs.indexOf(a));break;case"index":r=r.replace(u,"index");break;case"shape":r=r.replace(u,"shape")}}}return[i.join("\n"),r,o.join("\n")].join("\n").trim()}function s(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var i=e[r],o=i.match(/\d+/);o=o?o[0]:"",0===i.charAt(0)?t[r]="u"+i.charAt(1)+o:t[r]=i.charAt(0)+o,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}function u(e,t){for(var n=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,u=new Array(e.arrayArgs.length),l=new Array(e.arrayArgs.length),f=0;f<e.arrayArgs.length;++f)l[f]=t[2*f],u[f]=t[2*f+1];for(var d=[],p=[],h=[],v=[],m=[],f=0;f<e.arrayArgs.length;++f){e.arrayBlockIndices[f]<0?(h.push(0),v.push(n),d.push(n),p.push(n+e.arrayBlockIndices[f])):(h.push(e.arrayBlockIndices[f]),v.push(e.arrayBlockIndices[f]+n),d.push(0),p.push(e.arrayBlockIndices[f]));for(var g=[],y=0;y<u[f].length;y++)h[f]<=u[f][y]&&u[f][y]<v[f]&&g.push(u[f][y]-h[f]);m.push(g)}for(var _=["SS"],b=["'use strict'"],w=[],y=0;y<n;++y)w.push(["s",y,"=SS[",y,"]"].join(""));for(var f=0;f<e.arrayArgs.length;++f){_.push("a"+f),_.push("t"+f),_.push("p"+f);for(var y=0;y<n;++y)w.push(["t",f,"p",y,"=t",f,"[",h[f]+y,"]"].join(""));for(var y=0;y<Math.abs(e.arrayBlockIndices[f]);++y)w.push(["t",f,"b",y,"=t",f,"[",d[f]+y,"]"].join(""))}for(var f=0;f<e.scalarArgs.length;++f)_.push("Y"+f);if(e.shapeArgs.length>0&&w.push("shape=SS.slice(0)"),e.indexArgs.length>0){for(var E=new Array(n),f=0;f<n;++f)E[f]="0";w.push(["index=[",E.join(","),"]"].join(""))}for(var f=0;f<e.offsetArgs.length;++f){for(var A=e.offsetArgs[f],x=[],y=0;y<A.offset.length;++y)0!==A.offset[y]&&(1===A.offset[y]?x.push(["t",A.array,"p",y].join("")):x.push([A.offset[y],"*t",A.array,"p",y].join("")));0===x.length?w.push("q"+f+"=0"):w.push(["q",f,"=",x.join("+")].join(""))}var T=c([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));w=w.concat(T),b.push("var "+w.join(","));for(var f=0;f<e.arrayArgs.length;++f)b.push("p"+f+"|=0");e.pre.body.length>3&&b.push(a(e.pre,e,l));var S=a(e.body,e,l),M=o(m);M<n?b.push(i(M,m[0],e,S)):b.push(r(m[0],e,S)),e.post.body.length>3&&b.push(a(e.post,e,l)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+b.join("\n")+"\n----------");var R=[e.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",M,s(l)].join(""),C=new Function(["function ",R,"(",_.join(","),"){",b.join("\n"),"} return ",R].join(""));return C()}var c=n(104);e.exports=u},function(e,t){"use strict";function n(e,t){for(var n=1,r=e.length,i=e[0],o=e[0],a=1;a<r;++a)if(o=i,i=e[a],t(i,o)){if(a===n){n++;continue}e[n++]=i}return e.length=n,e}function r(e){for(var t=1,n=e.length,r=e[0],i=e[0],o=1;o<n;++o,i=r)if(i=r,r=e[o],r!==i){if(o===t){t++;continue}e[t++]=r}return e.length=t,e}function i(e,t,i){return 0===e.length?e:t?(i||e.sort(t),n(e,t)):(i||e.sort(),r(e))}e.exports=i},function(e,t,n){(function(e,r){"use strict";function i(e){if(e){var t=e.length||e.byteLength,n=y.log2(t);E[n].push(e)}}function o(e){i(e.buffer)}function a(e){var e=y.nextPow2(e),t=y.log2(e),n=E[t];return n.length>0?n.pop():new ArrayBuffer(e)}function s(e){return new Uint8Array(a(e),0,e)}function u(e){return new Uint16Array(a(2*e),0,e)}function c(e){return new Uint32Array(a(4*e),0,e)}function l(e){return new Int8Array(a(e),0,e)}function f(e){return new Int16Array(a(2*e),0,e)}function d(e){return new Int32Array(a(4*e),0,e)}function p(e){return new Float32Array(a(4*e),0,e)}function h(e){return new Float64Array(a(8*e),0,e)}function v(e){return b?new Uint8ClampedArray(a(e),0,e):s(e)}function m(e){return new DataView(a(e),0,e)}function g(e){e=y.nextPow2(e);var t=y.log2(e),n=A[t];return n.length>0?n.pop():new r(e)}var y=n(110),_=n(111);e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:_([32,0]),UINT16:_([32,0]),UINT32:_([32,0]),INT8:_([32,0]),INT16:_([32,0]),INT32:_([32,0]),FLOAT:_([32,0]),DOUBLE:_([32,0]),DATA:_([32,0]),UINT8C:_([32,0]),BUFFER:_([32,0])});var b="undefined"!=typeof Uint8ClampedArray,w=e.__TYPEDARRAY_POOL;w.UINT8C||(w.UINT8C=_([32,0])),w.BUFFER||(w.BUFFER=_([32,0]));var E=w.DATA,A=w.BUFFER;t.free=function(e){if(r.isBuffer(e))A[y.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|y.log2(t);E[n].push(e)}},t.freeUint8=t.freeUint16=t.freeUint32=t.freeInt8=t.freeInt16=t.freeInt32=t.freeFloat32=t.freeFloat=t.freeFloat64=t.freeDouble=t.freeUint8Clamped=t.freeDataView=o,t.freeArrayBuffer=i,t.freeBuffer=function(e){A[y.log2(e.length)].push(e)},t.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return a(e);switch(t){case"uint8":return s(e);case"uint16":return u(e);case"uint32":return c(e);case"int8":return l(e);case"int16":return f(e);case"int32":return d(e);case"float":case"float32":return p(e);case"double":case"float64":return h(e);case"uint8_clamped":return v(e);case"buffer":return g(e);case"data":case"dataview":return m(e);default:return null}return null},t.mallocArrayBuffer=a,t.mallocUint8=s,t.mallocUint16=u,t.mallocUint32=c,t.mallocInt8=l,t.mallocInt16=f,t.mallocInt32=d,t.mallocFloat32=t.mallocFloat=p,t.mallocFloat64=t.mallocDouble=h,t.mallocUint8Clamped=v,t.mallocDataView=m,t.mallocBuffer=g,t.clearCache=function(){for(var e=0;e<32;++e)w.UINT8[e].length=0,w.UINT16[e].length=0,w.UINT32[e].length=0,w.INT8[e].length=0,w.INT16[e].length=0,w.INT32[e].length=0,w.FLOAT[e].length=0,w.DOUBLE[e].length=0,w.UINT8C[e].length=0,E[e].length=0,A[e].length=0}}).call(t,function(){return this}(),n(106).Buffer)},function(e,t,n){(function(e,r){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function i(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}function o(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,n){if(o()<n)throw new RangeError("Invalid typed array length");return e.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n),t.__proto__=e.prototype):(null===t&&(t=new e(n)),t.length=n),t}function e(t,n,r){if(!(e.TYPED_ARRAY_SUPPORT||this instanceof e))return new e(t,n,r);if("number"==typeof t){if("string"==typeof n)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return s(this,t,n,r)}function s(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?p(e,t,n,r):"string"==typeof t?f(e,t,n):h(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t,n,r){return u(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}function l(t,n){if(u(n),t=a(t,n<0?0:0|v(n)),!e.TYPED_ARRAY_SUPPORT)for(var r=0;r<n;++r)t[r]=0;return t}function f(t,n,r){if("string"==typeof r&&""!==r||(r="utf8"),!e.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|g(n,r);t=a(t,i);var o=t.write(n,r);return o!==i&&(t=t.slice(0,o)),t}function d(e,t){var n=t.length<0?0:0|v(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(t,n,r,i){if(n.byteLength,r<0||n.byteLength<r)throw new RangeError("'offset' is out of bounds");if(n.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");return n=void 0===r&&void 0===i?new Uint8Array(n):void 0===i?new Uint8Array(n,r):new Uint8Array(n,r,i),e.TYPED_ARRAY_SUPPORT?(t=n,t.__proto__=e.prototype):t=d(t,n),t}function h(t,n){if(e.isBuffer(n)){var r=0|v(n.length);return t=a(t,r),0===t.length?t:(n.copy(t,0,0,r),t)}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||J(n.length)?a(t,0):d(t,n);if("Buffer"===n.type&&$(n.data))return d(t,n.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function v(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function m(t){return+t!=t&&(t=0),e.alloc(+t)}function g(t,n){if(e.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var i=!1;;)switch(n){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return X(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(t).length;default:if(i)return X(t).length;n=(""+n).toLowerCase(),i=!0}}function y(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return F(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return P(this,t,n);case"base64":return R(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function _(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(t,n,r,i,o){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof n&&(n=e.from(n,i)),e.isBuffer(n))return 0===n.length?-1:w(t,n,r,i,o);if("number"==typeof n)return n&=255,e.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,n,r):Uint8Array.prototype.lastIndexOf.call(t,n,r):w(t,[n],r,i,o);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,i){function o(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,s=e.length,u=t.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}var c;if(i){var l=-1;for(c=n;c<s;c++)if(o(e,c)===o(t,l===-1?0:c-l)){if(l===-1&&(l=c),c-l+1===u)return l*a}else l!==-1&&(c-=c-l),l=-1}else for(n+u>s&&(n=s-u),c=n;c>=0;c--){for(var f=!0,d=0;d<u;d++)if(o(e,c+d)!==o(t,d)){f=!1;break}if(f)return c}return-1}function E(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function A(e,t,n,r){return K(X(t,e.length-n),e,n,r)}function x(e,t,n,r){return K(q(t),e,n,r)}function T(e,t,n,r){return x(e,t,n,r)}function S(e,t,n,r){return K(W(t),e,n,r)}function M(e,t,n,r){return K(Y(t,e.length-n),e,n,r)}function R(e,t,n){return 0===t&&n===e.length?Z.fromByteArray(e):Z.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=n){var u,c,l,f;switch(s){case 1:o<128&&(a=o);break;case 2:u=e[i+1],128===(192&u)&&(f=(31&o)<<6|63&u,f>127&&(a=f));break;case 3:u=e[i+1],c=e[i+2],128===(192&u)&&128===(192&c)&&(f=(15&o)<<12|(63&u)<<6|63&c,f>2047&&(f<55296||f>57343)&&(a=f));break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128===(192&u)&&128===(192&c)&&128===(192&l)&&(f=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l,f>65535&&f<1114112&&(a=f))}}null===a?(a=65533,s=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),i+=s}return O(r)}function O(e){var t=e.length;if(t<=ee)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=ee));return n}function k(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function F(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=H(e[o]);return i}function I(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function D(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(t,n,r,i,o,a){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>o||n<a)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function N(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function j(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function U(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,i){return i||U(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(e,t,n,r,23,4),n+4}function V(e,t,n,r,i){return i||U(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(e,t,n,r,52,8),n+8}function z(e){if(e=G(e).replace(te,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function G(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function X(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=(i-55296<<10|n-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function q(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function Y(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function W(e){return Z.toByteArray(z(e))}function K(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function J(e){return e!==e}var Z=n(107),Q=n(108),$=n(109);t.Buffer=e,t.SlowBuffer=m,t.INSPECT_MAX_BYTES=50,e.TYPED_ARRAY_SUPPORT=void 0!==r.TYPED_ARRAY_SUPPORT?r.TYPED_ARRAY_SUPPORT:i(),t.kMaxLength=o(),e.poolSize=8192,e._augment=function(t){return t.__proto__=e.prototype,t},e.from=function(e,t,n){return s(null,e,t,n)},e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0})),e.alloc=function(e,t,n){return c(null,e,t,n)},e.allocUnsafe=function(e){return l(null,e)},e.allocUnsafeSlow=function(e){return l(null,e)},e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,n){if(!e.isBuffer(t)||!e.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var r=t.length,i=n.length,o=0,a=Math.min(r,i);o<a;++o)if(t[o]!==n[o]){r=t[o],i=n[o];break}return r<i?-1:i<r?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,n){if(!$(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var r;if(void 0===n)for(n=0,r=0;r<t.length;++r)n+=t[r].length;var i=e.allocUnsafe(n),o=0;for(r=0;r<t.length;++r){var a=t[r];if(!e.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},e.byteLength=g,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},e.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},e.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},e.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):y.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t,n,r,i,o){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),n<0||r>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&n>=r)return 0;if(i>=o)return-1;if(n>=r)return 1;if(n>>>=0,r>>>=0,i>>>=0,o>>>=0,this===t)return 0;for(var a=o-i,s=r-n,u=Math.min(a,s),c=this.slice(i,o),l=t.slice(n,r),f=0;f<u;++f)if(c[f]!==l[f]){a=c[f],s=l[f];break}return a<s?-1:s<a?1:0},e.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1},e.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},e.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},e.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return A(this,e,t,n);case"ascii":return x(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ee=4096;e.prototype.slice=function(t,n){var r=this.length;t=~~t,n=void 0===n?r:~~n,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),n<0?(n+=r,n<0&&(n=0)):n>r&&(n=r),n<t&&(n=t);var i;if(e.TYPED_ARRAY_SUPPORT)i=this.subarray(t,n),i.__proto__=e.prototype;else{var o=n-t;i=new e(o,void 0);for(var a=0;a<o;++a)i[a]=this[a+t]}return i},e.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},e.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},e.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},e.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},e.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},e.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),Q.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),Q.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),Q.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),Q.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){var i=Math.pow(2,8*n)-1;L(this,e,t,n,i,0)}var o=1,a=0;for(this[t]=255&e;++a<n&&(o*=256);)this[t+a]=e/o&255;return t+n},e.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){var i=Math.pow(2,8*n)-1;L(this,e,t,n,i,0)}var o=n-1,a=1;for(this[t+o]=255&e;--o>=0&&(a*=256);)this[t+o]=e/a&255;return t+n},e.prototype.writeUInt8=function(t,n,r){return t=+t,n|=0,r||L(this,t,n,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},e.prototype.writeUInt16LE=function(t,n,r){return t=+t,n|=0,r||L(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):N(this,t,n,!0),n+2},e.prototype.writeUInt16BE=function(t,n,r){return t=+t,n|=0,r||L(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):N(this,t,n,!1),n+2},e.prototype.writeUInt32LE=function(t,n,r){return t=+t,n|=0,r||L(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):j(this,t,n,!0),n+4},e.prototype.writeUInt32BE=function(t,n,r){return t=+t,n|=0,r||L(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):j(this,t,n,!1),n+4},e.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);L(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},e.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);L(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},e.prototype.writeInt8=function(t,n,r){return t=+t,n|=0,r||L(this,t,n,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},e.prototype.writeInt16LE=function(t,n,r){return t=+t,n|=0,r||L(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):N(this,t,n,!0),n+2},e.prototype.writeInt16BE=function(t,n,r){return t=+t,n|=0,r||L(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):N(this,t,n,!1),n+2},e.prototype.writeInt32LE=function(t,n,r){return t=+t,n|=0,r||L(this,t,n,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):j(this,t,n,!0),n+4},e.prototype.writeInt32BE=function(t,n,r){return t=+t,n|=0,r||L(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):j(this,t,n,!1),n+4},e.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},e.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},e.prototype.writeDoubleLE=function(e,t,n){return V(this,e,t,!0,n)},e.prototype.writeDoubleBE=function(e,t,n){return V(this,e,t,!1,n)},e.prototype.copy=function(t,n,r,i){if(r||(r=0),i||0===i||(i=this.length),n>=t.length&&(n=t.length),n||(n=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-n<i-r&&(i=t.length-n+r);var o,a=i-r;if(this===t&&r<n&&n<i)for(o=a-1;o>=0;--o)t[o+n]=this[o+r];else if(a<1e3||!e.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)t[o+n]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+a),n);return a},e.prototype.fill=function(t,n,r,i){if("string"==typeof t){if("string"==typeof n?(i=n,n=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!e.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(n<0||this.length<n||this.length<r)throw new RangeError("Out of range index");if(r<=n)return this;n>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0);var a;if("number"==typeof t)for(a=n;a<r;++a)this[a]=t;else{var s=e.isBuffer(t)?t:X(new e(t,i).toString()),u=s.length;for(a=0;a<r-n;++a)this[a+n]=s[a%u]}return this};var te=/[^+\/0-9A-Za-z-_]/g}).call(t,n(106).Buffer,function(){return this}())},function(e,t){"use strict";function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function r(e){return 3*e.length/4-n(e)}function i(e){var t,r,i,o,a,s,u=e.length;a=n(e),s=new l(3*u/4-a),i=a>0?u-4:u;var f=0;for(t=0,r=0;t<i;t+=4,r+=3)o=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],s[f++]=o>>16&255,s[f++]=o>>8&255,s[f++]=255&o;return 2===a?(o=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,s[f++]=255&o):1===a&&(o=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,s[f++]=o>>8&255,s[f++]=255&o),s}function o(e){return u[e>>18&63]+u[e>>12&63]+u[e>>6&63]+u[63&e]}function a(e,t,n){for(var r,i=[],a=t;a<n;a+=3)r=(e[a]<<16)+(e[a+1]<<8)+e[a+2],i.push(o(r));return i.join("")}function s(e){for(var t,n=e.length,r=n%3,i="",o=[],s=16383,c=0,l=n-r;c<l;c+=s)o.push(a(e,c,c+s>l?l:c+s));return 1===r?(t=e[n-1],i+=u[t>>2],i+=u[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],i+=u[t>>10],i+=u[t>>4&63],i+=u[t<<2&63],i+="="),o.push(i),o.join("")}t.byteLength=r,t.toByteArray=i,t.fromByteArray=s;for(var u=[],c=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,p=f.length;d<p;++d)u[d]=f[d],c[f.charCodeAt(d)]=d;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,d=n?-1:1,p=e[t+f];for(f+=d,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=d,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+f],f+=d,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:(p?-1:1)*(1/0);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,h=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),t+=a+f>=1?d/u:d*Math.pow(2,1-f),t*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=255&s,p+=h,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+p]=255&a,p+=h,a/=256,c-=8);e[n+p-h]|=128*v}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){"use strict";"use restrict";function n(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}var r=32;t.INT_BITS=r,t.INT_MAX=2147483647,t.INT_MIN=-1<<r-1,t.sign=function(e){return(e>0)-(e<0)},t.abs=function(e){var t=e>>r-1;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1||!e)},t.log2=function(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,t|=n,t|e>>1},t.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},t.popCount=function(e){return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24},t.countTrailingZeros=n,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,27030>>>e&1};var i=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,i=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--i;e[t]=r<<i&255}}(i),t.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},t.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},t.deinterleave2=function(e,t){return e=e>>>t&1431655765,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},t.interleave3=function(e,t,n){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,n&=1023,n=4278190335&(n|n<<16),n=251719695&(n|n<<8),n=3272356035&(n|n<<4),n=1227133513&(n|n<<2),e|n<<2},t.deinterleave3=function(e,t){return e=e>>>t&1227133513,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},t.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>n(e)+1}},function(e,t){"use strict";function n(e,t,r){var i=0|e[r];if(i<=0)return[];var o,a=new Array(i);if(r===e.length-1)for(o=0;o<i;++o)a[o]=t;else for(o=0;o<i;++o)a[o]=n(e,t,r+1);return a}function r(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}function i(e,t){switch("undefined"==typeof t&&(t=0),typeof e){case"number":if(e>0)return r(0|e,t);break;case"object":if("number"==typeof e.length)return n(e,t,0)}return[]}e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Particles=t.defaults=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(113),c=r(u),l=n(56),f=r(l),d=n(95),p=r(d),h=n(97),v=r(h),m=n(126),g=r(m),y=n(127),_=n(128),b=r(_),w=n(130),E=r(w),A=t.defaults=function(){return{shape:[64,64],geomShape:null,logic:null,logicVert:E.default,logicFrag:null,render:null,renderVert:null,renderFrag:null}},x=t.Particles=function(){function e(t,n){o(this,e);var r=a({},A(),n);this.gl=t,this.screen=new b.default(this.gl),this.shape=r.shape,this.geomShape=r.geomShape||[].concat(i(this.shape));var s=r.logic||[r.logicVert,r.logicFrag];this.logic=Array.isArray(s)?f.default.apply(void 0,[t].concat(i(s))):s;var u=r.render||[r.renderVert,r.renderFrag];this.render=Array.isArray(u)?f.default.apply(void 0,[t].concat(i(u))):u,this.geom=(0,c.default)(t),this.geom.attr("uv",e.generateLUT(this.geomShape),{size:2}),this.buffers=[],this.pixels=(0,v.default)(new Float32Array(this.shape[0]*this.shape[1]*4),[this.shape[0],this.shape[1],4])}return s(e,[{key:"setup",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.buffers.length<e;)this.buffers.push((0,p.default)(this.gl,[this.shape[0],this.shape[1]],{float:!0}));for(;this.buffers.length>e;)this.buffers.pop().dispose()}},{key:"spawn",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pixels,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],r=new Float32Array(4),i=t.shape,o=t.data,a=0,s=0;s<i[0];++s)for(var u=0;u<i[1];++u)r[0]=r[1]=r[2]=r[3]=0,e(r,s,u),o[a++]=r[0],o[a++]=r[1],o[a++]=r[2],o[a++]=r[3];this.buffers.forEach(function(e){return e.color[0].setPixels(t,n)})}},{key:"step",value:function(t,n){n?n.bind():((0,y.step)(this.buffers),this.buffers[0].bind()),this.gl.viewport(0,0,this.shape[0],this.shape[1]),this.logic.bind(),e.applyUpdate(Object.assign(this.logic.uniforms,{dataRes:this.shape,geomRes:this.geomShape,particles:this.buffers[1].color[0].bind(0)}),t),this.screen.render(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}},{key:"draw",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.gl.POINTS;this.geom.bind(this.render),e.applyUpdate(Object.assign(this.render.uniforms,{dataRes:this.shape,geomRes:this.geomShape,particles:this.buffers[0].color[0].bind(0)}),t),this.geom.draw(n)}},{key:"updateLogic",value:function(e){this.logic.update(E.default,e)}},{key:"updateRender",value:function(e,t){this.render.update(t,e)}},{key:"dispose",value:function(){}}],[{key:"generateLUT",value:function(e){for(var t=e[0]*e[1]*2,n=new Float32Array(t),r=0,i=Math.max(e[0],2),o=Math.max(e[1],2),a=1/(i-1),s=1/(o-1),u=0;u<i;++u)for(var c=0;c<o;++c)n[r++]=u*a,n[r++]=c*s;return n}},{key:"applyUpdate",value:function(e,t){return(0,g.default)(t)?t(e):Object.assign(e,t)}}]),e}();t.default=x},function(e,t,n){function r(e){return this instanceof r?(this._elementsType=5123,this._elementsBytes=2,this._attributes=[],this._dirty=!0,this._attrLength=0,this._facesLength=0,this._index=null,this._vao=null,this._keys=[],void(this.gl=e)):new r(e)}var i=n(114),o=n(121),a=n(122),s=n(120);e.exports=r,r.prototype.dispose=function(){for(var e=0;e<this._attributes.length;e++)this._attributes[e].buffer.dispose();this._attributes=[],this._keys=[],this._attrLength=0,this._facesLength=0,this._dirty=!0,this._index&&(this._index.dispose(),this._index=null),this._vao&&(this._vao.dispose(),this._vao=null)},r.prototype.faces=function(e,t){var n=t&&t.size||3;return e=e.cells?e.cells:e,this._dirty=!0,this._index&&this._index.dispose(),this._index=i.create(this.gl,e,n,this.gl.ELEMENT_ARRAY_BUFFER,"uint16"),this._facesLength=this._index.length*n,this._index=this._index.buffer,this},r.prototype.attr=function(e,t,n){if(t.cells&&t.positions)return this.attr(e,t.positions).faces(t.cells,n);n=n||{};var r=n.size||3,o=this._keys.indexOf(e);if(o>-1){var a=this._attributes[o].buffer,s=n.offset||void 0;return i.update(a,t,r,"float32",s),this._attrLength=a.length/r/4,this}this._dirty=!0;var u=this.gl,c=!this._attributes.length,l=i.create(u,t,r,u.ARRAY_BUFFER,"float32");if(!l)throw new Error("Unexpected attribute format: needs an ndarray, array, typed array, gl-buffer or simplicial complex");var f=l.buffer,d=l.length;return this._keys.push(e),this._attributes.push({size:r,buffer:f}),c&&(this._attrLength=d),this},r.prototype.bind=function(e){if(this.update(),this._vao.bind(),this._keys&&e){for(var t=0;t<this._keys.length;t++){var n=e.attributes[this._keys[t]];n&&(n.location=t)}e.bind()}},r.prototype.draw=function(e,t,n){t="undefined"==typeof t?0:t,e="undefined"==typeof e?this.gl.TRIANGLES:e,this.update(),this._vao._useElements?(n="undefined"==typeof n?this._facesLength:n,this.gl.drawElements(e,n-t,this._elementsType,t*this._elementsBytes)):(n="undefined"==typeof n?this._attrLength:n,this.gl.drawArrays(e,t,n-t))},r.prototype.unbind=function(){this.update(),this._vao.unbind()},r.prototype.update=function(){this._dirty&&(this._dirty=!1,this._vao&&this._vao.dispose(),this._vao=a(this.gl,this._attributes,this._index),this._elementsType=this._vao._elementsType,this._elementsBytes=s(o(this._elementsType)||"array").BYTES_PER_ELEMENT||2)}},function(e,t,n){function r(e,t,n,r,i){if(t.handle instanceof WebGLBuffer)return{buffer:t,length:t.length/n/4};var a=o(t,n,i);return{buffer:l(e,a.data,r),length:a.length}}function i(e,t,n,r,i){if(t.handle instanceof WebGLBuffer)throw new Error("Unhandled update case: WebGLBuffer");var a=o(t,n,r);e.update(a.data,i)}function o(e,t,n){return Array.isArray(e)&&Array.isArray(e[0])?{data:u(e,n),length:e.length}:Array.isArray(e)&&c(e[0])?{data:u(e,n),length:e.length*e[0].length/t}:Array.isArray(e)?{data:new(d(n))(e),length:e.length/t}:f(e)?{data:e,length:a(e.shape)/t}:c(e)?(!n||e instanceof d(n)||(e=s(e,d(n))),{data:e,length:e.length/t}):void 0}function a(e){for(var t=1,n=0;n<e.length;n++)t*=e[n];return t}function s(e,t){for(var n=new t(e.length),r=0;r<e.length;r++)n[r]=e[r];return n}var u=n(115),c=n(117),l=n(118),f=n(119),d=n(120);e.exports.create=r,e.exports.update=i},function(e,t,n){function r(e,t){if(t=t||"float32",!e[0]||!e[0].length)return e;for(var n="string"==typeof t?i(t):t,r=e[0].length,o=new n(e.length*r),a=0,s=0;s<e.length;s++)for(var u=0;u<r;u++)o[a++]=e[s][u];return o}var i=n(116);e.exports=r},function(e,t,n){(function(t){e.exports=function(e){
switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray;case"generic":case"data":case"dataview":return ArrayBuffer;case"buffer":return"undefined"==typeof t?ArrayBuffer:t}}}).call(t,n(106).Buffer)},function(e,t){function n(e){return r(e)||i(e)}function r(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function i(e){return a[o.call(e)]}e.exports=n,n.strict=r,n.loose=i;var o=Object.prototype.toString,a={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0}},function(e,t,n){"use strict";function r(e,t,n,r,i){this.gl=e,this.type=t,this.handle=n,this.length=r,this.usage=i}function i(e,t,n,r,i,o){var a=i.length*i.BYTES_PER_ELEMENT;if(o<0)return e.bufferData(t,i,r),a;if(a+o>n)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return e.bufferSubData(t,o,i),n}function o(e,t){for(var n=u.malloc(e.length,t),r=e.length,i=0;i<r;++i)n[i]=e[i];return n}function a(e,t){for(var n=1,r=t.length-1;r>=0;--r){if(t[r]!==n)return!1;n*=e[r]}return!0}function s(e,t,n,i){if(n=n||e.ARRAY_BUFFER,i=i||e.DYNAMIC_DRAW,n!==e.ARRAY_BUFFER&&n!==e.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(i!==e.DYNAMIC_DRAW&&i!==e.STATIC_DRAW&&i!==e.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var o=e.createBuffer(),a=new r(e,n,o,0,i);return a.update(t),a}var u=n(105),c=n(100),l=n(97),f=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"],d=r.prototype;d.bind=function(){this.gl.bindBuffer(this.type,this.handle)},d.unbind=function(){this.gl.bindBuffer(this.type,null)},d.dispose=function(){this.gl.deleteBuffer(this.handle)},d.update=function(e,t){if("number"!=typeof t&&(t=-1),this.bind(),"object"==typeof e&&"undefined"!=typeof e.shape){var n=e.dtype;if(f.indexOf(n)<0&&(n="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var r=gl.getExtension("OES_element_index_uint");n=r&&"uint16"!==n?"uint32":"uint16"}if(n===e.dtype&&a(e.shape,e.stride))0===e.offset&&e.data.length===e.shape[0]?this.length=i(this.gl,this.type,this.length,this.usage,e.data,t):this.length=i(this.gl,this.type,this.length,this.usage,e.data.subarray(e.offset,e.shape[0]),t);else{var s=u.malloc(e.size,n),d=l(s,e.shape);c.assign(d,e),t<0?this.length=i(this.gl,this.type,this.length,this.usage,s,t):this.length=i(this.gl,this.type,this.length,this.usage,s.subarray(0,e.size),t),u.free(s)}}else if(Array.isArray(e)){var p;p=this.type===this.gl.ELEMENT_ARRAY_BUFFER?o(e,"uint16"):o(e,"float32"),t<0?this.length=i(this.gl,this.type,this.length,this.usage,p,t):this.length=i(this.gl,this.type,this.length,this.usage,p.subarray(0,e.length),t),u.free(p)}else if("object"==typeof e&&"number"==typeof e.length)this.length=i(this.gl,this.type,this.length,this.usage,e,t);else{if("number"!=typeof e&&void 0!==e)throw new Error("gl-buffer: Invalid data type");if(t>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");e|=0,e<=0&&(e=1),this.gl.bufferData(this.type,0|e,this.usage),this.length=e}},e.exports=s},function(e,t){e.exports=function(e){if(!e)return!1;if(!e.dtype)return!1;var t=new RegExp("function View[0-9]+d(:?"+e.dtype+")+");return t.test(String(e.constructor))}},function(e,t){e.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array}}},function(e,t){function n(e){switch(e){case 5126:return"float32";case 5125:return"uint32";case 5124:return"int32";case 5123:return"uint16";case 32819:return"uint16";case 32820:return"uint16";case 33635:return"uint16";case 5122:return"int16";case 5121:return"uint8";case 5120:return"int8";default:return null}}e.exports=n},function(e,t,n){"use strict";function r(e){this.bindVertexArrayOES=e.bindVertexArray.bind(e),this.createVertexArrayOES=e.createVertexArray.bind(e),this.deleteVertexArrayOES=e.deleteVertexArray.bind(e)}function i(e,t,n,i){var s,u=e.createVertexArray?new r(e):e.getExtension("OES_vertex_array_object");return s=u?o(e,u):a(e),s.update(t,n,i),s}var o=n(123),a=n(125);e.exports=i},function(e,t,n){"use strict";function r(e,t,n,r,i,o){this.location=e,this.dimension=t,this.a=n,this.b=r,this.c=i,this.d=o}function i(e,t,n){this.gl=e,this._ext=t,this.handle=n,this._attribs=[],this._useElements=!1,this._elementsType=e.UNSIGNED_SHORT}function o(e,t){return new i(e,t,t.createVertexArrayOES())}var a=n(124);r.prototype.bind=function(e){switch(this.dimension){case 1:e.vertexAttrib1f(this.location,this.a);break;case 2:e.vertexAttrib2f(this.location,this.a,this.b);break;case 3:e.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:e.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},i.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var e=0;e<this._attribs.length;++e)this._attribs[e].bind(this.gl)},i.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},i.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},i.prototype.update=function(e,t,n){if(this.bind(),a(this.gl,t,e),this.unbind(),this._attribs.length=0,e)for(var i=0;i<e.length;++i){var o=e[i];"number"==typeof o?this._attribs.push(new r(i,1,o)):Array.isArray(o)&&this._attribs.push(new r(i,o.length,o[0],o[1],o[2],o[3]))}this._useElements=!!t,this._elementsType=n||this.gl.UNSIGNED_SHORT},i.prototype.draw=function(e,t,n){n=n||0;var r=this.gl;this._useElements?r.drawElements(e,t,this._elementsType,n):r.drawArrays(e,n,t)},e.exports=o},function(e,t){"use strict";function n(e,t,n){t?t.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var r=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(n){if(n.length>r)throw new Error("gl-vao: Too many vertex attributes");for(var i=0;i<n.length;++i){var o=n[i];if(o.buffer){var a=o.buffer,s=o.size||4,u=o.type||e.FLOAT,c=!!o.normalized,l=o.stride||0,f=o.offset||0;a.bind(),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,s,u,c,l,f)}else{if("number"==typeof o)e.vertexAttrib1f(i,o);else if(1===o.length)e.vertexAttrib1f(i,o[0]);else if(2===o.length)e.vertexAttrib2f(i,o[0],o[1]);else if(3===o.length)e.vertexAttrib3f(i,o[0],o[1],o[2]);else{if(4!==o.length)throw new Error("gl-vao: Invalid vertex attribute");e.vertexAttrib4f(i,o[0],o[1],o[2],o[3])}e.disableVertexAttribArray(i)}}for(;i<r;++i)e.disableVertexAttribArray(i)}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var i=0;i<r;++i)e.disableVertexAttribArray(i)}}e.exports=n},function(e,t,n){"use strict";function r(e){this.gl=e,this._elements=null,this._attributes=null,this._elementsType=e.UNSIGNED_SHORT}function i(e){return new r(e)}var o=n(124);r.prototype.bind=function(){o(this.gl,this._elements,this._attributes)},r.prototype.update=function(e,t,n){this._elements=t,this._attributes=e,this._elementsType=n||this.gl.UNSIGNED_SHORT},r.prototype.dispose=function(){},r.prototype.unbind=function(){},r.prototype.draw=function(e,t,n){n=n||0;var r=this.gl;this._elements?r.drawElements(e,t,this._elementsType,n):r.drawArrays(e,n,t)},e.exports=i},function(e,t,n){function r(e){if(!o(e))return!1;var t=i(e);return t==s||t==u||t==a||t==c}var i=n(40),o=n(34),a="[object AsyncFunction]",s="[object Function]",u="[object GeneratorFunction]",c="[object Proxy]";e.exports=r},function(e,t){"use strict";function n(e){var t=Array.prototype.pop.call(e);return Array.prototype.unshift.call(e,t),t}Object.defineProperty(t,"__esModule",{value:!0}),t.step=n;var r=(t.wrapIndex=function(e,t){return t[(t.length+Math.round(e))%t.length]},1/Math.log(2));t.nextPow2=function(e){return Math.pow(2,Math.ceil(Math.log(e)*r))}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Screen=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},c=n(129),l=r(c),f=t.Screen=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bind",this).call(this),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unbind",this).call(this)}}]),t}(l.default);t.default=f},function(e,t,n){function r(e){return this instanceof r?(this.gl=e,void(this.vao=o(e,[{size:2,type:e.FLOAT,buffer:i(e,new Float32Array([-1,-1,-1,4,4,-1]))}]))):new r(e)}var i=n(118),o=n(122);e.exports=r,r.prototype.bind=function(){this.vao.bind()},r.prototype.draw=function(){this.gl.drawArrays(this.gl.TRIANGLES,0,3)},r.prototype.unbind=function(){this.vao.unbind()}},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nvoid main() {\n    gl_Position = vec4(position, 1.0, 1.0);\n}\n"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(132),o=r(i);t.default=function(e){return e[0]=e[1]=o.default,e[2]=e[3]=0,e}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=-1e6},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.coverAspect=t.containAspect=t.aspect=void 0;var i=n(53),o=r(i),a=t.aspect=function(e,t,n){return o.default.scale(e,o.default.inverse(e,t),n)};t.containAspect=function(e,t){return a(e,t,Math.min(t[0],t[1]))},t.coverAspect=function(e,t){return a(e,t,Math.max(t[0],t[1]))};t.default=a},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D particles;\nuniform sampler2D flow;\nuniform sampler2D targets;\n\nuniform vec2 dataRes;\n\nuniform vec2 viewSize;\n\nuniform float time;\nuniform float dt;\n\nuniform float speedLimit;\nuniform float damping;\n\nuniform float forceWeight;\nuniform float flowWeight;\nuniform float noiseWeight;\n\nuniform float flowDecay;\n\nuniform float noiseSpeed;\nuniform float noiseScale;\n\nuniform float target;\n\n// These are scaled by the values they correspond to\nuniform float varyForce;\nuniform float varyFlow;\nuniform float varyNoise;\nuniform float varyNoiseScale;\nuniform float varyNoiseSpeed;\nuniform float varyTarget;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nconst vec2 inert = vec2(-1000000.0);\n\n/**\n * @requires {float} levels The number of samples to take at different LODs\n * @requires {float} stride The step up to take between each LOD\n */\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec4 posRange = vec4(-1.0, -1.0, 1.0, 1.0);\n\nconst vec4 uvRange = vec4(0.0, 0.0, 1.0, 1.0);\n\nvec2 posToUV(vec2 pos) {\n    return map(pos, posRange.xy, posRange.zw, uvRange.xy, uvRange.zw);\n}\n\n// Time/decay\n\nvec2 get(vec3 data, float time, float decay) {\n    return data.xy*max(0.0, 1.0-((time-data.z)*decay));\n}\n\nvec2 get(vec4 data, float time, float decay) {\n    return get(data.xyz, time, decay);\n}\n\n// No time/decay\n\nvec2 get(vec2 data) {\n    return data.xy;\n}\n\nvec2 get(vec3 data) {\n    return get(data.xy);\n}\n\nvec2 get(vec4 data) {\n    return get(data.xy);\n}\n\n/**\n * @return The flow velocity and age for a given screen position, sampling\n *         several scales.\n */\nvec2 flowAtScreenPos(vec2 pos, sampler2D flow, float time, float flowDecay) {\n    vec2 uv = posToUV(pos);\n    vec2 flowForce = vec2(0.0);\n    float flowMax = 0.0;\n\n    for(float level = 0.0; level < 1.0*1.0; level += 1.0) {\n        vec4 flowData = texture2D(flow, uv, level);\n        float factor = 1.0/(level+1.0);\n\n        flowForce += get(flowData, time, flowDecay)*factor;\n        flowMax += factor;\n    }\n\n    return flowForce/flowMax;\n}\n\nfloat vary(float base, float offset, float variance) {\n    return base+(offset*variance*base);\n}\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy/dataRes;\n\n    vec4 state = texture2D(particles, uv);\n    vec2 pos = state.xy;\n    vec2 vel = state.zw;\n\n    vec2 newPos = pos;\n    vec2 newVel = vel;\n\n    if(pos != inert) {\n        // The 1D index offset of this pixel\n        float i = (gl_FragCoord.x+(gl_FragCoord.y*dataRes.x))/\n                (dataRes.x*dataRes.y);\n\n        // Wander force\n\n        vec2 noisePos = pos*vary(noiseScale, i, varyNoiseScale);\n\n        // @todo This doesn't progress linearly - the speed grows with time...\n        float noiseTime = time*vary(noiseSpeed, i, varyNoiseSpeed);\n\n        vec2 wanderForce = vec2(snoise(vec3(noisePos, uv.x+noiseTime)),\n                snoise(vec3(noisePos, uv.y+noiseTime+1234.5678)));\n\n        // Flow force - left by preceeding particles\n        // (Ensure this is checked before the next flow step is rendered, to avoid\n        // self-influence.)\n\n        vec2 flowForce = flowAtScreenPos(pos*viewSize, flow, time, flowDecay);\n\n        // Accumulate weighted forces and damping\n        newVel = (vel*damping*dt)+\n            (vary(forceWeight, i, varyForce)*\n                ((flowForce*dt*vary(flowWeight, i, varyFlow))+\n                (wanderForce*dt*vary(noiseWeight, i, varyNoise))));\n\n        // Tend towards targets\n        newVel += (texture2D(targets, uv).xy-pos)*vary(target, i, varyTarget);\n        \n        // Normalize and clamp the velocity\n        /**\n         * @todo This seems to cause some problems when dealing with larger max\n         *       speeds - the particles no longer follow flow forces somehow...\n         */\n        float speed = length(newVel);\n\n        newVel *= min(speed, speedLimit)/speed;\n\n        // Integrate motion\n        newPos = pos+newVel;\n    }\n\n    gl_FragColor = vec4(newPos, newVel);\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D previous;\nuniform sampler2D particles;\n\nuniform vec2 dataRes;\nuniform vec2 geomRes;\n\nuniform vec2 viewSize;\n\nuniform sampler2D colorMap;\nuniform float colorMapAlpha;\n\nuniform vec4 flowColor;\nuniform vec4 baseColor;\n\nuniform float time;\nuniform float speedLimit;\nuniform float flowDecay;\n\nuniform float speedAlpha;\n\nattribute vec2 uv;\n\nvarying vec4 color;\n\n/**\n * Pre-generated constants, equivalent to:\n *     flowAxisR: `angleToVec(0)`\n *     flowAxisG: `angleToVec(tau/3.0)`\n *     flowAxisB: `angleToVec(tau*2.0/3.0)`\n */\nconst vec2 flowAxisR = vec2(1.0, 0.0);\nconst vec2 flowAxisG = vec2(-0.5000000000000004, -0.8660254037844385);\nconst vec2 flowAxisB = vec2(-0.4999999999999998, 0.8660254037844387);\n\nconst vec4 minColor = vec4(0.0);\nconst vec4 maxColor = vec4(1.0);\n\nconst vec4 minAlign = vec4(-1.0);\nconst vec4 maxAlign = vec4(1.0);\n\n// @todo Turn some of these `const`s into `uniform`s\nconst vec2 center = vec2(0.0);\nconst vec2 fadeRange = vec2(0.2, 1.0);\nconst vec3 falloff = vec3(fadeRange.x, fadeRange.y, fadeRange.y);\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec2 inert = vec2(-1000000.0);\n\nfloat length2(vec2 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec3 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec4 vec) {\n    return dot(vec, vec);\n}\n\n/**\n * Adapted from `bezier`.\n */\n\nfloat bezier(vec2 cp, float t) {\n    return cp.x+(cp.y-cp.x)*t;\n}\n\nfloat bezier(vec3 cp, float t) {\n    float ut = 1.0-t;\n\n    return (cp.x*ut+cp.y*t)*ut+(cp.y*ut+cp.z*t)*t;\n}\n\nfloat bezier(vec4 cp, float t) {\n    float ut = 1.0-t;\n    float a1 = cp.y*ut+cp.z*t;\n\n    return ((cp.x*ut+cp.y*t)*ut+a1*t)*ut+(a1*ut+(cp.z*ut+cp.w*t)*t)*t;\n}\n\n// @todo Remove the `1.0-` here?\nfloat amount(vec2 point, vec2 mid, float limit) {\n    return min(1.0-(length(point-mid)/limit), 1.0);\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit) {\n    return max(0.0, amount(point, mid, limit));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, float curve) {\n    return max(0.0, curve*amount(point, mid, limit));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec2 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec3 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec4 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nvec4 preAlpha(vec3 color, float alpha) {\n    return vec4(color.rgb*alpha, alpha);\n}\n\nvec4 preAlpha(vec4 color) {\n    return preAlpha(color.rgb, color.a);\n}\n\nconst float frameOffset = 0.25;\n\n/**\n * For every data point, we have two vertices - current and previous state.\n * Every other vertex looks up previous data. In this way, (vertical)\n * neighbours alternate from previous to current state.\n * (Vertical neighbours, because WebGL iterates column-major.)\n *\n * @return State data for the vertex, either current or previous.\n */\n\nvec4 stateAtFrame(vec2 uv, vec2 shape, sampler2D previous, sampler2D current) {\n    float nearIndex = uv.y*shape.y;\n    float offset = fract(nearIndex);\n    vec2 lookup = vec2(uv.x, floor(nearIndex)/shape.y);\n\n    // @note Some systems comlain about this form of texture lookup:\n    // return texture2D(((offset > frameOffset)? current : previous), lookup);\n    return ((offset > frameOffset)?\n            texture2D(current, lookup)\n        :   texture2D(previous, lookup));\n}\n\nvoid main() {\n    vec4 state = stateAtFrame(uv, dataRes, previous, particles);\n\n    if(state.xy != inert) {\n        vec2 pos = state.xy;\n        vec2 vel = state.zw/speedLimit;\n        float speedRate = min(length2(vel)/speedAlpha, 1.0);\n\n        // Color map\n\n        vec4 mappedColor = texture2D(colorMap, uv*geomRes/dataRes);\n\n        mappedColor *= colorMapAlpha;\n\n        // Flow color\n        \n        vec3 alignRGB = vec3(dot(vel, flowAxisR),\n                dot(vel, flowAxisG), dot(vel, flowAxisB));\n\n        vec3 flowAlign = map(mix(alignRGB, alignRGB.gbr*(1.0-flowDecay),\n                    sin(time*flowDecay)),\n                minAlign.rgb, maxAlign.rgb, minColor.rgb, maxColor.rgb);\n\n        vec4 flowAlignedColor = vec4(flowColor.rgb*flowAlign, flowColor.a);\n\n        // Color summation, clamping and pre-multiplying alpha so they don't\n        // cross over\n\n        color = clamp(preAlpha(baseColor), minColor, maxColor)+\n            clamp(preAlpha(mappedColor), minColor, maxColor)+\n            clamp(preAlpha(flowAlignedColor), minColor, maxColor);\n\n        color.a *= speedRate*clamp(vignette(pos, center, 1.0, falloff),\n                        fadeRange.x, fadeRange.y);\n\n        // Position\n        gl_Position = vec4(pos*viewSize, 0.0, 1.0);\n    }\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 color;\n\nvoid main() {\n    gl_FragColor = color;\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D previous;\nuniform sampler2D data;\n\nuniform vec2 dataRes;\n\nuniform vec2 viewSize;\n\nuniform float time;\nuniform float speedLimit;\nuniform float flowDecay;\n\nattribute vec2 uv;\n\nvarying vec4 color;\n\n/**\n * @requires {float} time The current time in ms\n */\n\nvec4 flow(vec2 vel) {\n    // Faster particles leave a greater influence (opacity).\n    // Linear interpolation - inaccurate for vectors, will it be OK without\n    // sudden turns, or do we need a per-fragment lookup?\n    return vec4(vel, time, length(vel));\n}\n\nvec4 flow(vec2 vel, float speedLimit) {\n    vec4 values = flow(vel);\n\n    return vec4(values.xyz, min(values.a/speedLimit, 1.0));\n}\n\n/**\n * @requires `./head.vert`\n * @requires {function} apply A function applying a `vec4` state into a `vec3`\n *                            color to be drawn.\n */\n\nconst vec2 inert = vec2(-1000000.0);\n\nconst float frameOffset = 0.25;\n\n/**\n * For every data point, we have two vertices - current and previous state.\n * Every other vertex looks up previous data. In this way, (vertical)\n * neighbours alternate from previous to current state.\n * (Vertical neighbours, because WebGL iterates column-major.)\n *\n * @return State data for the vertex, either current or previous.\n */\n\nvec4 stateAtFrame(vec2 uv, vec2 shape, sampler2D previous, sampler2D current) {\n    float nearIndex = uv.y*shape.y;\n    float offset = fract(nearIndex);\n    vec2 lookup = vec2(uv.x, floor(nearIndex)/shape.y);\n\n    // @note Some systems comlain about this form of texture lookup:\n    // return texture2D(((offset > frameOffset)? current : previous), lookup);\n    return ((offset > frameOffset)?\n            texture2D(current, lookup)\n        :   texture2D(previous, lookup));\n}\n\nvoid main() {\n    vec4 state = stateAtFrame(uv, dataRes, previous, data);\n\n    if(state.xy != inert) {\n        gl_Position = vec4(state.xy*viewSize, 1.0, 1.0);\n        color = flow(state.zw, speedLimit);\n    }\n}\n\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 color;\n\nvoid main() {\n    // @todo SDF from line, to weaken force further away\n    gl_FragColor = color.rgba;\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n    gl_FragColor = color.rgba;\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D view;\nuniform vec2 viewRes;\n\n// #pragma glslify: fxaa = require(glsl-fxaa)\n\nvoid main() {\n    gl_FragColor = texture2D(view, gl_FragCoord.xy/viewRes);\n    // gl_FragColor = fxaa(view, gl_FragCoord.xy, viewRes);\n}\n"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.PixelSpawner=t.defaults=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(95),u=r(s),c=n(56),l=r(c),f=n(51),d=r(f),p=n(53),h=r(p),v=n(133),m=r(v),g=n(130),y=r(g),_=n(142),b=r(_),w=t.defaults=function(){return{shader:[y.default,b.default],buffer:[[1,1],{float:!0}],spawnSize:[1,1],jitterRad:2,speed:1,bias:1}},E=t.PixelSpawner=function(){function e(t,n){o(this,e),this.gl=t;var r=Object.assign(w(),n);this.shader=Array.isArray(r.shader)?l.default.apply(void 0,[this.gl].concat(i(r.shader))):r.shader,this.buffer=Array.isArray(r.buffer)?u.default.apply(void 0,[this.gl].concat(i(r.buffer))):r.buffer,this.speed=r.speed,this.bias=r.bias,this.jitterRad=r.jitterRad,this.jitter=h.default.create(),this.spawnSize=r.spawnSize,this.spawnMatrix=d.default.create()}return a(e,[{key:"update",value:function(e){return Object.assign(e,{spawnData:this.buffer.color[0].bind(1),spawnSize:this.spawnSize,spawnMatrix:this.spawnMatrix,speed:this.speed,jitter:(0,m.default)(this.jitter,e.viewRes,this.jitterRad),bias:this.bias})}},{key:"spawn",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.update.bind(this),n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return e.spawnShader.apply(e,[this.shader,t].concat(r))}},{key:"setPixels",value:function(e){return this.buffer.color[0].setPixels(e)}}]),e}();t.default=E},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D particles;\nuniform sampler2D spawnData;\n\nuniform vec2 dataRes;\nuniform vec2 geomRes;\nuniform vec2 spawnSize;\n\nuniform vec2 jitter;\nuniform float time;\nuniform float speed;\n\nuniform mat3 spawnMatrix;\n\n/**\n * @todo Some bug with `glslify-import` & sons breaks `node_modules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec4 uvRange = vec4(0.0, 0.0, 1.0, 1.0);\n\nconst vec4 posRange = vec4(-1.0, -1.0, 1.0, 1.0);\n\nvec2 uvToPos(vec2 uv) {\n    return map(uv, uvRange.xy, uvRange.zw, posRange.xy, posRange.zw);\n}\n\nfloat transform(mat2 m, float v) {\n    return (m*vec2(v, 1.0)).x;\n}\n\nvec2 transform(mat3 m, vec2 v) {\n    return (m*vec3(v, 1.0)).xy;\n}\n\nvec3 transform(mat4 m, vec3 v) {\n    return (m*vec4(v, 1.0)).xyz;\n}\n\nconst vec2 flipUV = vec2(1.0, -1.0);\n\nvec2 spawnToPos(vec2 uv) {\n    // Jittering around a UV cell to get rid of boxy scaled sampling artefacts\n    vec2 offset = vec2(mix(-jitter.x, jitter.x, random(uv-1.2345+(time*0.001))),\n            mix(-jitter.y, jitter.y, random(uv+1.2345+(time*0.001))));\n\n    return transform(spawnMatrix, uvToPos(uv+offset)*flipUV*spawnSize);\n}\n\n// `import`-able convenience for setting up a vignette - should be replaced with\n// a proper `uniform`-ed version.\n\nconst vec3 curve = vec3(0.1, 1.0, 1.0);\nconst vec2 mid = vec2(0.5);\nconst float limit = 0.6;\n\n// #pragma glslify: vignette = require(../../filter/pass/vignette, curve = curve, mid = mid, limit = limit)\n\n/**\n * Directly uses a normal image - brightness being speed in a direction defined\n * by the `rgba` channels.\n *\n * @requires {float} time The current time\n */\n\nconst vec4 k = vec4(0.0, -1.0/3.0, 2.0/3.0, -1.0);\nconst float e = 1.0e-10;\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 p = ((c.g < c.b)? vec4(c.bg, k.wz) : vec4(c.gb, k.xy));\n    vec4 q = ((c.r < p.x)? vec4(p.xyw, c.r) : vec4(c.r, p.yzx));\n\n    float d = q.x-min(q.w, q.y);\n\n    return vec3(abs(q.z+(q.w-q.y)/(6.0*d+e)), d/(q.x+e), q.x);\n}\n\nconst float tau = 6.28318530717958647692;\n\nvec2 angleToVec(float rad) {\n    return vec2(cos(rad), sin(rad));\n}\n\nvec4 apply(vec2 uv, vec2 pos, vec4 pixel) {\n    vec3 hsv = rgb2hsv(pixel.rgb);\n\n    return vec4(pos, angleToVec((hsv.r+(time*0.00003))*tau)*hsv.g*hsv.b*pixel.a);\n}\n\n// #pragma glslify: applier = require(./apply/brightest)\n/**\n * @requires {vec2} mid The center of the vignette\n * @requires {float} limit The radius of the vignette\n * @requires {(float|vec2|vec3|vec4)} curve Bezier curve points, shaping falloff\n */\n\n/**\n * Adapted from `bezier`.\n */\n\nfloat bezier(vec2 cp, float t) {\n    return cp.x+(cp.y-cp.x)*t;\n}\n\nfloat bezier(vec3 cp, float t) {\n    float ut = 1.0-t;\n\n    return (cp.x*ut+cp.y*t)*ut+(cp.y*ut+cp.z*t)*t;\n}\n\nfloat bezier(vec4 cp, float t) {\n    float ut = 1.0-t;\n    float a1 = cp.y*ut+cp.z*t;\n\n    return ((cp.x*ut+cp.y*t)*ut+a1*t)*ut+(a1*ut+(cp.z*ut+cp.w*t)*t)*t;\n}\n\n// @todo Remove the `1.0-` here?\nfloat amount(vec2 point, vec2 mid, float limit) {\n    return min(1.0-(length(point-mid)/limit), 1.0);\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit) {\n    return max(0.0, amount(point, mid, limit));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, float curve) {\n    return max(0.0, curve*amount(point, mid, limit));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec2 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec3 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec4 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nvec4 pass(vec2 uv, vec4 pixel) {\n    return pixel*vignette(uv, mid, limit, curve);\n}\n\n/**\n * A way to easily compose filter passes on the pixel before applying it.\n *\n * @see `../../../filter/`\n * @see `./`\n * @requires {function} pass The filter pass function, given the pixel.\n * @requires {function} apply The apply function, given the result of `pass`.\n */\n\nvec4 compose(vec2 uv, vec2 pos, vec4 pixel) {\n    return apply(uv, pos, pass(uv, pixel));\n}\n\n// #pragma glslify: apply = require(./apply/color, time = time)\n// #pragma glslify: apply = require(./apply/brightest)\n\n/**\n * Directly spawns a particle according to its euivalent position/values in the\n * given texture.\n *\n * @requires {function} apply A function that transforms a `vec4` of data into a\n *                            valid `vec4` state.\n */\n\nvoid main() {\n    /**\n     * @todo I have no idea why this seems to be required here and not in the\n     *       main logic shader... seems to do with the data/geometry size ratio.\n     */\n    // vec2 uv = gl_FragCoord.xy/dataRes;\n    vec2 uv = (gl_FragCoord.xy/dataRes)*(geomRes/dataRes);\n\n    vec4 state = compose(uv, spawnToPos(uv), texture2D(spawnData, uv));\n\n    gl_FragColor = vec4(state.xy, state.zw*speed);\n}\n\n";
},function(e,t){e.exports="/**\n * Tries a number of times to randomly select a pixel scored highest by a given\n * function.\n */\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D particles;\nuniform sampler2D spawnData;\n\nuniform vec2 dataRes;\nuniform vec2 geomRes;\nuniform vec2 spawnSize;\n\nuniform vec2 jitter;\nuniform float time;\nuniform float speed;\n\nuniform mat3 spawnMatrix;\n\n/**\n * @todo Some bug with `glslify-import` & sons breaks `node_modules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec4 uvRange = vec4(0.0, 0.0, 1.0, 1.0);\n\nconst vec4 posRange = vec4(-1.0, -1.0, 1.0, 1.0);\n\nvec2 uvToPos(vec2 uv) {\n    return map(uv, uvRange.xy, uvRange.zw, posRange.xy, posRange.zw);\n}\n\nfloat transform(mat2 m, float v) {\n    return (m*vec2(v, 1.0)).x;\n}\n\nvec2 transform(mat3 m, vec2 v) {\n    return (m*vec3(v, 1.0)).xy;\n}\n\nvec3 transform(mat4 m, vec3 v) {\n    return (m*vec4(v, 1.0)).xyz;\n}\n\nconst vec2 flipUV = vec2(1.0, -1.0);\n\nvec2 spawnToPos(vec2 uv) {\n    // Jittering around a UV cell to get rid of boxy scaled sampling artefacts\n    vec2 offset = vec2(mix(-jitter.x, jitter.x, random(uv-1.2345+(time*0.001))),\n            mix(-jitter.y, jitter.y, random(uv+1.2345+(time*0.001))));\n\n    return transform(spawnMatrix, uvToPos(uv+offset)*flipUV*spawnSize);\n}\n\n// `import`-able convenience for setting up a vignette - should be replaced with\n// a proper `uniform`-ed version.\n\nconst vec3 curve = vec3(0.1, 1.0, 1.0);\nconst vec2 mid = vec2(0.5);\nconst float limit = 0.6;\n\n// #pragma glslify: vignette = require(../../filter/pass/vignette, curve = curve, mid = mid, limit = limit)\n\n/**\n * Directly uses a normal image - brightness being speed in a direction defined\n * by the `rgba` channels.\n *\n * @requires {float} time The current time\n */\n\nconst vec4 k = vec4(0.0, -1.0/3.0, 2.0/3.0, -1.0);\nconst float e = 1.0e-10;\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 p = ((c.g < c.b)? vec4(c.bg, k.wz) : vec4(c.gb, k.xy));\n    vec4 q = ((c.r < p.x)? vec4(p.xyw, c.r) : vec4(c.r, p.yzx));\n\n    float d = q.x-min(q.w, q.y);\n\n    return vec3(abs(q.z+(q.w-q.y)/(6.0*d+e)), d/(q.x+e), q.x);\n}\n\nconst float tau = 6.28318530717958647692;\n\nvec2 angleToVec(float rad) {\n    return vec2(cos(rad), sin(rad));\n}\n\nvec4 apply(vec2 uv, vec2 pos, vec4 pixel) {\n    vec3 hsv = rgb2hsv(pixel.rgb);\n\n    return vec4(pos, angleToVec((hsv.r+(time*0.00003))*tau)*hsv.g*hsv.b*pixel.a);\n}\n\n// #pragma glslify: applier = require(./apply/brightest)\n/**\n * @requires {vec2} mid The center of the vignette\n * @requires {float} limit The radius of the vignette\n * @requires {(float|vec2|vec3|vec4)} curve Bezier curve points, shaping falloff\n */\n\n/**\n * Adapted from `bezier`.\n */\n\nfloat bezier(vec2 cp, float t) {\n    return cp.x+(cp.y-cp.x)*t;\n}\n\nfloat bezier(vec3 cp, float t) {\n    float ut = 1.0-t;\n\n    return (cp.x*ut+cp.y*t)*ut+(cp.y*ut+cp.z*t)*t;\n}\n\nfloat bezier(vec4 cp, float t) {\n    float ut = 1.0-t;\n    float a1 = cp.y*ut+cp.z*t;\n\n    return ((cp.x*ut+cp.y*t)*ut+a1*t)*ut+(a1*ut+(cp.z*ut+cp.w*t)*t)*t;\n}\n\n// @todo Remove the `1.0-` here?\nfloat amount(vec2 point, vec2 mid, float limit) {\n    return min(1.0-(length(point-mid)/limit), 1.0);\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit) {\n    return max(0.0, amount(point, mid, limit));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, float curve) {\n    return max(0.0, curve*amount(point, mid, limit));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec2 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec3 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec4 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nvec4 pass(vec2 uv, vec4 pixel) {\n    return pixel*vignette(uv, mid, limit, curve);\n}\n\n/**\n * A way to easily compose filter passes on the pixel before applying it.\n *\n * @see `../../../filter/`\n * @see `./`\n * @requires {function} pass The filter pass function, given the pixel.\n * @requires {function} apply The apply function, given the result of `pass`.\n */\n\nvec4 compose(vec2 uv, vec2 pos, vec4 pixel) {\n    return apply(uv, pos, pass(uv, pixel));\n}\n\n// #pragma glslify: apply = require(./apply/color, time = time)\n// #pragma glslify: apply = require(./apply/brightest)\n\n/**\n * Pick the Highest velocity.\n * Uses the same data structure as the particles.\n */\n\nfloat length2(vec2 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec3 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec4 vec) {\n    return dot(vec, vec);\n}\n\nfloat test(vec4 data) {\n    return length2(data.zw);\n}\n\nconst float samples = 6.0;\n\n/**\n * Tries a number of times to randomly select a pixel scored highest by a given\n * function.\n *\n * @requires {function} apply A function that transforms a `vec4` of data into a\n *                            valid `vec4` state.\n * @requires {function} test A function that returns a float value for a given\n *                           `vec4` state; greater values win the comparison.\n */\n\n// Over 1 favours changing to new data; under 1 favours current data.\nuniform float bias;\n\n/**\n * @todo Some bug with `glslify-import` & sons breaks `node_modules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\n\nvec4 pick(vec4 current, vec4 next) {\n    return ((test(current) > bias*test(next))? current : next);\n}\n\nvoid main() {\n    /**\n     * @todo This was needed in `./direct-main.frag` - is it needed here too?\n     */\n    vec2 uv = gl_FragCoord.xy/dataRes;\n    // vec2 uv = (gl_FragCoord.xy/dataRes)*(geomRes/dataRes);\n    \n    vec4 state = texture2D(particles, uv);\n\n    vec4 baseSeed = state+vec4(uv, uv)+vec4(1.2345+(time*0.001));\n\n    for(float n = 0.0; n < samples; n += 1.0) {\n        vec4 seed = baseSeed+vec4(n);\n        vec2 spawnUV = mod(vec2(random(seed.xy), random(seed.zw)), 1.0);\n        vec4 other = compose(spawnUV, spawnToPos(spawnUV),\n                texture2D(spawnData, spawnUV));\n\n        state = pick(state, vec4(other.xy, other.zw*speed));\n    }\n\n    gl_FragColor = state;\n}\n\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D particles;\nuniform sampler2D spawnData;\n\nuniform vec2 dataRes;\nuniform vec2 geomRes;\nuniform vec2 spawnSize;\n\nuniform vec2 jitter;\nuniform float time;\nuniform float speed;\n\nuniform mat3 spawnMatrix;\n\n/**\n * @todo Some bug with `glslify-import` & sons breaks `node_modules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec4 uvRange = vec4(0.0, 0.0, 1.0, 1.0);\n\nconst vec4 posRange = vec4(-1.0, -1.0, 1.0, 1.0);\n\nvec2 uvToPos(vec2 uv) {\n    return map(uv, uvRange.xy, uvRange.zw, posRange.xy, posRange.zw);\n}\n\nfloat transform(mat2 m, float v) {\n    return (m*vec2(v, 1.0)).x;\n}\n\nvec2 transform(mat3 m, vec2 v) {\n    return (m*vec3(v, 1.0)).xy;\n}\n\nvec3 transform(mat4 m, vec3 v) {\n    return (m*vec4(v, 1.0)).xyz;\n}\n\nconst vec2 flipUV = vec2(1.0, -1.0);\n\nvec2 spawnToPos(vec2 uv) {\n    // Jittering around a UV cell to get rid of boxy scaled sampling artefacts\n    vec2 offset = vec2(mix(-jitter.x, jitter.x, random(uv-1.2345+(time*0.001))),\n            mix(-jitter.y, jitter.y, random(uv+1.2345+(time*0.001))));\n\n    return transform(spawnMatrix, uvToPos(uv+offset)*flipUV*spawnSize);\n}\n\nuniform float flowDecay;\n\n/**\n * Use the pixel position, and the particle velocity.\n * Same data structure as the flow.\n *\n * @requires {float} time The current time\n * @requires {float} decay The rate of decay of the flow over time\n */\n\n// Time/decay\n\nvec2 get(vec3 data, float time, float decay) {\n    return data.xy*max(0.0, 1.0-((time-data.z)*decay));\n}\n\nvec2 get(vec4 data, float time, float decay) {\n    return get(data.xyz, time, decay);\n}\n\n// No time/decay\n\nvec2 get(vec2 data) {\n    return data.xy;\n}\n\nvec2 get(vec3 data) {\n    return get(data.xy);\n}\n\nvec2 get(vec4 data) {\n    return get(data.xy);\n}\n\nvec4 apply(vec2 uv, vec2 pos, vec4 pixel) {\n    return vec4(pos, get(pixel, time, flowDecay));\n}\n\n/**\n * Pick the Highest velocity.\n * Uses the same data structure as the particles.\n */\n\nfloat length2(vec2 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec3 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec4 vec) {\n    return dot(vec, vec);\n}\n\nfloat test(vec4 data) {\n    return length2(data.zw);\n}\n\nconst float samples = 5.0;\n\n/**\n * Tries a number of times to randomly select a pixel scored highest by a given\n * function.\n *\n * @requires {function} apply A function that transforms a `vec4` of data into a\n *                            valid `vec4` state.\n * @requires {function} test A function that returns a float value for a given\n *                           `vec4` state; greater values win the comparison.\n */\n\n// Over 1 favours changing to new data; under 1 favours current data.\nuniform float bias;\n\n/**\n * @todo Some bug with `glslify-import` & sons breaks `node_modules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\n\nvec4 pick(vec4 current, vec4 next) {\n    return ((test(current) > bias*test(next))? current : next);\n}\n\nvoid main() {\n    /**\n     * @todo This was needed in `./direct-main.frag` - is it needed here too?\n     */\n    vec2 uv = gl_FragCoord.xy/dataRes;\n    // vec2 uv = (gl_FragCoord.xy/dataRes)*(geomRes/dataRes);\n    \n    vec4 state = texture2D(particles, uv);\n\n    vec4 baseSeed = state+vec4(uv, uv)+vec4(1.2345+(time*0.001));\n\n    for(float n = 0.0; n < samples; n += 1.0) {\n        vec4 seed = baseSeed+vec4(n);\n        vec2 spawnUV = mod(vec2(random(seed.xy), random(seed.zw)), 1.0);\n        vec4 other = apply(spawnUV, spawnToPos(spawnUV),\n                texture2D(spawnData, spawnUV));\n\n        state = pick(state, vec4(other.xy, other.zw*speed));\n    }\n\n    gl_FragColor = state;\n}\n\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D particles;\nuniform sampler2D spawnData;\n\nuniform vec2 dataRes;\nuniform vec2 geomRes;\nuniform vec2 spawnSize;\n\nuniform vec2 jitter;\nuniform float time;\nuniform float speed;\n\nuniform mat3 spawnMatrix;\n\n/**\n * @todo Some bug with `glslify-import` & sons breaks `node_modules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec4 uvRange = vec4(0.0, 0.0, 1.0, 1.0);\n\nconst vec4 posRange = vec4(-1.0, -1.0, 1.0, 1.0);\n\nvec2 uvToPos(vec2 uv) {\n    return map(uv, uvRange.xy, uvRange.zw, posRange.xy, posRange.zw);\n}\n\nfloat transform(mat2 m, float v) {\n    return (m*vec2(v, 1.0)).x;\n}\n\nvec2 transform(mat3 m, vec2 v) {\n    return (m*vec3(v, 1.0)).xy;\n}\n\nvec3 transform(mat4 m, vec3 v) {\n    return (m*vec4(v, 1.0)).xyz;\n}\n\nconst vec2 flipUV = vec2(1.0, -1.0);\n\nvec2 spawnToPos(vec2 uv) {\n    // Jittering around a UV cell to get rid of boxy scaled sampling artefacts\n    vec2 offset = vec2(mix(-jitter.x, jitter.x, random(uv-1.2345+(time*0.001))),\n            mix(-jitter.y, jitter.y, random(uv+1.2345+(time*0.001))));\n\n    return transform(spawnMatrix, uvToPos(uv+offset)*flipUV*spawnSize);\n}\n\n// `import`-able convenience for setting up a vignette - should be replaced with\n// a proper `uniform`-ed version.\n\nconst vec3 curve = vec3(0.1, 1.0, 1.0);\nconst vec2 mid = vec2(0.5);\nconst float limit = 0.6;\n\n// #pragma glslify: vignette = require(../../filter/pass/vignette, curve = curve, mid = mid, limit = limit)\n\n/**\n * Identity\n */\nvec4 apply(vec2 uv, vec2 pos, vec4 pixel) {\n    return pixel;\n}\n\n/**\n * @requires {vec2} mid The center of the vignette\n * @requires {float} limit The radius of the vignette\n * @requires {(float|vec2|vec3|vec4)} curve Bezier curve points, shaping falloff\n */\n\n/**\n * Adapted from `bezier`.\n */\n\nfloat bezier(vec2 cp, float t) {\n    return cp.x+(cp.y-cp.x)*t;\n}\n\nfloat bezier(vec3 cp, float t) {\n    float ut = 1.0-t;\n\n    return (cp.x*ut+cp.y*t)*ut+(cp.y*ut+cp.z*t)*t;\n}\n\nfloat bezier(vec4 cp, float t) {\n    float ut = 1.0-t;\n    float a1 = cp.y*ut+cp.z*t;\n\n    return ((cp.x*ut+cp.y*t)*ut+a1*t)*ut+(a1*ut+(cp.z*ut+cp.w*t)*t)*t;\n}\n\n// @todo Remove the `1.0-` here?\nfloat amount(vec2 point, vec2 mid, float limit) {\n    return min(1.0-(length(point-mid)/limit), 1.0);\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit) {\n    return max(0.0, amount(point, mid, limit));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, float curve) {\n    return max(0.0, curve*amount(point, mid, limit));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec2 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec3 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec4 curve) {\n    return max(0.0, bezier(curve, amount(point, mid, limit)));\n}\n\nvec4 pass(vec2 uv, vec4 pixel) {\n    return pixel*vignette(uv, mid, limit, curve);\n}\n\n/**\n * A way to easily compose filter passes on the pixel before applying it.\n *\n * @see `../../../filter/`\n * @see `./`\n * @requires {function} pass The filter pass function, given the pixel.\n * @requires {function} apply The apply function, given the result of `pass`.\n */\n\nvec4 compose(vec2 uv, vec2 pos, vec4 pixel) {\n    return apply(uv, pos, pass(uv, pixel));\n}\n\n/**\n * Pick the Highest velocity.\n * Uses the same data structure as the particles.\n */\n\nfloat length2(vec2 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec3 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec4 vec) {\n    return dot(vec, vec);\n}\n\nfloat test(vec4 data) {\n    return length2(data.zw);\n}\n\nconst float samples = 2.0;\n\n/**\n * Tries a number of times to randomly select a pixel scored highest by a given\n * function.\n *\n * @requires {function} apply A function that transforms a `vec4` of data into a\n *                            valid `vec4` state.\n * @requires {function} test A function that returns a float value for a given\n *                           `vec4` state; greater values win the comparison.\n */\n\n// Over 1 favours changing to new data; under 1 favours current data.\nuniform float bias;\n\n/**\n * @todo Some bug with `glslify-import` & sons breaks `node_modules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\n\nvec4 pick(vec4 current, vec4 next) {\n    return ((test(current) > bias*test(next))? current : next);\n}\n\nvoid main() {\n    /**\n     * @todo This was needed in `./direct-main.frag` - is it needed here too?\n     */\n    vec2 uv = gl_FragCoord.xy/dataRes;\n    // vec2 uv = (gl_FragCoord.xy/dataRes)*(geomRes/dataRes);\n    \n    vec4 state = texture2D(particles, uv);\n\n    vec4 baseSeed = state+vec4(uv, uv)+vec4(1.2345+(time*0.001));\n\n    for(float n = 0.0; n < samples; n += 1.0) {\n        vec4 seed = baseSeed+vec4(n);\n        vec2 spawnUV = mod(vec2(random(seed.xy), random(seed.zw)), 1.0);\n        vec4 other = compose(spawnUV, spawnToPos(spawnUV),\n                texture2D(spawnData, spawnUV));\n\n        state = pick(state, vec4(other.xy, other.zw*speed));\n    }\n\n    gl_FragColor = state;\n}\n\n"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.spawnBall=t.defaults=void 0;var o=n(147),a=i(o),s=n(149),u=r(s),c=t.defaults=function(){return{shader:[a.defaults().shader[0],u.default],uniforms:{radius:1,speed:0}}},l=c(),f=t.spawnBall=function(e,t){return a.spawner(e,Object.assign(l,t))};t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.spawner=t.defaults=void 0;var o=n(56),a=r(o),s=n(130),u=r(s),c=n(148),l=r(c),f=t.defaults=function(){return{shader:[u.default,l.default],uniforms:null}},d=t.spawner=function(e,t){var n=Object.assign(f(),t);return{gl:e,uniforms:n.uniforms,shader:Array.isArray(n.shader)?a.default.apply(void 0,[e].concat(i(n.shader))):n.shader,spawn:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.spawnShader.apply(e,[this.shader,this.uniforms].concat(n))}}};t.default=d},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nconst vec2 inert = vec2(-1000000.0);\n\nconst vec2 pos = vec2(inert);\nconst vec2 vel = vec2(0.0);\n\nvoid main() {\n    gl_FragColor = vec4(pos, vel);\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform float radius;\nuniform float speed;\n\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nvec2 angleToVec(float rad) {\n    return vec2(cos(rad), sin(rad));\n}\n\nconst float tau = 6.28318530717958647692;\n\nvoid main() {\n    vec4 randoms = vec4(random((gl_FragCoord.xy*1.7654)+2.3675),\n        random((gl_FragCoord.xy*1.23494)+0.36434),\n        random((gl_FragCoord.xy*0.327789)+3.498787),\n        random((gl_FragCoord.xy*9.0374)+0.2773));\n\n    gl_FragColor = vec4(angleToVec(randoms.x*tau)*randoms.y*radius,\n        angleToVec(randoms.z*tau)*randoms.w*speed);\n}\n"},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GeometrySpawner=t.defaults=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},f=n(113),d=i(f),p=n(56),h=i(p),v=n(53),m=i(v),g=n(141),y=r(g),_=n(151),b=i(_),w=n(152),E=i(w),A=n(153),x=i(A),T=t.defaults=function(){return{shader:[y.defaults().shader[0],b.default],drawShader:[E.default,x.default],color:[1,1,1,1],positions:Array(6).fill(0)}},S=t.GeometrySpawner=function(e){function t(e,n){a(this,t);var r=Object.assign(T(),n),i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Object.assign(T(),n)));return i.geometry=(0,d.default)(e),i.drawShader=Array.isArray(r.drawShader)?h.default.apply(void 0,[i.gl].concat(o(r.drawShader))):r.drawShader,i.color=r.color,i.positions=r.positions,i}return u(t,e),c(t,[{key:"shuffle",value:function(){for(var e=2,t=3,n=e*t,r=2*Math.PI,i=void 0,o=function(){return.25+1.3*Math.random()},a=this.positions.length-1;a>=0;a-=n){var s=r*Math.random(),u=r*(.01+.25*Math.round(Math.random())+.03*Math.random());i=o(),this.positions[a-3]=Math.cos(s-u)*i,this.positions[a-2]=Math.sin(s-u)*i,i=o(),this.positions[a-1]=Math.cos(s+u)*i,this.positions[a-0]=Math.sin(s+u)*i}return this.geometry.attr("position",this.positions,{size:e}),this}},{key:"spawn",value:function(e){var n;m.default.scale(this.buffer.shape,e.viewRes,.2),this.buffer.bind(),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.drawShader.bind(),this.drawShader.uniforms.color=this.color,this.drawShader.uniforms.viewSize=e.viewSize,this.geometry.bind(this.drawShader),this.geometry.draw(),this.geometry.unbind();for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return(n=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"spawn",this)).call.apply(n,[this,e].concat(i))}}]),t}(y.PixelSpawner);t.default=S},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D particles;\nuniform sampler2D spawnData;\n\nuniform vec2 dataRes;\nuniform vec2 geomRes;\nuniform vec2 spawnSize;\n\nuniform vec2 jitter;\nuniform float time;\nuniform float speed;\n\nuniform mat3 spawnMatrix;\n\n/**\n * @todo Some bug with `glslify-import` & sons breaks `node_modules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec4 uvRange = vec4(0.0, 0.0, 1.0, 1.0);\n\nconst vec4 posRange = vec4(-1.0, -1.0, 1.0, 1.0);\n\nvec2 uvToPos(vec2 uv) {\n    return map(uv, uvRange.xy, uvRange.zw, posRange.xy, posRange.zw);\n}\n\nfloat transform(mat2 m, float v) {\n    return (m*vec2(v, 1.0)).x;\n}\n\nvec2 transform(mat3 m, vec2 v) {\n    return (m*vec3(v, 1.0)).xy;\n}\n\nvec3 transform(mat4 m, vec3 v) {\n    return (m*vec4(v, 1.0)).xyz;\n}\n\nconst vec2 flipUV = vec2(1.0, -1.0);\n\nvec2 spawnToPos(vec2 uv) {\n    // Jittering around a UV cell to get rid of boxy scaled sampling artefacts\n    vec2 offset = vec2(mix(-jitter.x, jitter.x, random(uv-1.2345+(time*0.001))),\n            mix(-jitter.y, jitter.y, random(uv+1.2345+(time*0.001))));\n\n    return transform(spawnMatrix, uvToPos(uv+offset)*flipUV*spawnSize);\n}\n\n/**\n * Directly uses a normal image - brightness being speed in a random direction.\n */\n\nfloat luma(vec3 color) {\n  return dot(color, vec3(0.299, 0.587, 0.114));\n}\n\nfloat luma(vec4 color) {\n  return dot(color.rgb, vec3(0.299, 0.587, 0.114));\n}\n\nconst float tau = 6.28318530717958647692;\n\nvec2 angleToVec(float rad) {\n    return vec2(cos(rad), sin(rad));\n}\n\nvec4 apply(vec2 uv, vec2 pos, vec4 pixel) {\n    return vec4(pos,\n        angleToVec(mod(random(uv*dot(pixel.rg, pixel.ba)), 1.0)*tau)*\n            luma(pixel)*pixel.a);\n}\n\n/**\n * Pick the Highest velocity.\n * Uses the same data structure as the particles.\n */\n\nfloat length2(vec2 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec3 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec4 vec) {\n    return dot(vec, vec);\n}\n\nfloat test(vec4 data) {\n    return length2(data.zw);\n}\n\nconst float samples = 6.0;\n\n/**\n * Tries a number of times to randomly select a pixel scored highest by a given\n * function.\n *\n * @requires {function} apply A function that transforms a `vec4` of data into a\n *                            valid `vec4` state.\n * @requires {function} test A function that returns a float value for a given\n *                           `vec4` state; greater values win the comparison.\n */\n\n// Over 1 favours changing to new data; under 1 favours current data.\nuniform float bias;\n\n/**\n * @todo Some bug with `glslify-import` & sons breaks `node_modules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\n\nvec4 pick(vec4 current, vec4 next) {\n    return ((test(current) > bias*test(next))? current : next);\n}\n\nvoid main() {\n    /**\n     * @todo This was needed in `./direct-main.frag` - is it needed here too?\n     */\n    vec2 uv = gl_FragCoord.xy/dataRes;\n    // vec2 uv = (gl_FragCoord.xy/dataRes)*(geomRes/dataRes);\n    \n    vec4 state = texture2D(particles, uv);\n\n    vec4 baseSeed = state+vec4(uv, uv)+vec4(1.2345+(time*0.001));\n\n    for(float n = 0.0; n < samples; n += 1.0) {\n        vec4 seed = baseSeed+vec4(n);\n        vec2 spawnUV = mod(vec2(random(seed.xy), random(seed.zw)), 1.0);\n        vec4 other = apply(spawnUV, spawnToPos(spawnUV),\n                texture2D(spawnData, spawnUV));\n\n        state = pick(state, vec4(other.xy, other.zw*speed));\n    }\n\n    gl_FragColor = state;\n}\n\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform vec2 viewSize;\n\nvoid main() {\n    gl_Position = vec4(position*viewSize, 0.0, 1.0);\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n    gl_FragColor = color;\n}\n"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.AudioTrigger=t.defaultTest=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(127),s=n(155),u=r(s),c=n(157),l=r(c),f=n(158),d=n(165),p=t.defaultTest=function(e){return(0,d.peak)(e.dataOrder(-1))>e.limit},h=t.AudioTrigger=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,o=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;i(this,e),this.analyser=t,this.orderLog=(0,f.makeOrderLog)(n,function(e){return(0,f.makeLog)(e,function(){return(0,l.default)(o.analyser,e===n?Uint8Array:Float32Array)})}),this.limit=r,this.test=a,this.react=s}return o(e,[{key:"sample",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"frequencies";return this.analyser[t]((0,a.step)(this.orderLog[0])),(0,d.orderLogRates)(this.orderLog,e),this}},{key:"dataOrder",value:function(e){return(0,a.wrapIndex)(e,this.orderLog)[0]}},{key:"fire",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.react,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.test||p,n=!!t(this);return n&&e(this),n}},{key:"clear",value:function(){(0,u.default)(function(e){return(0,u.default)(function(e){return(0,u.default)(function(t,n){return e[n]=0},e)},e)},this.orderLog)}}]),e}();t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.each=t.eachList=void 0;var i=n(156),o=r(i),a=t.eachList=function(e,t){return Array.prototype.forEach.call(t,e),t},s=t.each=function(e,t){return a(function(n,r,i){return e(t[n],n,t,r,i)},(0,o.default)(t)),t};t.default=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.iterable=function(e){return e?Object.keys(e):[]};t.default=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.makeData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uint8Array;return new t((e.analyser?e.analyser[0]||e.analyser:e[0]||e).frequencyBinCount)};t.default=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.makeOrderLog=t.makeLog=void 0;var i=n(159),o=r(i),a=t.makeLog=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};return(0,o.default)(e,t)},s=t.makeOrderLog=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;
return(0,o.default)(e,function(n){return t(e-n)})};t.default=s},function(e,t,n){function r(e,t){if(e=a(e),e<1||e>s)return[];var n=u,r=c(e,u);t=o(t),e-=u;for(var l=i(r,t);++n<e;)t(n);return l}var i=n(160),o=n(161),a=n(163),s=9007199254740991,u=4294967295,c=Math.min;e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}e.exports=n},function(e,t,n){function r(e){return"function"==typeof e?e:i}var i=n(162);e.exports=r},function(e,t){function n(e){return e}e.exports=n},function(e,t,n){function r(e){var t=i(e),n=t%1;return t===t?n?t-n:t:0}var i=n(164);e.exports=r},function(e,t,n){function r(e){if(!e)return 0===e?e:0;if(e=i(e),e===o||e===-o){var t=e<0?-1:1;return t*a}return e===e?e:0}var i=n(38),o=1/0,a=1.7976931348623157e308;e.exports=r},function(e,t,n){"use strict";function r(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=1,r=e.length;n<r;++n)u(e[n-1][1],e[n-1][0],t,(0,s.step)(e[n]));return e}Object.defineProperty(t,"__esModule",{value:!0}),t.meanWeight=t.mean=t.sumWeight=t.sum=t.peakPos=t.peak=t.logRates=void 0,t.orderLogRates=r;var i=n(166),o=n(167),a=n(168),s=n(127),u=t.logRates=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Uint8Array(e.length);return(0,o.mapList)(function(e,r){return(0,i.eulerDyDt)(e,t[r],n)},e,r)},c=(t.peak=function(e){return(0,a.reduceList)(function(e,t){return Math.abs(t)>Math.abs(e)?t:e},e,0)},t.peakPos=function(e){return(0,a.reduceList)(function(e,t,n){return Math.abs(t)>Math.abs(e.peak)&&(e.peak=t,e.pos=n),e},e,{peak:0,pos:-1})},t.sum=function(e){return(0,a.reduceList)(function(e,t){return e+Math.abs(t)},e,0)}),l=t.sumWeight=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return(0,a.reduceList)(function(n,r,i){return n+Math.abs(r*(1-Math.abs(i/(e.length-1)-t)))},e,0)};t.mean=function(e){return c(e)/e.length},t.meanWeight=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return l(e,t)/e.length}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.euler=function(e,t,n){return t+e*n};t.eulerDyDt=function(e,t,n){return(t-e)/n};t.default=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.map=t.mapList=void 0;var i=n(168),o=n(156),a=r(o),s=(t.mapList=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return(0,i.reduceList)(function(n,r,i){return n[i]=e(r,i,t),n},t,n)},t.map=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return(0,i.reduceList)(function(n,r,i,o){return n[r]=e(t[r],r,t,i,o),n},(0,a.default)(t),n)});t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.reduce=t.reduceList=void 0;var i=n(156),o=r(i),a=t.reduceList=function(e,t,n){return void 0===n?Array.prototype.reduce.call(t,e):Array.prototype.reduce.call(t,e,n)},s=t.reduce=function(e,t,n){return a(void 0===n?function(n,r,i,o){return e(i?n:t[n],t[r],r,t,i,o)}:function(n,r,i,o){return e(n,t[r],r,t,i,o)},(0,o.default)(t),n)};t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.AudioTexture=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(96),s=r(a),u=n(97),c=r(u),l=n(170),f=r(l),d=n(167),p=n(171),h=function(e){return e},v=t.AudioTexture=function(){function e(t,n,r){i(this,e),this.gl=t,this.array=n&&n.length?(0,c.default)(n,[n.length,1]):(0,f.default)(n)?(0,c.default)(new Float32Array(n),[n,1]):n,this.texture=r||(0,s.default)(t,this.array,{float:!0})}return o(e,[{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.array;return this.texture.setPixels(e),this}},{key:"assign",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.array.data;return(0,d.mapList)(h,e,this.array.data),this}},{key:"waveform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.array.data;return(0,d.mapList)(p.waveformMap,e,this.array.data),this}},{key:"frequencies",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.array.data;return(0,d.mapList)(p.frequencyMap,e,this.array.data),this}}]),e}();t.default=v},function(e,t,n){function r(e){return"number"==typeof e||o(e)&&i(e)==a}var i=n(40),o=n(44),a="[object Number]";e.exports=r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.waveformScale=1/128,r=(t.waveformMap=function(e){return(e-128)*n},t.frequencyScale=1/256);t.frequencyMap=function(e){return e*r}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.FlowLines=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(173),s=r(a),u=n(168),c=r(u),l=t.FlowLines=function(){function e(t){i(this,e),this.gl=t,this.active={}}return o(e,[{key:"get",value:function(e,t){return this.active[e]||(this.active[e]=new s.default(this.gl,t))}},{key:"trim",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,c.default)(function(e,n,r,i){return 0===n.trim.apply(n,t)&&delete i[r]?e:e+1},this.active,0)}}]),e}();t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.FlowLine=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(174),u=r(s),c=n(184),l=r(c),f=n(185),d=r(f),p=function(e,t){return e<0?t+e:e%t},h=t.FlowLine=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.line=new u.default(t,o({shader:[l.default,d.default],uniforms:o({},(0,s.defaults)().uniforms,{speed:3,speedLimit:.01,rad:.1,crestShape:.6}),attributes:o({},(0,s.defaults)().attributes,{previous:{getSize:function(e){return e.vertSize}},time:{size:1},dt:{size:1}})},n)),this.times=n.times||[]}return a(e,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.setAttributes,t=this.line.closed&&this.line.path.length?this.times.concat(this.times[0]):this.times;return this.line.update(function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.apply(void 0,[t].concat(r))}),this}},{key:"draw",value:function(){var e;return(e=this.line).draw.apply(e,arguments),this}},{key:"setAttributes",value:function(e,t,n,r,i){i.setAttributes(t,n,r,i);var o=i.closed?p(n.path-1,i.path.length):Math.max(0,n.path-1);r.previous.data.set(i.path[o],n.data*r.previous.size);var a=e[n.path];r.time.data[n.data]=a,r.dt.data[n.data]=a-e[o]}},{key:"add",value:function(e,t){return this.times.push(e),this.line.path.push(t),this}},{key:"insert",value:function(e,t){var n=this.findIndex(e);return this.times.splice(n,0,e),this.line.path.splice(n,0,t),this}},{key:"at",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.time=this.times[e],t.point=this.line.path[e],t}},{key:"findIndex",value:function(e){var t=this.times.findIndex(function(t){return t>e});return t<0?this.times.length:t}},{key:"trim",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),n=this.times,r=this.line.path,i=t-e;n[0]<i;)n.shift(),r.shift();return this.length}},{key:"length",get:function(){return this.times.length}}]),e}();t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Line=t.defaults=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(113),c=r(u),l=n(175),f=r(l),d=n(56),p=r(d),h=n(155),v=r(h),m=n(182),g=r(m),y=n(183),_=r(y),b=t.defaults=function(){return{shader:[g.default,_.default],uniforms:{color:[1,1,1,1],rad:.1,viewSize:[1,1]},attributes:null,vertNum:2,vertSize:2,path:[],closed:!1}},w=t.Line=function(){function e(t,n){var r=this;o(this,e);var s=a({},b(),n);this.gl=t,this.uniforms=s.uniforms,this.shader=Array.isArray(s.shader)?p.default.apply(void 0,[t].concat(i(s.shader))):s.shader,this.vertNum=s.vertNum,this.vertSize=s.vertSize,this.path=s.path||[],this.closed=s.closed,this.attributes=a({position:{data:null,getSize:function(){return r.vertSize}},normal:{data:null,getSize:function(){return r.vertSize}},miter:{data:null,size:1}},s.attributes),this.drawnPath=this.drawnNormals=null,this.geometry=(0,c.default)(t)}return s(e,[{key:"update",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.setAttributes;this.drawnPath=this.path,this.drawnNormals=(0,f.default)(this.drawnPath,this.closed),this.closed&&this.path.length&&(this.drawnPath=this.drawnPath.concat(this.drawnPath[0]),this.drawnNormals.push(this.drawnNormals[0])),this.initAttributes();for(var n=this.drawnPath,r=this.drawnNormals,i=this.attributes,o=this.vertNum,a={},s={},u=0,c=r.length;u<c;++u){var l=r[u];a.point=n[u],a.normal=l[0],a.miter=l[1],s.path=u,s.point=u*o;for(var d=0;d<o;++d)s.vert=d,s.data=s.point+d,t(a,s,i,this)}return(0,v.default)(function(t,n){return e.geometry.attr(n,t.data,{size:t.size})},i),this}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gl.TRIANGLE_STRIP;if(this.path.length>0){var t;this.geometry.bind(this.shader),Object.assign(this.shader.uniforms,this.uniforms);for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.geometry).draw.apply(t,[e].concat(r))}return this}},{key:"initAttributes",value:function(){var e=this,t=this.drawnPath.length*this.vertNum;return(0,v.default)(function(n){n.getSize&&(n.size=n.getSize(e));var r=t*n.size;n.data&&n.data.length===r||(n.data=new Float32Array(r))},this.attributes),this}},{key:"setAttributes",value:function(e,t,n){n.position.data.set(e.point,t.data*n.position.size),n.normal.data.set(e.normal,t.data*n.normal.size),n.miter.data[t.data]=e.miter*(t.data%2*2-1)}}]),e}();t.default=w},function(e,t,n){function r(e,t,n){e.push([[t[0],t[1]],n])}var i=n(176),o=[0,0],a=[0,0],s=[0,0],u=[0,0];e.exports=function(e,t){var n=null,c=[];t&&(e=e.slice(),e.push(e[0]));for(var l=e.length,f=1;f<l;f++){var d=e[f-1],p=e[f],h=f<e.length-1?e[f+1]:null;if(i.direction(o,p,d),n||(n=[0,0],i.normal(n,o)),1===f&&r(c,n,1),h){i.direction(a,h,p);var v=i.computeMiter(s,u,o,a,1);r(c,u,v)}else i.normal(n,o),r(c,n,1)}if(e.length>2&&t){var m=e[l-2],g=e[0],y=e[1];i.direction(o,g,m),i.direction(a,y,g),i.normal(n,o);var _=i.computeMiter(s,u,o,a,1);c[0][0]=u.slice(),c[l-1][0]=u.slice(),c[0][1]=_,c[l-1][1]=_,c.pop()}return c}},function(e,t,n){var r=n(177),i=n(178),o=n(179),a=n(180),s=n(181),u=[0,0];e.exports.computeMiter=function(e,t,n,a,c){return r(e,n,a),o(e,e),i(t,-e[1],e[0]),i(u,-n[1],n[0]),c/s(t,u)},e.exports.normal=function(e,t){return i(e,-t[1],t[0]),e},e.exports.direction=function(e,t,n){return a(e,t,n),o(e,e),e}},function(e,t){function n(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}e.exports=n},function(e,t){function n(e,t,n){return e[0]=t,e[1]=n,e}e.exports=n},function(e,t){function n(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e}e.exports=n},function(e,t){function n(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}e.exports=n},function(e,t){function n(e,t){return e[0]*t[0]+e[1]*t[1]}e.exports=n},function(e,t){e.exports="/**\n * Drawing lines in a vertex shader, from https://mattdesl.svbtle.com/drawing-lines-is-hard#expanding-in-a-vertex-shader_2\n * Pushes a point along its normal by its radius.\n */\n\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform vec2 viewSize;\n\nattribute vec2 normal;\nattribute float miter;\n\nuniform float rad;\n\nvarying float sdf;\n\n/**\n * Drawing lines, from https://mattdesl.svbtle.com/drawing-lines-is-hard#expanding-in-a-vertex-shader_2\n * Pushes a point along its normal by its radius, in the direction of miter.\n */\n\nvec2 expand(vec2 position, vec2 normal, float rad, float miter) {\n    return position+(normal*rad*miter);\n}\n\nvoid main() {\n    vec2 pos = expand(position, normal, rad, miter);\n\n    sdf = sign(miter);\n\n    gl_Position = vec4(pos*viewSize, 0.0, 1.0);\n}\n"},function(e,t){e.exports="/**\n * For a smooth line, check distance from line per-fragment.\n */\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvarying float sdf;\n\nvoid main() {\n    gl_FragColor = vec4(color.rgb, color.a-abs(sdf));\n}\n"},function(e,t){e.exports="/**\n * Drawing lines in a vertex shader, from https://mattdesl.svbtle.com/drawing-lines-is-hard#expanding-in-a-vertex-shader_2\n * Pushes a point along its normal by its radius.\n */\n\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform vec2 viewSize;\n\nattribute vec2 normal;\nattribute float miter;\n\nuniform float rad;\n\nuniform float speed;\nuniform float speedLimit;\n// uniform float time;\n\nattribute vec2 previous;\nattribute float time;\nattribute float dt;\n\nvarying vec4 values;\nvarying vec2 crest;\nvarying float sdf;\n\n/**\n * @requires {float} time The current time in ms\n */\n\nvec4 flow(vec2 vel) {\n    // Faster particles leave a greater influence (opacity).\n    // Linear interpolation - inaccurate for vectors, will it be OK without\n    // sudden turns, or do we need a per-fragment lookup?\n    return vec4(vel, time, length(vel));\n}\n\nvec4 flow(vec2 vel, float speedLimit) {\n    vec4 values = flow(vel);\n\n    return vec4(values.xyz, min(values.a/speedLimit, 1.0));\n}\n\n// #pragma glslify: flow = require(../flow/apply/screen, time = time, flowDecay = 0.001)\n\nvec2 perp(vec2 vec) {\n    return vec2(-vec.y, vec.x);\n}\n\nvec2 perp(vec2 vec, bool anti) {\n    return ((anti)? vec2(vec.y, -vec.x) : perp(vec));\n}\n\n/**\n * Drawing lines, from https://mattdesl.svbtle.com/drawing-lines-is-hard#expanding-in-a-vertex-shader_2\n * Pushes a point along its normal by its radius, in the direction of miter.\n */\n\nvec2 expand(vec2 position, vec2 normal, float rad, float miter) {\n    return position+(normal*rad*miter);\n}\n\nvoid main() {\n    sdf = sign(miter);\n\n    float rate = speed/max(dt, 1.0);\n\n    // @note For some reason, using these have different effects.\n    vec2 vel = (position-previous)*rate;\n    // vec2 vel = perp(normal, true)*length(position-previous)*rate;\n\n    values = flow(vel, speedLimit);\n\n    crest = normal*miter;\n\n    vec2 vert = expand(position, normal, rad*values.a, miter);\n\n    gl_Position = vec4(vert*viewSize, 0.0, 1.0);\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\n// Where the crest limit is (0 is the path direction, 1 is perpendicular/away).\nuniform float crestShape;\n\nvarying vec4 values;\nvarying vec2 crest;\nvarying float sdf;\n\nvoid main() {\n    float d = abs(sdf);\n    float speed = length(values.rg)*(1.0-d);\n\n    vec2 vel = normalize(mix(values.rg, crest, d*crestShape))*speed;\n\n    gl_FragColor = vec4(vel, values.b, values.a-d);\n}\n"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&(Object.assign(t,e.apply),(0,l.default)(e,t),(0,d.default)(function(n){return n(t,e)},e.call)),t}Object.defineProperty(t,"__esModule",{value:!0}),t.Player=t.apply=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(187),u=r(s),c=n(192),l=r(c),f=n(155),d=r(f),p=n(168),h=r(p),v=n(167),m=r(v);t.apply=o;var g=t.Player=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.tracks=t,this.outputs=n,this.add(this.tracks)}return a(e,[{key:"add",value:function(e){return(0,m.default)(function(e){return e instanceof u.default?e:new u.default(e)},e,this.tracks),this}},{key:"import",value:function(e){var t=this;return(0,d.default)(function(e){return(0,d.default)(function(e){return t.add(e)},e.tracks)},e),this}},{key:"each",value:function(e){return(0,d.default)(e,this.tracks),this}},{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.outputs;return this.each(function(n,r){for(var i=arguments.length,a=Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];var u=t[r]||(t[r]={});return o(e.apply(void 0,[n,r].concat(a,[u])),u)}),this}},{key:"seek",value:function(e,t){return this.apply(function(t){return t.seek(e)},t)}},{key:"play",value:function(e,t){return this.apply(function(t){return t.play(e)},t)}},{key:"playFrom",value:function(e,t,n){return this.apply(function(n){return n.playFrom(e,t)},n)}},{key:"frames",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,m.default)(function(e){return e.frames},this.tracks,e)}},{key:"start",value:function(){return(0,h.default)(function(e,t){return Math.min(t.start(),e)},this.tracks,null)}},{key:"end",value:function(){return(0,h.default)(function(e,t){return Math.min(t.end(),e)},this.tracks,null)}},{key:"duration",value:function(){return(this.end()||0)-(this.start()||0)}}]),e}();t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Timeline=t.changed=t.within=t.offset=t.sort=t.order=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(188),c=r(u),l=n(189),f=r(l),d=n(190),p=r(d),h=n(155),v=r(h),m=n(191),g=r(m),y=n(156),_=r(y),b=t.order=function(e,t){return e.time>t.time?1:-1},w=t.sort=function(e){return e.sort(b)},E=t.offset=function(e,t,n){var r=Math.min(e.time,t.time);return(0,c.default)((n-r)/(Math.max(e.time,t.time)-r)||0,0,1)},A=t.within=function(e,t,n){return Math.min(e.time,t.time)<n&&n<=Math.max(e.time,t.time)},x=t.changed=function(e,t){return e===t?null:(0,_.default)(e).length&&(0,_.default)(t).length?(0,g.default)(function(t,n){return t!==e[n]},t):t},T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.apply=Object.assign(t.apply||{},e.to),e.call&&e.call.length){var n;(n=t.call||(t.call=[])).push.apply(n,o(e.call))}return t},S=t.Timeline=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i(this,e),this.frames=this.setup(t,n),this.time=0,this.gap=-1,this.span=void 0,this.symmetric=o,this.infinite=n,this.rewind=r}return s(e,[{key:"setup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.frames=w(t?[{time:-(1/0)}].concat(o(e),[{time:1/0}]):[].concat(o(e)))}},{key:"merge",value:function(e){var t=this;return(0,v.default)(function(e){return t.add(e)},e)}},{key:"insertFrame",value:function(e,t){return this.frames.splice(e,0,t),this}},{key:"add",value:function(){var e=f.default.apply(void 0,arguments),t=this.indexOf(e);return this.insertFrame(t,e),t}},{key:"addSpan",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=this.add.apply(this,n),o=this.frames[i].time-e,a=this.frames[i-1];return e&&(!a||a.time<o)&&this.add(null,o),i}},{key:"seek",value:function(e){return this.valid()&&A(this.span.past,this.span.next,e)?this.span.t=E(this.span.past,this.span.next,e):this.setTime(e),this.span}},{key:"play",value:function(e){var t=Math.max(this.gap,.5),n=this.seek(e);if(this.valid()){var r={},i=this.gap-t,o=Math.abs(i),s=Math.sign(i),u=(this.reverse?-s:s)>0;if(o>0&&u)for(var c=s<0?Math.floor:Math.ceil,l=0;l<o;++l)T(this.frames[c(t+l*s)],r);n=a({},n,r)}return n}},{key:"playFrom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.time,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.seek(t),this.play(e)}},{key:"setTime",value:function(e){var t=this.gapAt(e);return this.span=this.spanGapAt(e,t,this.span),this.gap=t,this.time=e,this}},{key:"indexOf",value:function(e){var t=this.frames.findIndex(function(t){return b(t,e)>0});return t<0?this.frames.length:t}},{key:"gapAt",value:function(e){if(this.frames.length<2)return-1;var t=this.frames.findIndex(function(t){return t.time>=e});return(t<0?this.frames.length-1:Math.max(t,1))-.5}},{key:"spanGapAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.gapAt(e),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t>=0){var r=this.frames[Math.floor(t)],i=this.frames[Math.ceil(t)],o=i.ease;if(this.rewind){this.symmetric||(o=r.ease);var a=r;r=i,i=a}n.past=r,n.next=i,n.a=r.to,n.b=i.to,n.t=E(r,i,e),n.ease=o}else n=void 0;return n}},{key:"splice",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=t,i=n;if(this.infinite){var o=Math.max(0,this.frames.length-2),a=t<0?o+t:t;r=Math.min(o,Math.max(1,a)),i=Math.min(n-Math.max(r-a,0),o-r)}for(var s=arguments.length,u=Array(s>2?s-2:0),c=2;c<s;c++)u[c-2]=arguments[c];return(e=this.frames).splice.apply(e,[r,i].concat(u))}},{key:"spliceIndex",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.splice.apply(this,[e,1].concat(n))[0]}},{key:"spliceAt",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=this.gapAt(e),r=(this.reverse?-1:1)*t,i=(r>0?Math.ceil:Math.floor)(n),o=arguments.length,a=Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];return this.splice.apply(this,[i,1].concat(a))[0]}},{key:"spliceSpan",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.gapAt(t),r=this.gapAt(t+e),i=Math.min(n,r),o=arguments.length,a=Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];return this.splice.apply(this,[Math.ceil(i),Math.floor(Math.max(n,r)-i)].concat(a))}},{key:"to",value:function(){return this.add.apply(this,arguments),this}},{key:"easeTo",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.easeJoin(this.add.apply(this,n),e),this}},{key:"smoothTo",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.easeTo.apply(this,[1].concat(t))}},{key:"flipTo",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.easeTo.apply(this,[-1].concat(t))}},{key:"over",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.addSpan.apply(this,[e].concat(n)),this}},{key:"easeOver",value:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this.easeJoin(this.addSpan.apply(this,[e].concat(r)),t),this}},{key:"smoothOver",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.easeOver.apply(this,[e,1].concat(n))}},{key:"flipOver",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.easeOver.apply(this,[e,-1].concat(n))}},{key:"easeJoin",value:function(e,t){var n=null;if(e>0){var r=this.frames[e];n=r.ease&&r.ease.length?r.ease:[0,1],n.splice(1,0,(0,p.default)(this.frames[e-1].ease,t)),r.ease=n}return n}},{key:"valid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gap,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.span;return e>0&&t}},{key:"minFrame",value:function(){var e=f.default.apply(void 0,arguments),t=this.indexOf(e),n=this.frames[t-1],r=n&&n.to?x(n,e.to):null,i=this.frames[t+1],o=i&&i.to?x(i,e.to):null,s=(0,_.default)(r).length||(0,_.default)(o).length?a({},r,o):r;return a({},e,{to:s})}},{key:"start",value:function(){return this.frames.length?this.frames[0].time:null}},{key:"end",value:function(){return this.frames.length?this.frames[this.frames.length-1].time:null}},{key:"duration",value:function(){return(this.end()||0)-(this.start()||0)}}]),e}();t.default=S},function(e,t){function n(e,t,n){return t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e}e.exports=n},function(e,t){"use strict";function n(e,t,n,r){return arguments.length>1?{to:e,time:t,ease:n,call:r}:e}Object.defineProperty(t,"__esModule",{value:!0}),t.frame=n,t.default=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.join=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e&&0!==e.length?1===e.length?e[0]:(e[e.length-1]-e[e.length-2])*t:0};t.default=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.filter=t.filterList=void 0;var i=n(168),o=n(156),a=r(o),s=(t.filterList=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return(0,i.reduceList)(function(n,r,i){return e(r,i,t)&&n.push(r),n},t,n)},t.filter=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,i.reduceList)(function(n,r,i,o){var a=t[r];return e(a,r,t,i,o)&&((n||(n={}))[r]=a),n},(0,a.default)(t),n)});t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.tween=t.tweenProps=t.tweenValue=void 0;var i=n(193),o=r(i),a=n(194),s=r(a),u=n(170),c=r(u),l=n(167),f=function(e,t,n){var r=t&&t[e];return(0,c.default)(r)?r:n&&n[e]},d=t.tweenValue=function(e,t,n,r){return e!==t&&(0,c.default)(e)?(0,o.default)(e,t,r?(0,s.default)(r,n):n):t},p=t.tweenProps=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t?(0,l.map)(function(o,a){var s=f(a,e,i),u=f(a,t,i);return(0,c.default)(s)&&(0,c.default)(u)?d(s,u,n,r):n<1?s:u},t,i):i},h=t.tween=function e(t,n){for(var r=arguments.length,i=Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return i.length?((0,c.default)(n)?d:p).apply(void 0,[t,n].concat(i)):e(t.a,t.b,t.t,t.ease,n)};t.default=h},function(e,t){function n(e,t,n){return e*(1-n)+t*n}e.exports=n},function(e,t){function n(e,t){return r(e.length)(e,t)}function r(e){if(e=0|+e,!e)throw new Error("Cannot create a interpolator with no elements");if(u[e])return u[e];for(var t=["var ut = 1 - t",""],n=e;n--;){for(var r=0;r<n;r+=1)n+1===e?t.push("var p"+r+" = arr["+r+"] * ut + arr["+(r+1)+"] * t"):n>1?t.push("p"+r+" = p"+r+" * ut + p"+(r+1)+" * t"):t.push("return p"+r+" * ut + p"+(r+1)+" * t");n>1&&t.push("")}return t=["return function bezier"+e+"(arr, t) {",t.map(function(e){return"  "+e}).join("\n"),"}"].join("\n"),Function(t)()}function i(e){return e[0]}function o(e,t){return e[0]+(e[1]-e[0])*t}function a(e,t){var n=1-t;return(e[0]*n+e[1]*t)*n+(e[1]*n+e[2]*t)*t}function s(e,t){var n=1-t,r=e[1]*n+e[2]*t;return((e[0]*n+e[1]*t)*n+r*t)*n+(r*n+(e[2]*n+e[3]*t)*t)*t}var u={1:i,2:o,3:a,4:s};e.exports=n,e.exports.prepare=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Blend=t.defaults=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(56),u=r(s),c=n(167),l=n(128),f=r(l),d=n(130),p=r(d),h=n(196),v=r(h),m=t.defaults=function(){return{shader:[p.default,v.default],views:[],alphas:[],resolution:[1,1]}},g=t.Blend=function(){function e(t,n){o(this,e),this.gl=t;var r=Object.assign(m(),n);this.shader=Array.isArray(r.shader)?u.default.apply(void 0,[this.gl].concat(i(r.shader))):r.shader,this.screen=new f.default(t),this.views=r.views,this.alphas=r.alphas,this.resolution=r.resolution,this.uniforms={}}return a(e,[{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e&&e.shape,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e&&e.bind(),t&&(this.gl.viewport(0,0,t[0],t[1]),this.resolution=t),n&&this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.shader.bind(),Object.assign(this.shader.uniforms,this.uniforms,{views:(0,c.mapList)(function(e,t){return(e.color?e.color[0]:e).bind(t)},this.views,this.uniforms.views),alphas:this.alphas,resolution:this.resolution}),this.screen.render(),e&&this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}}]),e}();t.default=g},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nconst int numViews = 2;\n\nvec4 preAlpha(vec3 color, float alpha) {\n    return vec4(color.rgb*alpha, alpha);\n}\n\nvec4 preAlpha(vec4 color) {\n    return preAlpha(color.rgb, color.a);\n}\n\nvec4 blend(vec4 sum, vec4 color, float alpha) {\n    return sum+preAlpha(color.rgb, color.a*alpha);\n}\n\n/**\n * Color summation from multiple views, each blending with a global alpha.\n *\n * @requires {float} numViews The number of source views to blend together\n * @requires {function} blend A function blending a source buffer into a sum\n */\n\nuniform sampler2D views[numViews];\nuniform float alphas[numViews];\nuniform vec2 resolution;\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy/resolution;\n\n    // Accumulate colors\n    \n    vec4 sum = vec4(0.0);\n\n    for(int i = 0; i < numViews; ++i) {\n        vec4 color = texture2D(views[i], uv);\n\n        // Pre-multiplied alpha so they don't cross over\n        sum = blend(sum, color, alphas[i]);\n    }\n\n    gl_FragColor = sum;\n}\n\n";
},function(e,t){e.exports="/**\n * A vignette hash blur\n * @todo Make the `const`s here into `uniform`s.\n */\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D view;\nuniform vec2 resolution;\nuniform float time;\nuniform float radius;\nuniform float limit;\n\nvec3 sampler(vec2 uv) {\n    return texture2D(view, uv).rgb;\n}\n\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\n#ifndef TAU\n  #define TAU 6.28318530718\n#endif\n\n//Use last part of hash function to generate new random radius and angle\nvec2 mult(inout vec2 r) {\n  r = fract(r * vec2(12.9898,78.233));\n  return sqrt(r.x + .001) * vec2(sin(r.y * TAU), cos(r.y * TAU));\n}\n\nvec3 blur(vec2 uv, float radius, float aspect, float offset) {\n  vec2 circle = vec2(radius);\n  circle.x *= aspect;\n  vec2 rnd = vec2(random(vec2(uv + offset)));\n\n  vec3 acc = vec3(0.0);\n  for (int i = 0; i < 20; i++) {\n    acc += sampler(uv + circle * mult(rnd)).xyz;\n  }\n  return acc / float(20);\n}\n\nvec3 blur(vec2 uv, float radius, float aspect) {\n  return blur(uv, radius, aspect, 0.0);\n}\n\nvec3 blur(vec2 uv, float radius) {\n  return blur(uv, radius, 1.0);\n}\n\n/**\n * Adapted from `bezier`.\n */\n\nfloat bezier(vec2 cp, float t) {\n    return cp.x+(cp.y-cp.x)*t;\n}\n\nfloat bezier(vec3 cp, float t) {\n    float ut = 1.0-t;\n\n    return (cp.x*ut+cp.y*t)*ut+(cp.y*ut+cp.z*t)*t;\n}\n\nfloat bezier(vec4 cp, float t) {\n    float ut = 1.0-t;\n    float a1 = cp.y*ut+cp.z*t;\n\n    return ((cp.x*ut+cp.y*t)*ut+a1*t)*ut+(a1*ut+(cp.z*ut+cp.w*t)*t)*t;\n}\n\n// @todo Remove the `1.0-` here?\nfloat amount_0(vec2 point, vec2 mid, float limit) {\n    return min(1.0-(length(point-mid)/limit), 1.0);\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit) {\n    return max(0.0, amount_0(point, mid, limit));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, float curve) {\n    return max(0.0, curve*amount_0(point, mid, limit));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec2 curve) {\n    return max(0.0, bezier(curve, amount_0(point, mid, limit)));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec3 curve) {\n    return max(0.0, bezier(curve, amount_0(point, mid, limit)));\n}\n\nfloat vignette(vec2 point, vec2 mid, float limit, vec4 curve) {\n    return max(0.0, bezier(curve, amount_0(point, mid, limit)));\n}\n\nconst vec3 falloff = vec3(0.0, 1.0, 1.0);\nconst vec2 mid = vec2(0.5);\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy/resolution;\n    float texel = 1.0/min(resolution.x, resolution.y);\n    float amount = (1.0-vignette(uv, mid, limit, falloff))*texel;\n    float aspect = resolution.x/resolution.y;\n    float jitter = mod(time, 20.0);\n\n    gl_FragColor = vec4(blur(uv, radius*amount, aspect, jitter),\n            texture2D(view, uv).a);\n}\n"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.part=function e(t){return function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.length?e(function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(void 0,r.concat(n))}):t()}};t.curry=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;return function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return n>i.length?e(function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(void 0,i.concat(n))},n-i.length):t.apply(void 0,i)}};t.default=n}]);
//# sourceMappingURL=tendrils.js.map